var EN = {
    /* ui.register */
    "$make.new.ciayo"           : "Create an account and enter the CIAYO World!",
    "$create.an.account"        : "Create an account and enter the CIAYO World!",
    "$phone"                    : "Phone",
    "$your.email"               : "Email address",
    "$your.phone.number"        : "Phone number",
    "$create.password"          : "Password",
    "$register"                 : "Register",
    "$login"                    : "Login",
    "$mascot"                   : "Mascots",
    "$term.policy"              : "By using CIAYO, you have agreed to abide to CIAYO’s <a href=\"{{terms}}\"><b>Terms of Use</b></a> and <a href=\"{{data_policy}}\"><b>Privacy Policy.</b></a>",
    "$login.your.account"       : "Login to your account",
    "$your.password"            : "Your Password",
    "$enter"                    : "Enter",
    "$forgot.password?"         : "Forgot your password?",
    "$back.to.login"            : "Back to login",
    "$get.access.your.account"  : "Get access to your account",
    "$must.be.character"        : "Must be at least 8 characters",
    "$disallowed.character"     : "Must not contain forbidden characters <br/> ( \" , ', _ , & , ( , ) , < , > , space , / , \ )",
    "$hallo"                    : "Hello!",
    "$hi.."                     : "Hi",
    "$ciayo.friends..."         : "CIAYO Friends...",
    "$welcome.to.ciayo"         : "Welcome to The CIAYO World",
    "$fill.nickname"            : "What is your name ?",
    "$username.already.exist"   : "Sorry, this username already exists. Try another?",
    "$when.your.birth"          : "When were you born?",
    "$select.your.gender"       : "Select your gender",
    "$male"                     : "Male",
    "$female"                   : "Female",
    "$create.your.avatar"       : "Create your Avatar",
    "$free.to.join"             : "COME IN! THE CIAYO WORLD IS AWESOME!",
    "$meet.new.connection"      : "Make friends with similar activities. Be kewl.",
    "$see.whatsup.ciayo"        : "See what’s new in The CIAYO World.",
    "$make.new.connection"      : "Make friends with similar activities. Be kewl.",
    "$not.ciayo.member.yet"     : "Not a CIAYO member yet?",
    "$already.an.ciayo.member"  : "Already a CIAYO member?",
    "$not.found"                : "No result found, try again :)",

    /* ui.topbar */
    "$search.cayers"            : "Search CIAYO Friends",
    "$timeline"                 : "Timeline",
    "$notification"             : "Notifications",
    "$message"                  : "Messages",
    "$request"                  : "Requests",
    "$trending"                 : "Trending",
    "$achievement"              : "Achievements",
    "$store"                    : "Store",
    "$setting"                  : "Settings",
    "$mark.all.read"            : "Mark all as read",
    "$see.all"                  : "See all",
    "$friend.requests"          : "Friend Requests",
    "$find.friends"             : "Find Friends",
    "$trending"                 : "Trending",
    "$dont.connect.request"     : "You don’t have any friend requests",
    "$dont.any.notification"    : "You don’t have any notifications",
    "$all.people"               : "All people",
    "$friends"                  : "Friends",
    "$following"                : "Following",
    "$result.for"               : "result for",
    
    /* ui.timeline */
    "$what.areyou.doing?"       : "Search Activity, Item or Places",
    "$give.reaction"            : "People gave CIMOTIONS",
    "$who.gave.reaction"        : "Who CIMOTED this post",
    "$view.more.comment..."     : "View more comments...",
    "$reply.comment"            : "Reply comment",
    "$write.comment..."         : "Write a comment...",
    "$share.activity"           : "Share your activity",
    "$who.shared.post"          : "Who shared this post",
    "$save.picture?"            : "Do you want to save this picture?",
    "$save"                     : "Save",
    "$post.permission"          : "Privacy Settings",
    "$who.see.this?"            : "Who can see this?",
    "$public"                   : "Public",
    "$report.post"              : "Report Post",
    "$turnoff.notification"     : "Turn Off Notifications",
    "$edit.post"                : "Edit Post",
    "$caption"                  : "Caption",
    "$edit.caption"             : "Edit Caption",
    "$with"                     : "With",
    "$edit.with"                : "Edit With",
    "$search.friend..."         : "Search friends…",
    "$delete.post"              : "Delete Post",
    "$sure.delete.post?"        : "Are you sure you want to delete this post?",
    "$yes"                      : "Yes",
    "$no"                       : "No",
    "$check.myprofile"          : "View Profile",
    "$follow"                   : "Follow",
    "$unfollow"                 : "Unfollow",
    "$add.as.friend"            : "Add as Friend",
    "$check.me"                 : "View Profile",
    "$sticker"                  : "Stickers",
    "$emoji"                    : "Emojis",
    "$shop"                     : "Store",
    "$next"                     : "Next",
    "$back"                     : "Back",
    "$nopeople.give.reaction"   : "Nobody gave CIMOTIONS",
    "$add.friend"               : "Add friend",
    "$respond.friend.request"   : "Respond to friend request",
    "$friend.request.sent"      : "Friend request sent",
    "$response.friend.request"  : "Respond to friend request",
    "$cancel.friend.request"    : "Cancel Friend Request",
    "$no.comment.post!"         : "No comments for this post. Add one whydoncha?",
    "$no.body.share"            : "Nobody shared this post, yet. You know, sharing IS caring.",
    "$write.your.caption"       : "Write your caption here",
    "$search.items"             : "Search items",
    "$who.with.you?"            : "who’s with you?",
    "$tag.someone"              : "Tag someone",
    "$remove"                   : "Remove",
    "$replace"                  : "Replace",
    "$where.are.you?"           : "where are you?",
    "$alone"                    : "I'm Alone",
    "$secret"                   : "It's Secret",
    "$no.item"                  : "No item",
    "$now"                      : "Now",
    "$my.sticker"               : "My Stickers",
    "$ask.with"                 : "Do you want to asking who with ",
    "$ask.with.when"            : " when he is doing this activity?",
    "$ask.place"                : "Do you want to asking where is ",
    "$ask.place.when"           : " when he is doing this activity? place",
    "$asking.place"             : "asked about your location on this activity?",
    "$asking.with"              : "asked about who you are with on this activity?",
    "$response.friend.question" : "Response to your friend question",
    "$tag.friend"               : "Tag friend",
    
    /* ui.social.media */
    "$YOUR.ACCOUNT"             : "YOUR ACCOUNT",
    "$edit.profile"             : "Edit Profile",
    "$change.password"          : "Change Password",
    "$privacy.setting"          : "Privacy Settings",
    "$PRIVACY.SETTING"          : "PRIVACY SETTINGs",
    "$manage.socmed"            : "Manage Social Media",
    "$MANAGE.SOCMED"            : "MANAGE SOCIAL MEDIA",
    "$blocked.account"          : "Blocked Accounts",
    "$add.another.socmed"       : "Add other social media",
    "$logout"                   : "Logout",
    "$username"                 : "Username",
    "$are.you.sure.logout?"     : "Are you sure you want to logout?",
    
    /* ui.achievement */
    "$ACHIEVEMENT.PACK"         : "ACHIEVEMENT PACKS",
    "$search.achievement"       : "Search Achievements",
    "$ongoing"                  : "Ongoing",
    "$completed"                : "Completed",
    "$sort.by"                  : "Sort by",
    "$higher.progress"          : "Higher progress",
    "$lower.progress"           : "Lower progress",
    "$last.update"              : "Last updated on {{date}}",
    "$badge"                    : "Badges",
    "$achievement"              : "Achievements",
    "$badges"                   : "Badges",
    "$all"                      : "All",
    "$on.going"                 : "Ongoing",
    "$sort"                     : "Sort",
    "$showing.achievement"      : "Showing Achievement number ",
    "$of"                       : " of ",
    "$share.to:"                : "Share this Achievement",
    "$use.as.title"             : "Use as Title",
    "$ascending(a-z)"           : "Ascending (A-Z)",
    "$descending(z-a)"          : "Descending (Z-A)",
    "$highest.to.lowest"        : "Highest to Lowest",
    "$lowest.to.high"           : "Lowest to High",
    "$achieve.em.all"           : "Achieve ‘em all:",
    "$updated.on"               : "Updated on",
    
    /* ui.change.password */
    "$YOUR.ACCOUNT"             : "YOUR ACCOUNT",
    "$CHANGE.PASSWORD"          : "CHANGE PASSWORD",
    "$old.password"             : "Old Password",
    "$new.password"             : "New Password",
    "$confirm.new.password"     : "Confirm New Password",
    "$password.not.valid"       : "Invalid password",
    "$use.case.sensitive"       : "Use case sensitive password",
    
    /* ui.blocked.account */
    "$BLOCKED.ACCOUNT"          : "BLOCKED ACCOUNTS",
    "$block.more.friend?"       : "NULL",
    
    /* ui.create.avatar.born */
    "$WHERE.YOU.BORN"           : "WHERE WERE YOU BORN?",
    "$date.of.birth"            : "Date of Birth",
    "$place.of.birth"           : "Place of Birth",
    "$date/month/year"          : "Date / Month / Year",
    
    /* ui.create.avatar.nation */
    "$NATIONALITY"              : "NATIONALITY",
    "$nationality"              : "Nationality",
    "$select.nationality"       : "Select Your Nationality",
    
    /* ui.create.avatar.uavatar */
    "$YOUR.AVATAR"              : "YOUR AVATAR",
    "$enter.ciayo.world"        : "Now take your first step to enter The CIAYO World",
    "$download.avatar"          : "Download Avatar",
    "$you.look.great!"          : "You look awesome!",
    
    /* ui.edit.profile */
    "$EDIT.ACCOUNT"             : "EDIT ACCOUNT",
    "$profile.picture"          : "Profile Picture",
    "$edit.avatar.explanation"  : "Make your Avatar as similar to you as possible, or not. Unleash your inner creativity!",
    "$edit.avatar.filter"       : "Edit Avatar in Filter",
    "$choose.name.profile"      : "Pick a Name for Display Profile",
    "$full.name"                : "Full Name",
    "$first.name"               : "First Name",
    "$middle.name"              : "Middle Name",
    "$last.name"                : "Last Name",
    "$screen.name"              : "Username",
    "$login.notification"       : "Login Notifications",
    "$deactive.account?"        : "Are you sure you want to deactivate your account?",
    "$deactive.account"         : "Deactivate Account",
    "$when.account.deactive"    : "When your account is deactivated, people can’t search, tag, and see your CIAYO profile",
    "$delete.account?"          : "Are you sure you want to delete your account?",
    "$delete.account"           : "Delete Account",
    "$when.delete.account"      : "If you delete your account, all your credentials and account information will be lost and you have to make a new account to enter the CIAYO World",
    "$show.notif.toemail"       : "Notify me through email or phone when someone is trying to login into my account",
    "$restore.default.setting"  : "Restore default settings",
    "$email"                    : "Email",
    "$email.address"            : "Email Address",
    "$phone.number"             : "Phone Number",
    "$dont.have.badge"          : "No badges here. Kinda empty, huh?",
    "$dont.have.achievement"    : "No achievements here. Hmm. . .",
    "$edit.name&title"          : "Edit display name & title",
    "$display.name&title"       : "Display Name & Title",
    "$edit.avatar"              : "Edit avatar",
    
    /* ui.message */
    "$MESSAGES"                 : "MESSAGES",
    "$search.people..."         : "Search people...",
    "$online"                   : "Online",
    "$you.havent.friend?"       : "You haven’t got any friends yet, add {{name}}?",
    "$new.message"              : "New message",
    "$to:"                      : "To:",
    "$write.messsage..."        : "Write a message...",
    "$message.didnt.send"       : "Message failed to send.",
    "$check.internet.connect"   : "Internet down! Internet down! Worry not, because Chips is on his way! Reconnect and click to try again!",
    "$send"                     : "Send",
    "$enter.to.send"            : "Press enter to send",
    "$dont.have.mutual.friend"  : "You don’t have any mutual friends",
    "$mutual.friend"            : "Mutual friends",
    
    /* ui.privacy.setting */
    "$message.privilege"        : "Message Privacy",
    "$post.default.setting"     : "Post Default Settings",
    "$filter.view.access"       : "Filter View Access",
    "$who.find.me?"             : "Who can find me?",
    "$timeline.access"          : "Timeline Access",
    "$message.previlage"        : "Message privacy",
    "$post.default.setting"     : "Post default Settings",
    "$who.can.find.me?"         : "Who can find me?",
    "$who.can.find.me?"         : "Who can add me?",
    "$anyone"                   : "Anyone",
    "$friends"                  : "Friends",
    "$best.friends"             : "Best Friends",
    "$families"                 : "Families",
    "$acquitances"              : "Acquaintances",
    "$coworkers"                : "Co-workers",
    "$onlyme"                   : "Only Me",
    
    /* ui.setting */
    "$edit.basic.info"          : "Edit Basic Info",
    "$EDIT.BASIC.INFO"          : "EDIT BASIC INFO",
    "$edit.account"             : "Edit Account",
    "$change.password"          : "Change Password",
    "$privacy.setting"          : "Privacy Settings",
    "$PRIVACY.SETTING"          : "PRIVACY SETTINGS",
    "$manage.social.media"      : "Manage Social Media",
    "$MANAGE.SOCIAL.MEDIA"      : "MANAGE SOCIAL MEDIA",
    "$general.settings"         : "General Settings",
    "$GENERAL.SETTINGS"         : "GENERAL SETTINGS",
    "$blocked.account"          : "Blocked Accounts",
    "$BLOCKED.ACCOUNT"          : "BLOCKED ACCOUNTS",
    "$display.as.ciayo"         : "will display as your CIAYO username",
    "$verify.your.email"        : "Verify your email",
    "$verify.phone.number"      : "Verify your phone number",
    "$username"                 : "Username",
    "$card.setting"             : "Card Settings",
    "$parallax.view.timeline"   : "Parallax Timeline View",
    "$parallax.info"            : "Parallax allows you to see Activity images in a 3D-like perspective. If you have motion sickness, turn this off.",
    "$notification.setting"     : "Notification Settings",
    "$notification.alerts"      : "Notification Sounds",
    "$friend.requests"          : "Friend Requests",
    "$have.friend.request"      : "You have {{number}} friend request(s)",
    "$comment.alerts"           : "Comment Notifications",
    "$language.settings"        : "Language Settings",
    "$language.use.ciayo?"      : "What language do you want to use in CIAYO?",
    "$email.notification"       : "Email Notifications",
    "$reset.password"           : "Reset password",
    "$login.failed"             : "Failed Login Attempts",
    "$account.deactivation"     : "Account Deactivation",
    "$account.deletion"         : "Account Deletion",
    "$new.features"             : "New Features",
    "$to.verify.email"          : "To verify your account, please enter the One-Time PIN sent to your registered email: ",
    "$to.verify.phone"          : "To verify your account, please enter the One-Time PIN sent via SMS to your registered mobile number: ",
    "$send"                     : "Send",
    "$resend"                   : "Resend",
    "$verification.later"       : "Verify later",
    "$change.email?"            : "Change your email?",
    "$change.mobile.number?"    : "Change your mobile number?",
    "$old.password.didnt.match" : "Old password is not correct. Check again?",
    "$password.didnt.match"     : "Password didn't match",
    "$success.change.password"  : "Password successfully changed",
    "$success.delete.socmed"    : "Social media successfully deleted",
    "$success.update.socmed"    : "Social media successfully updated",
    "$success.add.socmed"       : "Social media successfully added",
    "$success.verified"         : "Account verification successful! WOW!",
    "$code.invalid"             : "Invalid confirmation code",
    "$already.block.user"       : "You already blocked this user",
    "$success.block.user"       : "User successfully blocked and sent away to oblivion",
    "$success.unblock.user"     : "User successfully unblocked from the depths of oblivion",
    "$ABOUT.US"                 : "ABOUT US",
    "$about.us"                 : "About CIAYO",
    "$PRIVACY.AND.POLICY"       : "PRIVACY POLICY",
    "$privacy.and.policy"       : "Privacy Policy",
    "$TERMS.AND.CONDITIONS"     : "TERMS AND CONDITIONS",
    "$terms.and.conditions"     : "Terms and Conditions",
    "$FAQ"                      : "FAQ",
    "$all.rights.reserved"      : "All rights reserved",
    "$congratulation!"          : "Congratulations!",
    "$success.verify"           : "Your account has been verified. Enter the CIAYO World with open arms. Woohoo!",
    "$has.been.verify"          : "Your account has been verified.",
    "$success.change.profile"   : "Success change profile settings",

    /* ui.profile */            
    "$overview"                 : "Overview",
    "$timeline"                 : "Timeline",
    "$connection"               : "Connections",
    "$friends"                  : "Friends",
    "$achievement"              : "Achievements",
    "$about.me"                 : "About me",
    "$website"                  : "Websites",
    "$your.website"             : "Your websites",
    "$social.media"             : "Social Media",
    "$add.social.media"         : "Add social media",
    "$put.social.media"         : "You can also put URLs from your social media accounts here",
    "$badge.collection"         : "Collected Badges",
    "$achievement.collection"   : "Collected Achievements",
    "$place.date.birth"         : "Place, Date of Birth",
    "$add.badge"                : "Add Badges",
    "$add.achievement"          : "Add Achievements",
    "$pick.achievement"         : "Pick an Achievement to show off on your Overview page",
    "$pick.badge"               : "Pick a Badge to show off on your Overview page",
    "$search"                   : "Search",
    "$save"                     : "Save",
    "$cancel"                   : "Cancel",
    "$view.profile"             : "View Profile",
    "$displayname&title"        : "Display Name & Title",
    "$title"                    : "Title",
    "$displayname"              : "Display name",
    "$all.friends"              : "All friends",
    "$search.friends"           : "Search friends",
    "$data.not.found"           : "Data not found",
    "$block"                    : "Block",
    "$no.badge.collections"     : "no badge collections",
    "$no.social.network.added"  : "no social network added",
    "$no.website.added"         : "no website added",
    "$ask.for"                  : "Ask for",
    "$place.date.birthday"      : "place and date of birth",
    "$let"                      : "Let",
    "$ask.birthday"             : "know why you're asking for his place and date of birth",
    "$ask.email"                : "know why you're asking for his email address",
    "$ask.phone"                : "know why you're asking for his phone number",
    "$send.request"             : "Send request",

    /* ui.store */
    "$store"                    : "Store",
    "$search.sticker"           : "Search stickers, items or emojis",
    "$inventory"                : "Inventory",
    "$check.now"                : "Check it out",
    "$home"                     : "Home",
    "$premium"                  : "Premium",
    "$contributor"              : "Contributor",
    "$free"                     : "Free",
    "$all.sticker"              : "All Stickers",
    "$deposit"                  : "Deposit",
    "$most.popular"             : "Most Popular",
    "$premium.new"              : "Premium New",
    "$contributor.new"          : "Contributor New",
    "$free.new"                 : "Free New",
    "$premium.category"         : "Premium Category",
    "$premium.newest"           : "Premium Newest",
    "$contributor.category"     : "Contributor Category",
    "$contributor.newest"       : "Contributor Newest",
    "$buy.sticker"              : "Buy Sticker",
    "$click.sticker.preview"    : "Click on a sticker to preview",
    "$buy"                      : "Buy",
    "$transaction.history"      : "PURCHASE HISTORY",
    "$my.sticker.collection"    : "My Sticker Collection",
    "$shop.now"                 : "Shop Now",
    "$delete.sticker"           : "Delete Sticker",
    "$set.priority.sticker"     : "SET STICKER PRIORITY",
    "$start.date"               : "Start date",
    "$end.date"                 : "End date",
    "$until"                    : "Until",
    "$not.yet.download.sticker" : "No stickers?! What are you, a fuddyduddy?",
    "$find.now"                 : "Download one today!",
    "$i.have:"                  : "I have:",
    "$store.description"        : "Enter the CIAYO store and, well, buy stuff!",
    "$inventory.description"    : "Open your inventory and manage your knick-knacks!",

    /* ui.trending */
    "$post"                     : "Post",
    "$people"                   : "People",
    "$activity"                 : "Activity",
    "$place"                    : "Place",
    "$follower"                 : "Follower",
    "$posted"                   : "Posted",
    "$visited"                  : "Visited ",
    "$times"                    : "times",

    /* util */
    "$year"                     : "year",
    "$month"                    : "month",
    "$day"                      : "day",
    "$hour"                     : "hour",
    "$minute"                   : "minute",
    "$second"                   : "second",
    "$ago"                      : "ago",
    "$just.now"                 : "just now",

    /* landing page */
    "$landing.1.h"              : "Your Life.<br>Illustrated.",
    "$landing.1.p"              : "Our brand of activities<br>will make everything you do everyday<br>more fun through colorful illustrations!",
    "$landing.2.h"              : "Win them all,<br>collect them all",
    "$landing.2.p"              : "Show your friends how good you are at life<br>through over-the-top thropies - Our Achievements, that is.",
    "$landing.3.h"              : "Express dem feels",
    "$landing.3.p"              : "Utilize funny CIMOTIONS<br>to let people know what you truly feel.",
    "$landing.4.h"              : "Be whoever<br>you wanna be",
    "$landing.4.p"              : "Unleash your inner creativity<br>and be whoever you want to be without worry.",

    /* deactivate */
    "$reactivate"                 : "Reactivate",
    "$login.with.another.account" : "Login with another account",
    "$new"                      :"new",
	  "$fb.error"									: "Facebook share is currently unavailable, please contact your network provider or try again later."
};

var ID = {
    "$make.new.ciayo"           : "Buat akun CIAYO baru dan mulai bereksplorasi",
    "$create.an.account"        : "Buat akun CIAYO baru dan mulai bereksplorasi",
    "$phone"                    : "Telepon",
    "$your.email"               : "Email",
    "$your.phone.number"        : "Nomor Telepon",
    "$create.password"          : "Kata Sandi",
    "$register"                 : "Daftar",
    "$login"                    : "Masuk",
    "$mascot"                   : "Maskot",
    "$term.policy"              : "Dengan mengeklik Mendaftar, Kamu telah setuju dengan <a href=\"{{terms}}\">Persyaratan</a> kami, dan berarti kamu telah membaca <a href=\"{{data_policy}}\">Kebijakan Data</a> kami",
    "$login.your.account"       : "Masuk ke Akun Kamu",
    "$your.password"            : "Kata Sandi",
    "$enter"                    : "Masuk",
    "$forgot.password?"         : "Lupa Kata Sandi?",
    "$back.to.login"            : "Kembali ke login",
    "$get.access.your.account"  : "Mendapatkan akses ke akun Kamu",
    "$must.be.character"        : "Minimal 8 karakter",
    "$disallowed.character"     : "Tidak boleh memasukkan karakter ini <br/> ( \" , ', _ , & , ( , ) , < , > , space , / , \ )",
    "$hallo"                    : "Halo",
    "$hi.."                     : "Hai..",
    "$ciayo.friends..."         : "CIAYO Friends…",
    "$welcome.to.ciayo"         : "Selamat datang di CIAYO World",
    "$fill.nickname"            : "Isi nama Kamu di sini",
    "$username.already.exist"   : "Maaf, nama akun ini sudah ada..!!",
    "$when.your.birth"          : "Kapan Kamu lahir",
    "$select.your.gender"       : "Pilih Kamu yang mana",
    "$male"                     : "Laki-laki",
    "$female"                   : "Perempuan",
    "$create.your.avatar"       : "Bikin Avatar Kamu",
    "$free.to.join"             : "Bebas bergabung",
    "$meet.new.connection"      : "Buat koneksi baru. Jadilah terkenal.",
    "$see.whatsup.ciayo"        : "Lihat ada apa di CIAYO World",
    "$make.new.connection"      : "Buat koneksi baru. Jadilah terkenal.",
    "$not.ciayo.member.yet"     : "Belum jadi member CIAYO?",
    "$already.an.ciayo.member"  : "Sudah jadi member CIAYO?",
    "$not.found"                : "Hasil pencarian tidak ditemukan, coba lagi ya :)",
    
    /* ui.topbar */
    "$search.cayers"            : "Cari CIAYO Friends",
    "$timeline"                 : "Timeline",
    "$notification"             : "Notifikasi",
    "$message"                  : "Pesan",
    "$request"                  : "Permintaan",
    "$trending"                 : "Trending",
    "$achievements"             : "Achievement",
    "$store"                    : "Store",
    "$setting"                  : "Pengaturan",
    "$mark.all.read"            : "Tandai sudah dibaca",
    "$see.all"                  : "Lihat Semua",
    "$friend.requests"          : "Permintaan Teman",
    "$find.friends"             : "Temukan Teman",
    "$trending"                 : "Trending",
    "$dont.connect.request"     : "Maaf, Kamu tidak memiliki permintaan koneksi",
    "$dont.any.notification"    : "Maaf, Kamu tidak memiliki notifikasi",
    "$all.people"               : "Semua Orang",
    "$friends"                  : "Teman",
    "$following"                : "Mengikuti",
    "$result.for"               : "Hasil Untuk",
    
    /* ui.timeline */
    "$what.areyou.doing?"       : "Cari Activity, Item atau Places",
    "$give.reaction"            : "kasih CIMOTIONS",
    "$who.gave.reaction"        : "Yang kasih CIMOTIONS",
    "$view.more.comment..."     : "Lihat komen lainnya…",
    "$reply.comment"            : "Komen Balasan",
    "$write.comment..."         : "Tulis komen...",
    "$share.activity"           : "Bagikan Activity-mu",
    "$who.shared.post"          : "Siapa yang bagi post",
    "$save.picture?"            : "Mau simpan gambar ini?",
    "$save"                     : "Simpan",
    "$post.permission"          : "Ijin Post",
    "$who.see.this?"            : "Yang bisa lihat post?",
    "$public"                   : "Publik",
    "$report.post"              : "Lapor Post",
    "$turnoff.notification"     : "Matikan Notifikasi",
    "$edit.post"                : "Ubah Post",
    "$caption"                  : "Caption",
    "$edit.caption"             : "Ubah Caption",
    "$with"                     : "Dengan",
    "$edit.with"                : "Edit With",
    "$search.friend..."         : "Cari Teman...",
    "$delete.post"              : "Hapus Post",
    "$sure.delete.post?"        : "Yakin mau hapus postingan ini?",
    "$yes"                      : "Ya",
    "$no"                       : "Tidak",
    "$check.myprofile"          : "Lihat Profil Saya",
    "$follow"                   : "Ikuti",
    "$unfollow"                 : "Tidak Mengikuti",
    "$add.as.friend"            : "Tambah Teman",
    "$check.me"                 : "Lihat Profil",
    "$sticker"                  : "Stiker",
    "$emoji"                    : "Emoji",
    "$shop"                     : "Shop",
    "$next"                     : "Lanjut",
    "$back"                     : "Kembali",
    "$nopeople.give.reaction"   : "Tidak ada CIMOTIONS",
    "$add.friend"               : "Tambah teman",
    "$respond.friend.request"   : "Terima permintaan teman",
    "$friend.request.sent"      : "Permintaan teman terkirim",
    "$response.friend.request"  : "Terima permintaan teman",
    "$cancel.friend.request"    : "Batalkan permintaan teman",
    "$no.comment.post!"         : "Ga ada komen di postingan ini!",
    "$no.body.share"            : "Ga ada yang nge-share postingan ini",
    "$write.your.caption"       : "Tulis caption Kamu",
    "$search.items"             : "Cari item",
    "$who.with.you?"            : "dengan siapa kamu?",
    "$tag.someone"              : "Tag seseorang",
    "$remove"                   : "Hapus",
    "$replace"                  : "Ganti",
    "$alone"                    : "Sendiri",
    "$secret"                   : "Rahasia",
    "$no.item"                  : "Ga ada item",
    "$now"                      : "Hari ini",
    "$where.are.you?"           : "kamu lagi di mana?",
    "$ask.with"                 : "Kamu ingin tanya dengan siapa ",
    "$ask.with.when"            : " di activity ini?",
    "$ask.place"                : "Kamu ingin tanya dimana ",
    "$ask.place.when"           : " di activity ini?",
    "$asking.place"             : "bertanya dimana kamu di activity ini?",
    "$asking.with"              : "bertanya dengan siapa kamu di activity ini?",
    "$response.friend.question" : "Tanggapi pertanyaan teman kamu",
    "$tag.friend"               : "Tag teman",
    "$ask.for"                  : "Tanyakan",
    "$place.date.birthday"      : "tempat dan tanggal lahir",
    "$let"                      : "Beri tahu",
    "$ask.birthday"             : "kenapa kamu menanyakan tempat dan tanggal lahirnya",
    "$ask.email"                : "kenapa kamu menanyakan alamat emailnya",
    "$ask.phone"                : "kenapa kamu menanyakan nomor teleponnya",
    "$send.request"             : "Kirim Permintaan",
    
    /* ui.social.media */
    "$YOUR.ACCOUNT"             : "AKUN",
    "$edit.profile"             : "Edit Profil",
    "$change.password"          : "Ganti Kata Sandi",
    "$privacy.setting"          : "Pengaturan Privasi",
    "$PRIVACY.SETTING"          : "PENGATURAN PRIVASI",
    "$manage.socmed"            : "Kelola Media Sosial",
    "$MANAGE.SOCMED"            : "KELOLA MEDIA SOSIAL",
    "$blocked.account"          : "Akun yang diblokir",
    "$add.another.socmed"       : "Tambah media sosial lain",
    "$logout"                   : "Keluar",
    "$username"                 : "Nama Pengguna",
    "$are.you.sure.logout?"     : "Kamu yakin mau keluar?",
    
    /* ui.achievement */
    "$ACHIEVEMENT.PACK"         : "ACHIEVEMENT PACK",
    "$search.achievement"       : "Cari Achievement",
    "$ongoing"                  : "Berlangsung",
    "$completed"                : "Lengkap",
    "$sort.by"                  : "Urutkan",
    "$higher.progress"          : "Progres Tertinggi",
    "$lower.progress"           : "Progres Terendah",
    "$last.update"              : "Terakhir di-update {{date}}",
    "$badge"                    : "Badge",
    "$achievement"              : "Achievement",
    "$badges"                   : "Badges",
    "$all"                      : "Semua",
    "$on.going"                 : "Berlangsung",
    "$sort"                     : "Sortir",
    "$showing.achievement"      : "Menampilkan Achievement ",
    "$of"                       : " dari ",
    "$share.to:"                : "Bagikan Achievement ini",
    "$use.as.title"             : "Pakai Titel",
    "$ascending(a-z)"           : "Diurutkan (A - Z)",
    "$descending(z-a)"          : "Diurutkan (Z - A)",
    "$highest.to.lowest"        : "Tertinggi ke Terendah",
    "$lowest.to.high"           : "Terendah ke Tertinggi",
    "$achieve.em.all"           : "Dapetin semua!",
    "$updated.on"               : "Waktu dapetin",
    
    /* ui.change.password */
    "$YOUR.ACCOUNT"             : "AKUN",
    "$CHANGE.PASSWORD"          : "GANTI KATA SANDI",
    "$old.password"             : "Kata Sandi Lama",
    "$new.password"             : "Kata Sandi Baru",
    "$confirm.new.password"     : "Konfirmasi kata sandi baru",
    "$password.not.valid"       : "Kata sandi tidak valid",
    "$use.case.sensitive"       : "Menggunakan kata sandi yang sensitif",

    /* ui.blocked.account */
    "$BLOCKED.ACCOUNT"          : "BLOKIR AKUN",
    "$block.more.friend?"       : "Blokir lebih banyak teman?",
    
    /* ui.create.avatar.born */
    "$WHERE.YOU.BORN"           : "DI MANA KAMU LAHIR",
    "$date.of.birth"            : "Tanggal Lahir",
    "$place.of.birth"           : "Tempat Lahir",
    "$date/month/year"          : "Tanggal / Bulan / Tahun",
    
    /* ui.create.avatar.nation */
    "$NATIONALITY"              : "KEBANGSAAN",
    "$nationality"              : "Kebangsaan",
    "$select.nationality"       : "Pilih Kebangsaan",
    
    /* ui.create.avatar.uavatar */
    "$YOUR.AVATAR"              : "AVATAR MU",
    "$enter.ciayo.world"        : "Masuk ke CIAYO World",
    "$download.avatar"          : "Unduh Avatar",
    "$you.look.great!"          : "Kamu terlihat keren!",
    
    /* ui.edit.profile */
    "$EDIT.ACCOUNT"             : "EDIT AKUN",
    "$profile.picture"          : "Foto Profil",
    "$edit.avatar.explanation"  : "Penjelasan tentang edit Avatar",
    "$edit.avatar.filter"       : "Edit Avatar di filter",
    "$choose.name.profile"      : "Pilih Nama di Foto Profil",
    "$full.name"                : "Nama Lengkap",
    "$first.name"               : "Nama Depan",
    "$middle.name"              : "Nama Tengah",
    "$last.name"                : "Nama Belakang",
    "$screen.name"              : "Nama Display",
    "$login.notification"       : "Notifikasi Login",
    "$deactive.account?"        : "Yakin nih, mau menonaktifkan akun?",
    "$deactive.account"         : "Menonaktifkan Akun",
    "$when.account.deactive"    : "Ketika akun Kamu dinonaktifkan, orang-orang tidak bisa mengirim pesan, menemukan, dan tag kamu di CIAYO.",
    "$delete.account?"          : "Yakin nih, mau menghapus akun?",
    "$delete.account"           : "Hapus Akun",
    "$when.delete.account"      : "Ketika akun Kamu dihapus, orang-orang tidak bisa mengirim pesan, menemukan, dan tag kamu di CIAYO.",
    "$show.notif.toemail"       : "Tampilkan notifikasi ke email atau telepon saya jika ada yang login ke akun saya.",
    "$restore.default.setting"  : "Kembali ke pengaturan awal",
    "$email"                    : "Email",
    "$email.address"            : "Alamat Email",
    "$phone.number"             : "Nomor Telepon",
    "$dont.have.mutual.friend"  : "Kamu tidak memiliki teman yang sama",
    "$mutual.friend"            : " teman yang sama",
    "$dont.have.badge"          : "Maaf, Kamu belum punya Badge!!",
    "$dont.have.achievement"    : "Maaf, Kamu belum punya Achievement!",
    "$edit.name&title"          : "Edit nama tampilan & titel",
    "$display.name&title"       : "Nama tampilan & titel",
    "$edit.avatar"              : "Edit Avatar",
    
    /* ui.message */
    "$MESSAGES"                 : "PESAN",
    "$search.people..."         : "Cari orang...",
    "$online"                   : "Online",
    "$you.havent.friend?"       : "Kamu belum mendapatkan teman, tambah {{name}}?",
    "$new.message"              : "Pesan baru",
    "$to:"                      : "Kepada:",
    "$write.messsage..."        : "Tulis pesan...",
    "$message.didnt.send"       : "Pesan ini tidak terkirim.",
    "$check.internet.connect"   : "Cek koneksi internet dan coba lagi.",
    "$send"                     : "Kirim",
    "$enter.to.send"            : "Tekan enter untuk mengirim",
    
    /* ui.privacy.setting */
    "$message.privilege"        : "Message Privilege",
    "$post.default.setting"     : "Pengaturan Awal Posting",
    "$filter.view.access"       : "Filter View Access",
    "$who.find.me?"             : "Siapa yang bisa temukan saya?",
    "$timeline.access"          : "Akses timeline",
    "$message.previlage"        : "Pesan Istimewa",
    "$post.default.setting"     : "Pengaturan standar post",
    "$who.can.find.me?"         : "Siapa yang dapat menemukan saya?",
    "$who.can.find.me?"         : "Siapa yang dapat menambahkan saya?",
    "$anyone"                   : "Siapa saja",
    "$friends"                  : "Teman",
    "$best.friends"             : "Sahabat",
    "$families"                 : "Keluarga",
    "$acquitances"              : "Kenalan",
    "$coworkers"                : "Rekan kerja",
    "$onlyme"                   : "Hanya saya",
    
    /* ui.setting */
    "$edit.basic.info"          : "Edit Info Dasar",
    "$EDIT.BASIC.INFO"          : "EDIT INFO DASAR",
    "$edit.account"             : "Edit Akun",
    "$change.password"          : "Ganti Kata Sandi",
    "$privacy.setting"          : "Pengaturan Privasi",
    "$PRIVACY.SETTING"          : "PENGATURAN PRIVASI",
    "$manage.social.media"      : "Kelola Media Sosial",
    "$MANAGE.SOCIAL.MEDIA"      : "KELOLA MEDIA SOSIAL",
    "$general.settings"         : "Pengaturan Umum",
    "$GENERAL.SETTINGS"         : "PENGATURAN UMUM",
    "$blocked.account"          : "Akun Yang Diblokir",
    "$BLOCKED.ACCOUNT"          : "AKUN YANG DIBLOKIR",
    "$display.as.ciayo"         : "Ditampilkan sebagai akun CIAYO Kamu",
    "$verify.your.email"        : "Verifikasi Email",
    "$verify.phone.number"      : "Verifikasi Nomor Telepon",
    "$username"                 : "Nama pengguna",
    "$card.setting"             : "Pengaturan Card",
    "$parallax.view.timeline"   : "Tampilan Parallax di Timeline",
    "$parallax.info"            : "Parallax memungkinkan kamu untuk melihat gambar activity dalam perspektif seperti 3D",
    "$notification.setting"     : "Pengaturan Notifikasi",
    "$notification.alerts"      : "Nada Notifikasi",
    "$friend.requests"          : "Permintaan Koneksi",
    "$have.friend.request"      : "Kamu mempunyai {{number}} permintaan teman",
    "$comment.alerts"           : "Komentar",
    "$language.settings"        : "Pengaturan Bahasa",
    "$language.use.ciayo?"      : "Bahasa apa yang mau Kamu gunakan di CIAYO?",
    "$email.notification"       : "Notifikasi Email",
    "$reset.password"           : "Reset Kata Sandi",
    "$login.failed"             : "Login Gagal",
    "$account.deactivation"     : "Menonaktifkan Akun",
    "$account.deletion"         : "Hapus Akun",
    "$new.features"             : "Fitur Baru",
    "$to.verify.email"          : "Untuk verifikasi akun Kamu, silakan masukkan One-time PIN yang diterima melalui email yang sudah terdaftar: ",
    "$to.verify.phone"          : "Untuk verifikasi akun, silahkan masukan PIN yang telah dikirim via SMS pada nomor ponsel yang terdaftar : ",
    "$send"                     : "Kirim",
    "$resend"                   : "Kirim Ulang",
    "$verification.later"       : "Verifikasi Nanti",
    "$change.email?"            : "Ganti Email?",
    "$change.mobile.number?"    : "Ganti nomor seluler?",
    "$old.password.didnt.match" : "Sandi lama tidak cocok",
    "$password.didnt.match"     : "Sandi tidak cocok",
    "$success.change.password"  : "Berhasil merubah sandi",
    "$success.delete.socmed"    : "Berhasil menghapus sosial media",
    "$success.update.socmed"    : "Berhasil merubah sosial media",
    "$success.add.socmed"       : "Berhasil menambahkan sosial media",
    "$success.verified"         : "Akun telah terverifikasi",
    "$code.invalid"             : "Kode verifikasi tidak valid",
    "$already.block.user"       : "User ini telah diblokir",
    "$success.block.user"       : "User berhasil diblokir",
    "$success.unblock.user"     : "User berhasil  di-unblock",
    "$ABOUT.US"                 : "TENTANG KAMI",
    "$about.us"                 : "Tentang Kami",
    "$PRIVACY.AND.POLICY"       : "PRIVASI DAN KEBIJAKAN",
    "$privacy.and.policy"       : "Privasi dan Kebijakan",
    "$TERMS.AND.CONDITIONS"     : "KETENTUAN DAN KONDISI",
    "$terms.and.conditions"     : "Ketentuan dan Kondisi",
    "$FAQ"                      : "FAQ",
    "$all.rights.reserved"      : "Hak Cipta Dilindungi",
    "$congratulation!"          : "Yeay!",
    "$success.verify"           : "Akun Kamu sudah siap. Saatnya kita main CIAYO!",
    "$has.been.verify"          : "Akun telah terverifikasi",
    "$success.change.profile"   : "Berhasil merubah profile setting",

    /* ui.profile */
    "$overview"                 : "Profil",
    "$timeline"                 : "Timeline",
    "$connection"               : "Koneksi",
    "$friends"                  : "Teman",
    "$achievement"              : "Achievement",
    "$about.me"                 : "Tentang Saya",
    "$website"                  : "Situs Web",
    "$your.website"             : "Situs Web Kamu",
    "$social.media"             : "Media Sosial",
    "$add.social.media"         : "Tambahkan media sosial",
    "$put.social.media"         : "Kamu juga bisa tambahkan URL dari akun media sosial di sini",
    "$badge.collection"         : "Koleksi Badge",
    "$achievement.collection"   : "Koleksi Achievement",
    "$place.date.birth"         : "Tempat, Tanggal Lahir",
    "$add.badge"                : "Tambah Badge",
    "$add.achievement"          : "Tambah Achievement",
    "$pick.achievement"         : "Pilih Achievement untuk ditampilkan di Profil",
    "$pick.badge"               : "Pilih Badge untuk ditampilkan di Profil",
    "$search"                   : "Cari",
    "$save"                     : "Simpan",
    "$cancel"                   : "Batal",
    "$view.profile"             : "Lihat Profil",
    "$displayname&title"        : "Nama Tampilan & Titel",
    "$title"                    : "Titel",
    "$displayname"              : "Nama tampilan",
    "$all.friends"              : "Semua teman",
    "$search.friends"           : "Cari teman",
    "$data.not.found"           : "Data tidak ditemukan",
    "$block"                    : "Blokir",
    "$no.badge.collections"     : "Tidak punya koleksi badge",
    "$no.social.network.added"  : "Tidak ada sosial media",
    "$no.website.added"         : "Tidak ada situs web",

    /* ui.store */
    "$store"                    : "Store",
    "$search.sticker"           : "Cari Sticker, Item atau Emoji",
    "$inventory"                : "Inventory",
    "$check.now"                : "Cek Sekarang",
    "$home"                     : "Beranda",
    "$premium"                  : "Premium",
    "$contributor"              : "Kontributor",
    "$free"                     : "Gratis",
    "$all.sticker"              : "Semua Sticker",
    "$deposit"                  : "Deposit",
    "$most.popular"             : "Paling populer",
    "$premium.new"              : "Koleksi Premium Baru",
    "$contributor.new"          : "Koleksi Kontributor Baru",
    "$free.new"                 : "Koleksi Gratis",
    "$premium.category"         : "Kategori Premium",
    "$premium.newest"           : "Premium Terbaru",
    "$contributor.category"     : "Kategori Kontributor",
    "$contributor.newest"       : "Kontributor Terbaru",
    "$buy.sticker"              : "Beli Sticker",
    "$click.sticker.preview"    : "Klik Sticker kalau mau lihat",
    "$buy"                      : "Beli",
    "$my.sticker"               : "Sticker Saya",
    "$set.priority.sticker"     : "Set Prioritas Sticker",
    "$transaction.history"      : "Riwayat Pembelian",
    "$my.sticker.collection"    : "Koleksi Sticker Ku",
    "$shop.now"                 : "Beli Sekarang",
    "$delete.sticker"           : "Hapus Sticker",
    "$set.priority.sticker"     : "Set Sticker Prioritas",
    "$start.date"               : "Tanggal mulai",
    "$end.date"                 : "Tanggal berakhir",
    "$until"                    : "Sampai",
    "$not.yet.download.sticker" : "Kamu belum mendownload Sticker hari ini, mau donwload?",
    "$find.now"                 : "Temukan sekarang",
    "$i.have:"                  : "Kantong Saya",
    "$store.description"        : "Enter the CIAYO store and, well, buy stuff!",
    "$inventory.description"    : "Open your inventory and manage your knick-knacks!",

    /* ui.trending */
    "$post"                     : "Post",
    "$people"                   : "Orang",
    "$activity"                 : "Activity",
    "$place"                    : "Tempat",
    "$follower"                 : "Pengikut",
    "$posted"                   : "Diposting",
    "$visited"                  : "Dikunjungi ",
    "$times"                    : "kali",

    /* util */
    "$year"                     : "tahun",
    "$month"                    : "bulan",
    "$day"                      : "hari",
    "$hour"                     : "jam",
    "$minute"                   : "menit",
    "$second"                   : "detik",
    "$ago"                      : "yang lalu",
    "$just.now"                 : "baru saja",

    "only me"                   : "hanya saya",
    "public"                    : "publik",
    "family"                    : "keluarga",
    "friend"                    : "teman",

    /* landing page */
    "$landing.1.h"              : "Your Life.<br>Illustrated.",
    "$landing.1.p"              : "Our brand of activities<br>will make everything you do everyday<br>more fun through colorful illustrations!",
    "$landing.2.h"              : "Win them all,<br>collect them all",
    "$landing.2.p"              : "Show your friends how good you are at life<br>through over-the-top thropies - Our Achievements, that is.",
    "$landing.3.h"              : "Express dem feels",
    "$landing.3.p"              : "Utilize funny CIMOTIONS<br>to let people know what you truly feel.",
    "$landing.4.h"              : "Be whoever<br>you wanna be",
    "$landing.4.p"              : "Unleash your inner creativity<br>and be whoever you want to be without worry.",

     /* deactivate */
    "$reactivate"                 : "Reactivate",
    "$login.with.another.account" : "Login with another account",
	
		"$new"                        : "baru",
		"$fb.error"										: "Facebook share saat ini tidak dapat diakses, silahkan hubungi penyedia layanan jaringan anda atau cobalah beberapa saat lagi."
};
var NO = {
};;
(function () {
	'use strict';

	angular
		.module('app', ['ngMaterial', 'ngCookies', 'ui.router', 'ngAnimate', 'door3.css', 'ngMaterial', "CiayoUtil", "CiayoParallax", "CiayoParallaxFix", "CiayoPost", "CiayoCard", "CiayoSetting", "CiayoHeader", "CiayoHeaderPublic", "CiayoFriendConnection", "CiayoProfile", 'CiayoModal', "pascalprecht.translate", 'btford.socket-io', 'angular-click-outside', 'ngSanitize', 'bc.Flickity', 'angulartics', 'angulartics.google.analytics'])
		.config(config)
		.run(run);

	config.$inject = ['$stateProvider', '$urlRouterProvider', '$httpProvider', '$mdThemingProvider', '$translateProvider', '$locationProvider', '$cookiesProvider'];

	function config($stateProvider, $urlRouterProvider, $httpProvider, $mdThemingProvider, $translateProvider, $locationProvider, $cookiesProvider) {
		if (!$cookiesProvider.defaults.expires) {
			var date = new Date();
			date.setDate(date.getDate() + 7);
			$cookiesProvider.defaults.expires = date;
		}

		$locationProvider.html5Mode(!DEVELOPMENT);

		$translateProvider.translations('en', EN)
		$translateProvider.translations('id', ID)
		$translateProvider.translations('no', NO)
		$translateProvider.useSanitizeValueStrategy('escapeParameters')
		var language_key = ['en', 'id']
		$translateProvider.preferredLanguage('id');


		// setting material theme
		$mdThemingProvider.theme('default').primaryPalette('ciayo-dark-blue').accentPalette('ciayo-blue');

		// setting auth interceptor for headers authorization
		//$httpProvider.interceptors.push('AuthInterceptor');
		// route yang terdaftar
		$urlRouterProvider.when('', '/', ['$state', function ($state) {
			$state.go('/');
		}]);
		// default router
		$urlRouterProvider.otherwise("404");
		// Set Routing
		$stateProvider
			.state('/', {
				url: '/',
				templateUrl: 'views/timeline.html',
				// css: 'assets/css/timeline.css',
				controller: 'TimelineController',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('/deactivate', {
				url: '/deactivate',
				templateUrl: 'views/deactivate.html',
				// css: 'assets/css/deactivate.min.css',
				//controller: 'TimelineController',
				//controllerAs: 'vm',
				authenticate: false
			})
			.state('404', {
				url: '/404',
				templateUrl: 'views/404.html',
				// css: 'assets/css/error.min.css',
				// controller: 'TimelineController',
				// controllerAs: 'vm',
				authenticate: false
			})
			.state('403', {
				url: '/403',
				templateUrl: 'views/403.html',
				// css: 'assets/css/error.min.css',
				// controller: 'TimelineController',
				// controllerAs: 'vm',
				authenticate: false
			})
			.state('401', {
				url: '/401',
				templateUrl: 'views/401.html',
				// css: 'assets/css/error.min.css',
				// controller: 'TimelineController',
				// controllerAs: 'vm',
				authenticate: false
			})
			.state('500', {
				url: '/500',
				templateUrl: 'views/500.html',
				// css: 'assets/css/error.min.css',
				// controller: 'TimelineController',
				// controllerAs: 'vm',
				authenticate: false
			})
			.state('timeline', {
				url: '/timeline',
				templateUrl: 'views/timeline.html',
				// css: 'assets/css/timeline.css',
				controller: 'TimelineController',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('profile', {
				url: '/profile/:user',
				templateUrl: 'views/profile.html',
				// css: ['assets/css/profile.min.css','assets/css/timeline.css'],
				controller: 'ProfileController',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('welcome', {
				url: '/welcome?ref',
				templateUrl: 'views/welcome.html',
				css: 'assets/css/welcome.min.css',
				controller: 'WelcomeController',
				controllerAs: 'vm',
				authenticate: false
			})
			.state('popcon', {
				url: '/popcon',
				templateUrl: 'views/welcome.html',
				css: 'assets/css/welcome.min.css',
				controller: 'WelcomeController',
				controllerAs: 'vm',
				authenticate: false
			})
			.state('reset-password', {
				url: '/reset-password/:token',
				templateUrl: 'views/reset-password.html',
				css: 'assets/css/welcome.min.css',
				controller: 'WelcomeController',
				controllerAs: 'vm',
				authenticate: false
			})
			.state('create-avatar', {
				url: '/create-avatar',
				templateUrl: 'views/create-avatar.html',
				// css: 'assets/css/create-avatar.min.css',
				controller: 'CreateAvatarController',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('edit-avatar', {
				url: '/edit-avatar',
				templateUrl: 'views/edit-avatar.html',
				// css: 'assets/css/create-avatar.min.css',
				controller: 'EditAvatarController',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('download-avatar', {
				url: '/download-avatar',
				templateUrl: 'views/download-avatar.html',
				// css: 'assets/css/download-avatar.css',
				controller: 'DownloadAvatar',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('select-mascot', {
				url: '/select-mascot',
				templateUrl: 'views/select-mascot.html',
				// css: 'assets/css/select-mascot.css',
				controller: 'SelectMascotController',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('search-result', {
				url: '/search-result/:search_text',
				templateUrl: 'views/search-result.html',
				// css: 'assets/css/search-result.min.css',
				controller: 'ConnectionSearchResult',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('notification', {
				url: '/notification',
				templateUrl: 'views/notification.html',
				// css: 'assets/css/notification.min.css',
				controller: 'ConnectionNotification',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('friend-request', {
				url: '/friend-request/:page',
				defaultParams: {
					page: 1
				},
				templateUrl: 'views/friend-request.html',
				// css: 'assets/css/friend-request.min.css',
				controller: 'ConnectionFriendRequest',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('achievement', {
				url: '/achievement',
				templateUrl: 'views/achievement.html',
				// css: 'assets/css/achievement.min.css',
				controller: 'AchievementController',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('store', {
				abstract: true,
				url: '/store',
				templateUrl: 'views/store.html',
				// css: 'assets/css/store.min.css',
				controller: 'StoreController',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('store.home', {
				url: '',
				templateUrl: 'views/store.home.html',
				// css: 'assets/css/store.min.css',
				authenticate: true
			})
			.state('store.premium', {
				url: '/premium/:category',
				templateUrl: function ($stateParams) {
					if ($stateParams.category) {
						return 'views/store.category.html';
					} else {
						return 'views/store.premium.html';
					}
				},
				// css: 'assets/css/store.min.css',
				authenticate: true
			})
			.state('store.contributor', {
				url: '/contributor/:category',
				templateUrl: function ($stateParams) {
					if ($stateParams.category) {
						return 'views/store.category.html';
					} else {
						return 'views/store.contributor.html';
					}
				},
				// css: 'assets/css/store.min.css',
				authenticate: true
			})
			.state('store.free', {
				url: '/free',
				templateUrl: 'views/store.free.html',
				// css: 'assets/css/store.min.css',
				authenticate: true
			})
			.state('store.emoji', {
				url: '/emoji',
				templateUrl: 'views/store.emoji.html',
				// css: 'assets/css/store.min.css',
				authenticate: true
			})
			.state('store.all', {
				url: '/all',
				templateUrl: 'views/store.all.html',
				// css: 'assets/css/store.min.css',
				authenticate: true
			})
			.state('store.search', {
				url: '/search/:keyword',
				templateUrl: 'views/store.search.html',
				// css: 'assets/css/store.min.css',
				authenticate: true
			})
			.state('inventory', {
				abstract: true,
				url: '/inventory',
				templateUrl: 'views/inventory.html',
				// css: 'assets/css/store.min.css',
				controller: 'InventoryController',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('inventory.home', {
				url: '',
				templateUrl: 'views/inventory.home.html',
				// css: 'assets/css/store.min.css',
				authenticate: true
			})
			.state('inventory.priority', {
				url: '/priority',
				templateUrl: 'views/inventory.priority.html',
				// css: 'assets/css/store.min.css',
				authenticate: true
			})
			.state('inventory.transaction', {
				url: '/transaction',
				templateUrl: 'views/inventory.transaction.html',
				// css: 'assets/css/store.min.css',
				authenticate: true
			})
			.state('inventory.search', {
				url: '/search/:keyword',
				templateUrl: 'views/inventory.search.html',
				// css: 'assets/css/store.min.css',
				authenticate: true
			})
			.state('setting', {
				url: '/setting/:menu',
				templateUrl: 'views/setting.html',
				// css: 'assets/css/ciayo-setting.min.css',
				controller: 'SettingController',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('delete-account', {
				url: '/account/:menu/:token',
				templateUrl: 'views/setting.html',
				// css: 'assets/css/ciayo-setting.min.css',
				controller: 'SettingController',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('verify', {
				url: '/verify/:menu?email&phone&code',
				templateUrl: 'views/setting.html',
				// css: 'assets/css/ciayo-setting.min.css',
				controller: 'SettingController',
				controllerAs: 'vm',
				authenticate: false
			})
			.state('detail-page', {
				url: '/detail-page/:post_id',
				templateUrl: 'views/detail-page.html',
				// css: 'assets/css/timeline.css',
				controller: 'DetailPageController',
				controllerAs: 'vm',
				authenticate: false
			}).state('about-us', {
				url: '/about-us',
				templateUrl: 'views/static.html',
				controller: 'StaticController',
				params: {
					type: 1
				},
				controllerAs: 'vm',
				authenticate: false
			})
			.state('privacy-and-policy', {
				url: '/privacy-and-policy',
				templateUrl: 'views/static.html',
				controller: 'StaticController',
				params: {
					type: 3
				},
				controllerAs: 'vm',
				authenticate: false
			})
			.state('terms-and-conditions', {
				url: '/terms-and-conditions',
				templateUrl: 'views/static.html',
				controller: 'StaticController',
				params: {
					type: 2
				},
				controllerAs: 'vm',
				authenticate: false
			})
			.state('faq', {
				url: '/faq',
				templateUrl: 'views/static.html',
				controller: 'StaticController',
				params: {
					type: 6
				},
				controllerAs: 'vm',
				authenticate: false
			})
			.state('trending', {
				url: '/trending',
				templateUrl: 'views/trending.html',
				// css: 'assets/css/trending.min.css',
				controller: 'TrendingController',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('reactivate-account', {
				url: '/reactivate-account',
				templateUrl: 'views/reactivate-account.html',
				controller: 'SettingController',
				controllerAs: 'vm',
				authenticate: true
			})
			.state('update', {
				url: '/update',
				templateUrl: 'views/update.html',
				controller: 'UpdateLogController',
				controllerAs: 'vm',
				authenticate: true
			})
			// .state('profile-public', {
			// 	url: '/:user',
			// 	templateUrl: 'views/profile.html',
			// 	// css: ['assets/css/profile.min.css','assets/css/timeline.css'],
			// 	controller: 'ProfileController',
			// 	controllerAs: 'vm',
			// 	authenticate: true
			// })
			// .state('profile-publics', {
			// 	url: '/:user',
			// 	templateUrl: 'views/profile-public.html',
			// 	// css: ['assets/css/profile.min.css','assets/css/timeline.css'],
			// 	//css: 'assets/css/welcome.min.css',
			// 	controller: 'ProfilePublicController',
			// 	controllerAs: 'vm',
			// 	authenticate: false
			// })
			.state('profile-publics', {
				url: '/:user',
				templateUrl: 'views/profile-template.html',
				controllerProvider: function (AuthService) {

					var ctrl = '';
					if (AuthService.IsAuth()) {
						ctrl = "ProfileController";
					} else {
						ctrl = "ProfilePublicController";
					}
					return ctrl;

				},
				controllerAs: 'vm',
				authenticate: false
			});
	}

	run.$inject = ['$rootScope', '$state', '$cookieStore', 'AuthService', 'SettingService', '$translate', 'modalFactory'];

	function run($rootScope, $state, $cookieStore, AuthService, SettingService, $translate, modalFactory) {
		if ($cookieStore.get('language')) {
			SettingService.getLanguage().then(function(data) {
				var lang_code = ['', 'en', 'id'];
				$translate.use(lang_code[data.content.language]);
			});
		}

		$rootScope.$on('$stateChangeStart', function (event, toState, toParams, fromState, fromParams) {
			$rootScope.last = {
				fromState: fromState,
				fromParams: fromParams,
				toState: toState,
				toParams: toParams
			};
			if (toState.authenticate) {

				if (!AuthService.IsAuth()) {
					$state.transitionTo('welcome');
					event.preventDefault();
				} else {
					if (!$cookieStore.get('profile') && !(toState.name == 'create-avatar' || toState.name == 'download-avatar' || toState.name == 'welcome' || toState.name == 'select-mascot')) {
						$state.transitionTo('create-avatar');
						event.preventDefault();
					}
					if ($cookieStore.get('profile') && (toState.name == 'create-avatar' || toState.name == 'welcome' || toState.name == 'select-mascot')) {
						$state.transitionTo('timeline');
						event.preventDefault();
					}
					// if(!$cookieStore.get('active')  && toState.name!='reactivate-account' && toState.name!='welcome'){
					// 	$state.transitionTo('reactivate-account');
					// 	event.preventDefault();
					// }
				}


			}

		});
	}

})();;
(function() {
'use strict';

	angular
		.module('app')
		.controller('AchievementController', AchievementController);

	AchievementController.$inject = ['CiayoService','CiayoBanner','facebookFactory','AchievementService','modalFactory'];
	function AchievementController(CiayoService, CiayoBanner,facebookFactory,AchievementService,modalFactory) {
		var vm = this;

		vm.init = init;
		vm.listBadge = [];
		vm.listBadgeEmpty = false;
		vm.listAchievement = [];
		vm.listAchievementEmpty = false;
		vm.tabSelected = 'all';
		vm.allItem = 0;
		vm.noData = '';
		vm.orderType = 'name';
		vm.orderBy = 'asc';

		CiayoBanner.getData("achievement", function(response){
			vm.banner = response.data.c.data.content.image;
			setTimeout(function(){
				$('.c-banner').children("ul").parallax({
					clipRelativeInput: false,
					originY: 0.0
				});
			}, 1)
		}, function(){

		})

		function init() {
			var c = {
				data: {
					"orderType": "score",
					"orderBy": "asc"
				}
			}

			CiayoService.Api('badge', c, function(response){
				if(response.status == 200){
					var data = response.data.c.data.content.data;
					if(data.length){
						vm.listBadge = data;
					} else {
						vm.listBadgeEmpty = true;
					}
					//console.log(vm.listAchievement);
				} else {
					alert('error jow !');
				}
			});
		}

		vm.init();

		vm.itemDetail = null;
		vm.viewDetail = viewDetail;
		vm.closeDetail = closeDetail;
		angular.extend(vm,{
			shareFB:shareFB
		});
		function shareFB(id_achievement,id) {
			var access_token = '';
			var uid = '';
			if(!vm.isFB) {
				vm.isFB = true;
				facebookFactory.getToken(function (data) {
					access_token = data.accessToken;
					uid = data.uid;
					AchievementService.shareFB(access_token, uid, id_achievement,id, function (response) {
						var data = response.data.c.data;
						if(data.error==false){
							closeDetail();
							modalFactory.message(data.message);
							vm.isFB = false;
						}
					}, function () {

					});
				});
			}
		}
		function viewDetail(id) {
			vm.itemDetail = null;
			var elem = angular.element('.c-modal.achievement');
			elem.addClass('-open');

			var c = {
				data: {
					"id_achievement": id
				}
			};

			CiayoService.Api('achievement/detail', c, function(response) {
				vm.itemDetail = response.data.c.data.content;
				var date = new Date(vm.itemDetail.date_get*1000);
				vm.itemDetail.date_get = date.getDate()+'/'+(date.getMonth()+1)+'/'+date.getFullYear();
				console.log(vm.itemDetail.date_get)
				vm.threshold = vm.itemDetail.treshold.data;
				console.log(vm.threshold);
			});
		}

		function closeDetail() {
			var elem = angular.element('.c-modal.achievement');
			elem.removeClass('-open');
			vm.itemDetail = null;
			vm.threshold = null;
		}

		vm.listProgress = [];
		vm.listProgressEmpty = false;
		vm.listCompleted = [];
		vm.listCompletedEmpty = false;
		vm.changeAchievement = changeAchievement;

		function changeAchievement(url, pg) {
			vm.tabSelected = url;
			var pg = pg || 0;
			var offset = (15 * parseInt(pg - 1)) || 0;
			vm.thisOffset = parseInt(offset) + 1;
			vm.thisEnd = parseInt(pg) * 15;
			
			var c = {
				data: {
					"orderType": vm.orderType,
					"orderBy": vm.orderBy,
					"limit": 15,
					"offset": offset,
					"search": vm.keyword
				}
			}

			if(url == '/progress'){
				vm.listProgress = [];
			} else if(url == '/completed'){
				vm.listCompleted = [];
			} else {
				vm.listAchievement = [];
			}

			if(!isLoaded()) {
				vm.allItem = 0;
				CiayoService.Api('achievement'+url, c, function(response){
					var data = response.data.c.data.content.data;
					vm.allItem = response.data.c.data.meta.total;
					if(vm.allItem < 15 || vm.thisEnd > vm.allItem) vm.thisEnd = vm.allItem;
					//vm.rePagination(vm.allItem, vm.curPage);
					if(response.status == 200){
						if(data.length) {
							if(url == '/progress'){
								vm.listProgressEmpty = false;
								vm.listProgress = data;
							} else if(url == '/completed'){
								vm.listCompletedEmpty = false;
								vm.listCompleted = data;
								console.log(vm.listCompleted);
							} else {
								vm.listAchievementEmpty = false;
								vm.listAchievement = data;
							}
						} else {
							if(url == '/progress'){
								vm.listProgressEmpty = true;
							} else if(url == '/completed'){
								vm.listCompletedEmpty = true;
							} else {
								vm.listAchievementEmpty = true;
							}
						}
					} else {
						alert('error aklejow !');
					}
				});
			}
		}

		function isLoaded() {
			if(vm.tabSelected == '/progress'){
				return vm.listProgress.length?1:0;
			} else if(vm.tabSelected == '/completed'){
				return vm.listCompleted.length?1:0;
			} else {
				return vm.listAchievement.length?1:0;
			}
		}

		vm.curPage = 1;
		vm.pageGoTo = pageGoTo;

		function pageGoTo(pg) {
			vm.curPage = pg;
			vm.changeAchievement(vm.tabSelected, pg);
		}

		vm.changeOrder = changeOrder;
		function changeOrder(type, by){
			vm.orderType = type;
			vm.orderBy = by;
			vm.changeAchievement(vm.tabSelected, vm.curPage);
		}

		vm.setTitle = setTitle;
		function setTitle(title) {
			var c = {
				data: {
					updated_filter: [
						{
							filter_id: 520,
							filter_value: title
						}
					],
					type: 2
				}
			}
			CiayoService.Api('users/filter/update',c,function(response){
				vm.closeDetail();
				modalFactory.message(response.data.c.data.message);
			});
		}
	}
})();;
(function () {
    'use strict';
    angular.module('app')
.controller('activityController', ['$scope','$http', function ($scope, $http) {
    
    // Privacy Setting
    $scope.ptsbs = [
        'Public',
        'Friends'
    ];
    $scope.ptsbSelected = 0;
    $scope.selectPTSB = function(opt){
        $scope.ptsbSelected = opt;
    };
    
    // Privacy Setting Button
    $scope.isActivePTSB = false;
    $scope.togglePTSB = function(){
        $scope.isActivePTSB = !$scope.isActivePTSB;
    };
    
    // Activity (SA)
    $scope.listAct = [];
    $scope.selectedAct = null;
    $scope.selectedActIndex = -1;
    $scope.searchAct = function(){
        $scope.selectedAct = null;
        $scope.selectedActIndex = -1;
        $http.get('../assets/json/activity.json').success(function(data){
            $scope.listAct = data;
        });
    };
    $scope.selectAct = function(index){
        $scope.actKey = $scope.listAct[index].name;
        $scope.selectedAct = $scope.listAct[index];
        $scope.listAct = [];
    };
    $scope.checkKeyDownAct = function(event){
        if(event.keyCode === 40){
            event.preventDefault();
            if($scope.selectedActIndex+1 !== $scope.listAct.length){
                $scope.selectedActIndex++;
            }
        }
        else if(event.keyCode === 38){
            event.preventDefault();
            if($scope.selectedActIndex-1 !== -1){
                $scope.selectedActIndex--;
            }
        }
        else if(event.keyCode === 13){
            $scope.selectAct($scope.selectedActIndex);
        }
    };
    
    // Mood
    $scope.moods = [
        {"name":"Happy","img":"img"},
        {"name":"Normal","img":"img"},
        {"name":"Sad","img":"img"}
    ];
    $scope.moodSelected = 1;
    $scope.selectMood = function(index){
        $scope.moodSelected = index;    
    };
    
    // Item
    /*$scope.listItem = [];
    $scope.listItemSelected = [
        {
            "name": "item 1",
            "img": "",
            "img_thumb": ""
        },
        {
            "name": "item 2",
            "img": "",
            "img_thumb": ""
        },
        {
            "name": "item 3",
            "img": "",
            "img_thumb": ""
        },
        {
            "name": "item 4",
            "img": "",
            "img_thumb": ""
        }
    ];
    $scope.selectedItemIndex = -1;
    $scope.searchItem = function(){
        $scope.selectedItemIndex = -1;
        $http.get('../../source/json/item.json').success(function(data){
            $scope.listItem = data;
        });
    };
    $scope.checkKeyDownItem = function(event){
        if(event.keyCode === 40){
            event.preventDefault();
            if($scope.selectedItemIndex+1 !== $scope.listItem.length){
                $scope.selectedItemIndex++;
            }
        }
        else if(event.keyCode === 38){
            event.preventDefault();
            if($scope.selectedItemIndex-1 !== -1){
                $scope.selectedItemIndex--;
            }
        }
        else if(event.keyCode === 13){
            $scope.selectItem($scope.listItem[$scope.selectedItemIndex]);
        }
    };
    $scope.selectItem = function(item){
        $scope.itemKey=null;
        var lastItem = $scope.lastItemIndex();
        var inList = $scope.inListItemSelected(item);
        if(!inList){
            if(lastItem != 4){
                $scope.listItemSelected[lastItem] = item;
                $scope.itemKey = '';
            } else {
                alert('sudah penuh om');
            }
        } else {
            var ind = 0;
            for(var i = 0; i < $scope.listItemSelected.length; i++){
                if($scope.listItemSelected[i].name === item.name){
                    ind = i;
                }
            }
            $scope.listItemSelected[ind] = {
                "name": "item "+(ind+1),
                "img": "",
                "img_thumb": ""
            };
        }
    };
    $scope.lastItemIndex = function(){
        for(var i = 0; i < $scope.listItemSelected.length; i++){
            if($scope.listItemSelected[i].img === ''){
                return i;
            }
        }
        return 4;
    };
    $scope.inListItemSelected = function(item){
        for(var i = 0; i < $scope.listItemSelected.length; i++){
            if($scope.listItemSelected[i].name === item.name){
                return true;
            }
        }
        return false;
    };
    $scope.resetListItem = function(){
        $scope.listItemSelected = [
            {
                "name": "item 1",
                "img": "",
                "img_thumb": ""
            },
            {
                "name": "item 2",
                "img": "",
                "img_thumb": ""
            },
            {
                "name": "item 3",
                "img": "",
                "img_thumb": ""
            },
            {
                "name": "item 4",
                "img": "",
                "img_thumb": ""
            }
        ];  
    };*/
    $scope.listItem = [];
    $scope.itemSelected = {
        "name": "item 1",
        "type": "",
        "img": "",
        "img_thumb": ""
    };
    $scope.itemSelected2 = {
        "name": "item 2",
        "type": "",
        "img": "",
        "img_thumb": ""
    };
    $scope.itemSelected3 = {
        "name": "item 3",
        "type": "",
        "img": "",
        "img_thumb": ""
    };
    $scope.itemSelected4 = {
        "name": "item 4",
        "type": "",
        "img": "",
        "img_thumb": ""
    };
    $scope.selectedItemIndex = -1;
    $scope.searchItem = function(){
        $scope.selectedItemIndex = -1;
        $http.get('../assets/json/item.json').success(function(data){
            $scope.listItem = data;
        });
    };
    $scope.checkKeyDownItem = function(event){
        if(event.keyCode === 40){
            event.preventDefault();
            if($scope.selectedItemIndex+1 !== $scope.listItem.length){
                $scope.selectedItemIndex++;
            }
        }
        else if(event.keyCode === 38){
            event.preventDefault();
            if($scope.selectedItemIndex-1 !== -1){
                $scope.selectedItemIndex--;
            }
        }
        else if(event.keyCode === 13){
            $scope.selectItem($scope.listItem[$scope.selectedItemIndex]);
        }
    };
    $scope.selectItem = function(item){
        $scope.itemSelected = item;
        $scope.itemKey = '';
    };
    $scope.selectItem2 = function(item){
        $scope.itemSelected2 = item;
        $scope.itemKey2 = '';
    };
    $scope.selectItem3 = function(item){
        $scope.itemSelected3 = item;
        $scope.itemKey3 = '';
    };
    $scope.selectItem4 = function(item){
        $scope.itemSelected4 = item;
        $scope.itemKey4 = '';
    };
    
    // Friend
    $scope.listFriend = [];
    $scope.listFriendSelected = [];
    $scope.selectedFriendIndex = -1;
    $scope.searchFriend = function(){
        $scope.selectedFriendIndex = -1;
        $http.get('../assets/json/friend.json').success(function(data){
            $scope.listFriend = data;
        });
    };
    $scope.checkKeyDownFriend = function(event){
        if(event.keyCode === 40){
            event.preventDefault();
            if($scope.selectedFriendIndex+1 !== $scope.listFriend.length){
                $scope.selectedFriendIndex++;
            }
        }
        else if(event.keyCode === 38){
            event.preventDefault();
            if($scope.selectedFriendIndex-1 !== -1){
                $scope.selectedFriendIndex--;
            }
        }
        else if(event.keyCode === 13){
            $scope.selectFriend($scope.listFriend[$scope.selectedFriendIndex]);
        }
    };
    $scope.selectFriend = function(friend){
        if(!$scope.inListFriendSelected(friend)){
            $scope.listFriendSelected.push(friend);
            $scope.friendKey = '';
        } else {
            var ind = $scope.listFriendSelected.indexOf(friend);
            $scope.listFriendSelected.splice(ind, 1);
        }
    };
    $scope.inListFriendSelected = function(friend){
        for(var i = 0; i < $scope.listFriendSelected.length; i++){
            if($scope.listFriendSelected[i].name === friend.name){
                return true;
            }
        }
        return false;
    };
    $scope.resetFriend = function(){
        $scope.listFriendSelected = [];
    };
    
    // Place
    $scope.listPlace = [];
    $scope.placeSelected = {
        "name": "place",
        "type": "",
        "img": "",
        "img_thumb": ""
    };
    $scope.selectedPlaceIndex = -1;
    $scope.searchPlace = function(){
        $scope.selectedPlaceIndex = -1;
        $http.get('../assets/json/place.json').success(function(data){
            $scope.listPlace = data;
        });
    };
    $scope.checkKeyDownPlace = function(event){
        if(event.keyCode === 40){
            event.preventDefault();
            if($scope.selectedPlaceIndex+1 !== $scope.listPlace.length){
                $scope.selectedPlaceIndex++;
            }
        }
        else if(event.keyCode === 38){
            event.preventDefault();
            if($scope.selectedPlaceIndex-1 !== -1){
                $scope.selectedPlaceIndex--;
            }
        }
        else if(event.keyCode === 13){
            $scope.selectPlace($scope.listPlace[$scope.selectedPlaceIndex]);
        }
    };
    $scope.selectPlace = function(place){
        $scope.placeSelected = place;  
        $scope.placeKey = '';
    };
    
    // Tab Posting Activity
    $scope.editActivity = 'captions';
    $scope.selectEdit = function(e){
        $scope.editActivity = e;
    }
    
    // Reset Post
    $scope.resetPost = function(){
        // Reset Activity
        $scope.actKey = '';    
        $scope.selectedIndex = -1;
        $scope.listAct = [];
        $scope.selectedAct = null;
        
        // Reset Mood
        $scope.moodSelected = 1;
        
        // Reset List Item
        $scope.resetListItem();

        // Reset List Friend
        $scope.resetFriend();
        
        // Reset Place
        $scope.placeSelected = {
            "name": "place",
            "type": "",
            "img": "",
            "img_thumb": ""
        };
        
        // Reset Caption
        $scope.previewCaption = '';
        
        // Reset Edit Activity
        $scope.editActivity = 'captions';
    };
}]).filter('firstName', function () {
    return function (str) {
        var name = str.split(" ");
        return name[0];
    }
}).filter('matchedBold', ['$sce', function ($sce) {
    return function (str, model) {
        var result = '';
        var name = str.split(' ');
        for(var i = 0; i < name.length; i++){
            if(angular.lowercase(name[i]) === angular.lowercase(model)){
                result += '<strong>'+name[i]+'</strong> ';
            } else {
                result += name[i]+' ';
            }
        }
        return $sce.trustAsHtml(result);
    }
}]);
})();;
(function() {
'use strict';

	angular
		.module('app')
		.controller('CreateAvatarController', CreateAvatarController);

	CreateAvatarController.$inject = ['CiayoService','$state','$cookieStore','modalFactory','TourService'];
	function CreateAvatarController(CiayoService,$state,$cookieStore,modalFactory,TourService) {
		var vm = this;
		
		vm.step = '';
		vm.saveName = saveName;
		vm.checkName = checkName;
		vm.saveDOB = saveDOB;
		vm.saveGender = saveGender;
		vm.saveAvatar = saveAvatar;
		vm.skipAvatar = skipAvatar;
		vm.init = [];
		vm.elementSelected = [];
		vm.defaultAvatar = [];
		vm.imgBack = '';
		vm.dobTimestamp = '';
		vm.dataMascot = [];

		vm.idItemSelected = 9;
		vm.itemSelected = [];
		vm.elementIdSelected = 0;
		
		vm.changePart = changePart;
		vm.selectElementVariation=selectElementVariation;

		vm.arrow_next = arrow_next;
		vm.arrow_prev = arrow_prev;

		vm.variantSelected = '';
		vm.colorSelected = '';

		vm.bgAvaColor = "#fff"
		vm.bgElement = {
			required: true,
			element_id: '0',
			element_name: 'Background',
			element_type: [
				{
					element_type_id: '00',
					element_type_name: 'Background Color',
					element_variation: [
						"#FCB64E",
						"#FFE081",
						"#BCDFBF",
						"#AEDCF6",
						"#A5CBEC",
						"#C5C9E6",
						"#F8C2D3",
						"#D8DFE2"
					]
				}
			]
		};
		
		vm.defaultElementColor = {};

		function changePart(item, id) {
			$(".display_loading").show();
			if(vm.idItemSelected == 10){
				vm.imgBack = item.assets[vm.defaultElementColor['element_'+id]].asset_image_back;
			}
			var img = item.assets[vm.defaultElementColor['element_'+id]].asset_image_url;
			vm.itemSelected = item.assets;
			var temp_img = new Image();
			var elem = angular.element('#part_'+id);
			vm.variantSelected = item.variant_id;

			elem.attr('element-id', vm.elementIdSelected);
			elem.attr('variant-id', item.variant_id);
			elem.attr('filter-value', item.assets[vm.defaultElementColor['element_'+id]].asset_id);
			temp_img.onload = function(){
				elem.css('background-image', 'url('+img+')');
				$(".display_loading").delay(500).fadeOut(0);
			}
			temp_img.src=img;

			if(vm.idItemSelected == 9){
				changeFacialHair();
			}

			var skin_color = vm.elementSelected.skin_color;
			if(skin_color){
				changeAllSkin(item.assets[vm.defaultElementColor['element_'+id]].asset_color_id);
			}
			
			
		}

	
		
		vm.changePartColor = changePartColor;
		function changePartColor(id, ind) {
			vm.defaultElementColor['element_'+vm.idItemSelected] = ind;
			$(".display_loading").show();
			var elem = angular.element('#part_'+vm.idItemSelected);
			var url = '';
			var filter_value = '';
			var element_id = elem.attr('element-id');
			var variant_id = elem.attr('variant-id');
			var element_type = vm.elementSelected.element_type;
			var skin_color = vm.elementSelected.skin_color;
			vm.colorSelected = id;
			for(var i = 0; i < element_type.length; i++){
				if(element_id == element_type[i].element_type_id){
					for(var j = 0; j < element_type[i].element_variation.length; j++){
						if(variant_id == element_type[i].element_variation[j].variant_id){
							for(var k = 0; k < element_type[i].element_variation[j].assets.length; k++){
								if(id == element_type[i].element_variation[j].assets[k].asset_color_id){
									if(vm.idItemSelected == 10){
										vm.imgBack = element_type[i].element_variation[j].assets[k].asset_image_back;
									}
									url = element_type[i].element_variation[j].assets[k].asset_image_url;
									filter_value = element_type[i].element_variation[j].assets[k].asset_id;
								}
							}
						}
					}
				}
			}

			if(skin_color){
				changeAllSkin(id);
			}

			var temp_img = new Image();
			//vm.image_loading='show';

			elem.attr('filter-value', filter_value);
			temp_img.onload = function(){
			
				elem.css('background-image', 'url('+url+')');
				$(".display_loading").delay(500).fadeOut(0);

				//vm.image_loading='hide';

			}
			//temp_img.onerror=function(){
			//	vm.image_loading='hide';
			//	modalFactory.message('Load Gambar error');
			//}
			temp_img.src=url;
		}

		function changeAllSkin(id) {
			// change body
			var elem = angular.element('#part_16');
			var assets = vm.init[0].element_type[0].element_variation[0].assets;
			var url = '';
			var filter_value = '';
			for(var i = 0; i < assets.length; i++){
				if(assets[i].asset_color_id == id){
					url = assets[i].asset_image_url;
					filter_value = assets[i].asset_id;
				}
			}
			elem.css('background-image', 'url('+url+')');
			elem.attr('filter-value', filter_value);

			// change face
			var elem = angular.element('#part_9');
			for(var i = 0; i < vm.init.length; i++){
				if(elem.attr('filter-id') == vm.init[i].element_id){
					var element_type = vm.init[i].element_type;
				}
			}
			var url = '';
			var filter_value = elem.attr('filter-value');
			var element_id = elem.attr('element-id');
			var variant_id = elem.attr('variant-id');
			if(filter_value != id) {
				for(var i = 0; i < element_type.length; i++){
					if(element_id == element_type[i].element_type_id){
						var variant = element_type[i].element_variation;
						for(var j = 0; j < variant.length; j++){
							if(variant_id == variant[j].variant_id){
								var assets = variant[j].assets;
								for(var k = 0; k < assets.length; k++){
									if(id == assets[k].asset_color_id){
										url = assets[k].asset_image_url;
										filter_value = assets[k].asset_id;
									}
								}
							}
						}
					}
				}
				elem.css('background-image', 'url('+url+')');
				elem.attr('filter-value', filter_value);
			}
			
			// change nose
			var elem = angular.element('#part_13');
			for(var i = 0; i < vm.init.length; i++){
				if(elem.attr('filter-id') == vm.init[i].element_id){
					var element_type = vm.init[i].element_type;
				}
			}
			var url = '';
			var filter_value = elem.attr('filter-value');
			var element_id = elem.attr('element-id');
			var variant_id = elem.attr('variant-id');
			if(filter_value != id) {
				for(var i = 0; i < element_type.length; i++){
					if(element_id == element_type[i].element_type_id){
						var variant = element_type[i].element_variation;
						for(var j = 0; j < variant.length; j++){
							if(variant_id == variant[j].variant_id){
								var assets = variant[j].assets;
								for(var k = 0; k < assets.length; k++){
									if(id == assets[k].asset_color_id){
										url = assets[k].asset_image_url;
										filter_value = assets[k].asset_id;
									}
								}
							}
						}
					}
				}
				elem.css('background-image', 'url('+url+')');
				elem.attr('filter-value', filter_value);
			}
		}

		vm.backgroundSelected = '#AEDCF6';
		vm.changeBackground = changeBackground;
		function changeBackground(color){
			vm.variantSelected = color;
			vm.backgroundSelected = color;
			$('._viewport').css('background',color);
		}
		
		vm.removePart = removePart;
		function removePart(id) {
			var elem = angular.element('#part_'+id);
			elem.css('background-image', 'url()');
			elem.attr('filter-value', '');
			elem.attr('variant-id', '');
			if(id == 10){
				vm.imgBack = '';
			}
			
			vm.variantSelected = id;
		}

		function checkName(){console.log(vm.nickname);
			if(vm.nickname==undefined || vm.nickname==''){
				modalFactory.message('Isi nama terlebih dahulu');
			}
		}
		function saveName() {
			if(!vm.nickname){
				vm.errMsg = 'Please fill your nickname';
				vm.isModal = true;
				
			} else {
				var c = {
					data: {
						screen_name: vm.nickname
					}
				};
				$(".display_loading_avatar").show();
				CiayoService.Api('users/screen/name', c, function(response) {
					$(".display_loading_avatar").fadeOut(250);
					var response = response.data.c;
					var data = response.data;
					if(!data.error){
						//vm.elementSelected = data.content.data[0];
						vm.step = 'dob-wizard';
					} else {
						vm.errMsg = 'error gan !';
						vm.isModal = true;
					}
				});
			}
		}

		function saveDOB(){
			var dd = vm.dob.split('/');
			dd = dd[1]+'/'+dd[0]+'/'+dd[2];
			var dateyDate = new Date(dd);
			var ms = dateyDate.valueOf();
			var s = ms / 1000;
			vm.dobTimestamp = s;
			var c = {
				data: {
					user_gender: vm.gender
				}
			};
			$(".display_loading_avatar").show();
			console.log(vm.init.length);
			if(vm.init.length == 0){
				CiayoService.Api(AVATAR_API_SERVER+'avatar/init', c, function(response){
					$(".display_loading_avatar").delay(2000).fadeOut();
					var response = response.data.c;
					var data = response.data;
					if(!data.error){
						vm.step = 'avatar-wizard';
						vm.init = data.content.data;
						vm.constraints = response.data.content.constraints;
						loadDefaultAvatar();
					} else {
						vm.errMsg = 'gangguan bro';
						vm.isModal = true;
					}
				},true);
			} else {
				vm.step = 'avatar-wizard';
					$(".display_loading_avatar").hide();
			}
		}
		
		function saveGender() {
			if(!vm.gender){
				vm.errMsg = 'Please select gender';
				vm.isModal = true;
			} else {
				vm.errMsg = 'Please Wait';
				vm.isModal = false;
				var c = {
					data: {
						filter_value: vm.gender
					}
				};
				$(".display_loading_avatar").show();
				$cookieStore.put('gender', vm.gender);CiayoService.Api('users/filter/saveGender', c, function(response) {
					$(".display_loading_avatar").fadeOut(250);
					var response = response.data.c;
					var data = response.data;
					if(!data.error){
						//vm.elementSelected = data.content.data[0];
						vm.step = 'name-wizard';
					} else {
						vm.errMsg = 'error gan !';
						vm.isModal = true;
					}
				});
			}
		}
		
		function loadDefaultAvatar() {
			var c = {
				data: {
					user_gender: vm.gender
				}
			};
			
			CiayoService.Api(AVATAR_API_SERVER+'avatar/defaultAvatars', c, function(response){
				var response = response.data.c;
				var data = response.data;
				if(!data.error){
					vm.isModal = false;
					vm.defaultAvatar = data.content.data;
					vm.imgBack = '';
					for(var i = 0; i < vm.defaultAvatar.length; i++){
						if(vm.defaultAvatar[i].image_back != ''){
							vm.imgBack = vm.defaultAvatar[i].image_back;
						}

						vm.defaultElementColor["element_"+vm.defaultAvatar[i].filter_id] = getIndexColor(vm.defaultAvatar[i].filter_id, vm.defaultAvatar[i].color_id);
						if(vm.defaultAvatar[i].filter_id == "10"){
							vm.defaultElementColor["element_15"] = 0;
						}
					}

					vm.switchTab(vm.init[1]);
					TourService.tourCreateAvatar();
				} else {
					modalFactory.message('Error');
				}
			},true);
		}

		function getIndexColor(element, color) {
			var idn = 0;
			for(var i = 0; i < vm.init.length; i++){
				if(vm.init[i].element_id == element){
					for(var j = 0; j < vm.init[i].color_variant.length; j++){
						if(vm.init[i].color_variant[j].color_id == color){
							idn = j;
						}
					}
				}
			}

			return idn;
		}
		
		function saveAvatar() {
			var c = {
				data: {
					color_code: vm.backgroundSelected
				}
			};
			CiayoService.Api(AVATAR_API_SERVER+'users/background', c, function(response){
				//console.log(response);
			},true);
			var c = {
				data: {
					updated_filter: [
						{
							filter_id: 6,
							filter_value: vm.dobTimestamp
						},
						{
							filter_id: 16,
							filter_value: getFilterValue('16')
						},
						{
							filter_id: 9,
							filter_value: getFilterValue('9')
						},
						{
							filter_id: 14,
							filter_value: getFilterValue('14')
						},
						{
							filter_id: 15,
							filter_value: getFilterValue('15')
						},
						{
							filter_id: 11,
							filter_value: getFilterValue('11')
						},
						{
							filter_id: 12,
							filter_value: getFilterValue('12')
						},
						{
							filter_id: 13,
							filter_value: getFilterValue('13')
						},
						{
							filter_id: 10,
							filter_value: getFilterValue('10')
						},
						{
							filter_id: 23,
							filter_value: getFilterValue('23')
						}
					],
					type: 3
				}
			}
			$(".display_loading_avatar").show();
			CiayoService.Api(AVATAR_API_SERVER+'users/filter/update', c, function(response){
				var response = response.data.c;
				console.log(response);
				if(!response.data.error){
					$cookieStore.put('profile',true);
					$(".display_loading_avatar").fadeIn(250);
					$state.transitionTo('timeline');
				} else {
					modalFactory.message('something error bro, sorry :(');
				}
			},true);
		}
		
		vm.getFilterValue = getFilterValue;
		function getFilterValue(id) {
			var elem = angular.element('#part_'+id);
			var val = elem.attr('filter-value');
			return val;
		}
		
		function skipAvatar() {
			vm.step = 'mascot-wizard';
			var c = {
				data: ''
			};
			if(!vm.dataMascot.length){
				CiayoService.Api('mascot', c, function(response){
					if(response.status == 200){
						var data = response.data.c.data.content.data;
						vm.dataMascot = data;
					} else {
						modalFactory.message('error bro');
					}
				});
			}
		}
		
		vm.switchTab = switchTab;
		
		function switchTab(tab) {
			vm.elementSelected = tab;
			vm.idItemSelected = tab.element_id;
			if(vm.idItemSelected == 0){
				selectElementVariation(tab.element_type[0]);
			} else if(vm.idItemSelected == 15) {
				selectElementVariation(tab.element_type[0]);
			} else if(vm.idItemSelected == 23) {
				selectElementVariation(tab.element_type[2]);
			} else {
				for(var i = 0; i < vm.defaultAvatar.length; i++){
					if(vm.defaultAvatar[i].filter_id == tab.element_id){
						for(var j = 0; j < tab.element_type.length; j++){
							var element_id = vm.getElementId()?vm.getElementId():vm.defaultAvatar[i].element_type_id;
							if(element_id == tab.element_type[j].element_type_id){
								selectElementVariation(tab.element_type[j]);
							}
						}
					}
				}
			}
		}

		vm.getElementId = getElementId;
		function getElementId() {
			var elem = angular.element('#part_'+vm.idItemSelected);
			var val = elem.attr('element-id');
			return val;
		}

		vm.getVariantId = getVariantId;
		function getVariantId() {
			var elem = angular.element('#part_'+vm.idItemSelected);
			var val = elem.attr('variant-id');
			return val;
		}


		function selectElementVariation(tab, change){
			vm.elementIdSelected = tab.element_type_id;
			vm.element_variation = tab.element_variation;
			if(change){
				vm.changePart(vm.element_variation[0], vm.idItemSelected);
			}
		}

		vm.inConstraints = inConstraints;
		function inConstraints(id) {
			if(vm.idItemSelected == 15){
				var elem = angular.element('#part_9');
				var variant_id = elem.attr('variant-id');
				var cur_constraint = vm.constraints[parseInt(variant_id)];
				return cur_constraint.hasOwnProperty(id);
			}
		}

		function changeFacialHair() {
			var elem = angular.element('#part_9');
			var face = elem.attr('variant-id');
			var elem = angular.element('#part_15');
			var fh = elem.attr('variant-id');
			var efh = elem.attr('element-id');
			var cur_constraint = vm.constraints[parseInt(face)];
			if(cur_constraint.hasOwnProperty(parseInt(fh))){
				var val = cur_constraint[fh];
				if(val){
					for(var i = 0; i < vm.init.length; i++){
						if(vm.init[i].element_id == "15"){
							var element = vm.init[i].element_type;
							for(var j = 0; j < element.length; j++){
								if(efh == element[j].element_type_id){
									var variant = element[j].element_variation;
									for(var k = 0; k < variant.length; k++){
										if(variant[k].variant_id == val){
											changePart(variant[k], '15');
										}
									}
								}
							}
						}
					}
				} else {
					vm.removePart(15);
				}
			}
		}

		function arrow_next(){
			$(".frame").animate({scrollLeft: "+="+100});
		}

		function arrow_prev(){
			$(".frame").animate({scrollLeft: "-="+100});
		}

		// select mascot
		vm.saveMascot = saveMascot;
		function saveMascot() {
			if(vm.mascot != undefined){
				var c = {
					data: {
						updated_filter: [{
							filter_id: 6,
							filter_value: vm.dobTimestamp
						}]
					}
				};
				CiayoService.Api(AVATAR_API_SERVER+'users/filter/update', c, function(response){
					if(response.status == 200){
						var c = {
							data: {
								media_id_mascot: vm.mascot
							}
						};
						CiayoService.Api('users/mascot', c, function(response){
							if(response.status == 200){
								modalFactory.message(response.data.c.data.message);
								$cookieStore.put('profile',true);
								$state.transitionTo('timeline');
							} else {
								modalFactory.message('error bro');
							}
						});
					} else {
						alert('error');
					}
				}, true);
			} else {
				modalFactory.message('pilih dulu mascot nya');
			}
		}

		
	}
})();;
(function () {
	'use strict';
	angular
		.module('app')
		.controller('DetailPageController', DetailPageController);

	DetailPageController.$inject = ['AuthService', 'CiayoService', 'PostService', 'ItemService', '$cookieStore', '$rootScope', '$stateParams','modalFactory','ProfileService'];

	function DetailPageController(AuthService, CiayoService, PostService, ItemService, $cookieStore, $rootScope, $stateParams,modalFactory,ProfileService) {
		var me = this;
		me.comment = {};
		me.js_timeline = null;
		me.activity_detail = [];
		me.token = $cookieStore.get('token');
		function loadData() {
			if (me.token) {
			ProfileService.userInfo('',function($filter){
				me.login_id = ProfileService.userData.user_id;
				PostService.detail($stateParams.post_id, parseDetail, function (response) {});
			},function(){

			});
				
			
			}else{
				PostService.public_detail($stateParams.post_id, parseDetail, function (response) {
					
				});
			}
			
		}

		function parseDetail(response) {
			var data = response.data.c.data;
			if(data.error==false){
				
				me.js_timeline = response.data.c.data.content;
				me.js_timeline.isPublic = me.token==undefined?true:undefined;
				me.js_timeline.login_id = me.login_id;
				me.js_timeline.activity_detail.avatar_url = (me.js_timeline.user_avatar) ? me.js_timeline.user_avatar.face : '';
				me.js_timeline.activity_detail.activity_title = (me.js_timeline.activity_detail.activity_title == undefined ? '' : me.js_timeline.activity_detail.activity_title)
					.replace(
						'[USERNAME]',
						'<span class="name">' +
						me.js_timeline.user_display_name +
						'</span>'
					)
					.replace(
						'[MOOD_TEXT]',
						me.js_timeline.activity_detail.mood == undefined ? '' :
						'<span class="mood">' +
						me.js_timeline.activity_detail.mood.text + ' ' +
						(me.js_timeline.activity_detail.mood.id == 2 ? '<i class="ci-mood-happy"></i>' :
							me.js_timeline.activity_detail.mood.id == 3 ? '<i class="ci-mood-sad"></i>' : '') +
						'</span>'
					);
				me.js_timeline.view = 'detail';
			}else{
				modalFactory.message(data.message);
			}
		}

		loadData();


	}
})();;
(function() {
'use strict';

	angular
		.module('app')
		.controller('DownloadAvatar', DownloadAvatar);

	DownloadAvatar.$inject = ['CiayoService','$state','$http','AuthService','AvatarService','$cookieStore'];
	function DownloadAvatar(CiayoService, $state, $http,AuthService,AvatarService,$cookieStore) {
		var vm = this;
		vm.getAvatar = getAvatar;
		vm.imgAva = '';
		vm.imgColor = '';
		
		function getAvatar(){
			var c = {
				data: {
					avatar_type: 'avatar_3'
				}
			};
			vm.loadAva = false;
			CiayoService.Api(AVATAR_API_SERVER+'users/download/avatar', c, function(response){
				if(response.status == 200){
					vm.loadAva = true;
					var data = response.data.c.data;
					
					vm.imgAva = data.content.url;
					var token = $cookieStore.get('token');
					var avaData = '{"data":{"token":"'+token+'"},"timestamp":1468376374025,"app":"Web","screen_type":"Web","image_type":"","latitude":"-6.225652","longitude":"106.74576","language":1}';
					$('#avaData').val(avaData);
					$('#form').attr('action', AVATAR_API_SERVER+'users/avatar');
				} else {
					alert('error bro, cannot get avatar');
				}
			},true);
			// AvatarService.getDownloadAvatar(function(data){
			// 	$(document).append(data);
			// });
		}
		
		vm.getAvatar();
		vm.downloadAvatar = downloadAvatar;
		
		function downloadAvatar(){
			var img = vm.imgAva;
			$http.get(img, {responseType: "arraybuffer"}).success(function(data){

			var arrayBufferView = new Uint8Array( data );
			var blob = new Blob( [ arrayBufferView ], { type: "image/png" } );
			var urlCreator = window.URL || window.webkitURL;
			var imageUrl = urlCreator.createObjectURL( blob );
			
			saveImg(imageUrl,'avatar.png');
	
			}).error(function(err, status){});
		}
				
		function saveImg(fileURL, fileName){
			// for non-IE
			if (!window.ActiveXObject) {
					var save = document.createElement('a');
					save.href = fileURL;
					save.target = '_blank';
					save.download = fileName || 'unknown';

					var event = document.createEvent('Event');
					event.initEvent('click', true, true);
					save.dispatchEvent(event);
					(window.URL || window.webkitURL).revokeObjectURL(save.href);
			}

			// for IE
			else if ( !! window.ActiveXObject && document.execCommand)		 {
					var _window = window.open(fileURL, '_blank');
					_window.document.close();
					_window.document.execCommand('SaveAs', true, fileName || fileURL)
					_window.close();
			}
		}
		
		vm.next = next;
		
		function next() {
			AuthService.finishProfile();
			$state.transitionTo('timeline');
			
		}
	}
})();;
(function() {
'use strict';

	angular
		.module('app')
		.controller('EditAvatarController', EditAvatarController);

	EditAvatarController.$inject = ['CiayoService', '$state', '$cookieStore', 'ProfileService','$http'];
	function EditAvatarController(CiayoService, $state, $cookieStore, ProfileService, $http) {
		var vm = this;

		vm.getAvatar = getAvatar;
		vm.saveAvatar = saveAvatar;
		
		vm.init = [];
		vm.elementSelected = [];
		vm.defaultAvatar = [];
		vm.imgBack = '';
		
		vm.idItemSelected = 9;
		vm.itemSelected = [];
		vm.elementIdSelected = 0;
		
		vm.changePart = changePart;
		vm.selectElementVariation=selectElementVariation;

		vm.arrow_next = arrow_next;
		vm.arrow_prev = arrow_prev;

		vm.cancelAvatar = cancelAvatar;

		vm.variantSelected = '';
		vm.colorSelected = '';

		vm.bgAvaColor = "#fff"
		vm.bgElement = {
			required: true,
			element_id: '0',
			element_name: 'Background',
			element_type: [
				{
					element_type_id: '00',
					element_type_name: 'Background Color',
					element_variation: [
						"#FCB64E",
						"#FFE081",
						"#BCDFBF",
						"#AEDCF6",
						"#A5CBEC",
						"#C5C9E6",
						"#F8C2D3",
						"#D8DFE2"
					]
				}
			]
		};
		
		vm.defaultElementColor = {};

		function changePart(item, id) {
			$(".display_loading").show();
			if(vm.idItemSelected == 10){
				vm.imgBack = item.assets[vm.defaultElementColor['element_'+id]].asset_image_back;
			}
			var img = item.assets[vm.defaultElementColor['element_'+id]].asset_image_url;
			vm.itemSelected = item.assets;
			var temp_img = new Image();
			var elem = angular.element('#part_'+id);
			vm.variantSelected = item.variant_id;

			elem.attr('element-id', vm.elementIdSelected);
			elem.attr('variant-id', item.variant_id);
			temp_img.onload = function(){
				elem.css('background-image', 'url('+img+')');
				$(".display_loading").delay(500).fadeOut(0);
			}
			temp_img.src=img;
			elem.attr('filter-value', item.assets[vm.defaultElementColor['element_'+id]].asset_id);

			if(vm.idItemSelected == 9){
				changeFacialHair();
			}

			var skin_color = vm.elementSelected.skin_color;
			if(skin_color){
				changeAllSkin(item.assets[vm.defaultElementColor['element_'+id]].asset_color_id);
			}
			
		}

		vm.changePartColor = changePartColor;
		function changePartColor(id, ind) {
			vm.defaultElementColor['element_'+vm.idItemSelected] = ind;
			if(vm.idItemSelected == '9' || vm.idItemSelected == '13'){
				vm.defaultElementColor['element_9'] = ind;
				vm.defaultElementColor['element_13'] = ind;
			}
			$(".display_loading").show();
			var elem = angular.element('#part_'+vm.idItemSelected);
			var url = '';
			var filter_value = '';
			var element_id = elem.attr('element-id');
			var variant_id = elem.attr('variant-id');
			var element_type = vm.elementSelected.element_type;
			var skin_color = vm.elementSelected.skin_color;
			vm.colorSelected = id;
			for(var i = 0; i < element_type.length; i++){
				if(element_id == element_type[i].element_type_id){
					for(var j = 0; j < element_type[i].element_variation.length; j++){
						if(variant_id == element_type[i].element_variation[j].variant_id){
							for(var k = 0; k < element_type[i].element_variation[j].assets.length; k++){
								if(id == element_type[i].element_variation[j].assets[k].asset_color_id){
									if(vm.idItemSelected == 10){
										vm.imgBack = element_type[i].element_variation[j].assets[k].asset_image_back;
									}
									url = element_type[i].element_variation[j].assets[k].asset_image_url;
									filter_value = element_type[i].element_variation[j].assets[k].asset_id;
								}
							}
						}
					}
				}
			}

			if(skin_color){
				changeAllSkin(id);
			}

			var temp_img = new Image();
			//vm.image_loading='show';

			elem.attr('filter-value', filter_value);
			temp_img.onload = function(){
			
				elem.css('background-image', 'url('+url+')');
				$(".display_loading").delay(500).fadeOut(0);

				//vm.image_loading='hide';

			}
			//temp_img.onerror=function(){
			//	vm.image_loading='hide';
			//	alert('Load Gambar error');
			//}
			temp_img.src=url;
		}

		function changeAllSkin(id) {
			// change body
			var elem = angular.element('#part_16');
			var assets = vm.init[0].element_type[0].element_variation[0].assets;
			var url = '';
			var filter_value = '';
			for(var i = 0; i < assets.length; i++){
				if(assets[i].asset_color_id == id){
					url = assets[i].asset_image_url;
					filter_value = assets[i].asset_id;
				}
			}
			elem.css('background-image', 'url('+url+')');
			elem.attr('filter-value', filter_value);

			// change face
			var elem = angular.element('#part_9');
			for(var i = 0; i < vm.init.length; i++){
				if(elem.attr('filter-id') == vm.init[i].element_id){
					var element_type = vm.init[i].element_type;
				}
			}
			var url = '';
			var filter_value = elem.attr('filter-value');
			var element_id = elem.attr('element-id');
			var variant_id = elem.attr('variant-id');
			for(var i = 0; i < element_type.length; i++){
				if(element_id == element_type[i].element_type_id){
					var variant = element_type[i].element_variation;
					for(var j = 0; j < variant.length; j++){
						if(variant_id == variant[j].variant_id){
							var assets = variant[j].assets;
							for(var k = 0; k < assets.length; k++){
								if(id == assets[k].asset_color_id){
									url = assets[k].asset_image_url;
									filter_value = assets[k].asset_id;
								}
							}
						}
					}
				}
			}
			elem.css('background-image', 'url('+url+')');
			elem.attr('filter-value', filter_value);
			
			// change nose
			var elem = angular.element('#part_13');
			for(var i = 0; i < vm.init.length; i++){
				if(elem.attr('filter-id') == vm.init[i].element_id){
					var element_type = vm.init[i].element_type;
				}
			}
			var url = '';
			var filter_value = elem.attr('filter-value');
			var element_id = elem.attr('element-id');
			var variant_id = elem.attr('variant-id');
			for(var i = 0; i < element_type.length; i++){
				if(element_id == element_type[i].element_type_id){
					var variant = element_type[i].element_variation;
					for(var j = 0; j < variant.length; j++){
						if(variant_id == variant[j].variant_id){
							var assets = variant[j].assets;
							for(var k = 0; k < assets.length; k++){
								if(id == assets[k].asset_color_id){
									url = assets[k].asset_image_url;
									filter_value = assets[k].asset_id;
								}
							}
						}
					}
				}
			}
			elem.css('background-image', 'url('+url+')');
			elem.attr('filter-value', filter_value);
		}

		vm.backgroundSelected = '#AEDCF6';
		vm.changeBackground = changeBackground;
		function changeBackground(color){
			vm.variantSelected = color;
			vm.backgroundSelected = color;
			$('._viewport').css('background',color);
		}

		vm.removePart = removePart;
		function removePart(id) {
			var elem = angular.element('#part_'+id);
			elem.css('background-image', 'url()');
			elem.attr('filter-value', '');
			elem.attr('variant-id', '');
			if(id == 10){
				vm.imgBack = '';
			}
			
			vm.variantSelected = id;
		}

		function getAvatar() {
			angular.element(document).ready(function(){
				setTimeout(function(){
					$(".display_loading_avatar").show();
				},1);

				var gender = $cookieStore.get('gender');

				var c = {
					data: {
						user_gender: gender
					}
				};

				CiayoService.Api(AVATAR_API_SERVER+'avatar/init', c, function(response){
					$(".display_loading_avatar").delay(1000).fadeOut();
					var response = response.data.c;
					var data = response.data;
					if(!data.error){
						vm.init = data.content.data;
						vm.constraints = response.data.content.constraints;
						loadDefaultAvatar();
						
					} else {
						vm.errMsg = 'gangguan bro';
						vm.isModal = true;
					}
				},true);
				// $http.get('assets/temp-init.json').then(function(json){
				// 	$(".display_loading_avatar").delay(1000).fadeOut();
				// 	var response = json.data.c;
				// 	if(!response.error){
				// 		vm.init = response.data.content.data;
				// 		vm.constraints = response.data.content.constraints;
				// 		loadDefaultAvatar();
				// 	} else {
				// 		vm.errMsg = 'gangguan bro';
				// 		vm.isModal = true;
				// 	}
				// },function(){});
			});
		}


		function loadDefaultAvatar() {
			var c = {
				data: {
				}
			};
			
			CiayoService.Api(AVATAR_API_SERVER+'avatar/defaultAvatars', c, function(response){
				var response = response.data.c;
				var data = response.data;
				if(!data.error){
					vm.isModal = false;
					vm.defaultAvatar = data.content.data;
					vm.img_back = '';
					for(var i = 0; i < vm.defaultAvatar.length; i++){
						if(vm.defaultAvatar[i].image_back != ''){
							vm.imgBack = vm.defaultAvatar[i].image_back;
						}
						vm.defaultElementColor["element_"+vm.defaultAvatar[i].filter_id] = getIndexColor(vm.defaultAvatar[i].filter_id, vm.defaultAvatar[i].color_id);
						if(vm.defaultAvatar[i].filter_id == "10"){
							vm.defaultElementColor["element_15"] = 0;
						}
					}

					if(data.content.color){
						vm.bgAvaColor = data.content.color;
					}

					vm.switchTab(vm.init[1]);
				} else {
					alert('Error');
				}
			},true);
		}

		function getIndexColor(element, color) {
			var idn = 0;
			for(var i = 0; i < vm.init.length; i++){
				if(vm.init[i].element_id == element){
					for(var j = 0; j < vm.init[i].color_variant.length; j++){
						if(vm.init[i].color_variant[j].color_id == color){
							idn = j;
						}
					}
				}
			}

			return idn;
		}
		
		function saveAvatar() {
			var c = {
				data: {
					color_code: vm.backgroundSelected
				}
			};
			CiayoService.Api(AVATAR_API_SERVER+'users/background', c, function(response){
				//console.log(response);
			},true);
			var c = {
				data: {
					updated_filter: [
						{
							filter_id: 1,
							filter_value: vm.gender
						},
						{
							filter_id: 16,
							filter_value: getFilterValue('16')
						},
						{
							filter_id: 9,
							filter_value: getFilterValue('9')
						},
						{
							filter_id: 14,
							filter_value: getFilterValue('14')
						},
						{
							filter_id: 15,
							filter_value: getFilterValue('15')
						},
						{
							filter_id: 11,
							filter_value: getFilterValue('11')
						},
						{
							filter_id: 12,
							filter_value: getFilterValue('12')
						},
						{
							filter_id: 13,
							filter_value: getFilterValue('13')
						},
						{
							filter_id: 10,
							filter_value: getFilterValue('10')
						},
						{
							filter_id: 23,
							filter_value: getFilterValue('23')
						}
					],
					type: 3
				}
			}
			$(".display_loading_avatar").show();
			CiayoService.Api(AVATAR_API_SERVER+'users/filter/update', c, function(response){
				var response = response.data.c;
				//console.log(response);
				if(!response.data.error){
					ProfileService.userData = null;
					$(".display_loading_avatar").fadeOut(0);
					//$state.transitionTo('setting', {menu: 'edit-basic-info'});
					$state.transitionTo('profile');
				} else {
					alert('something error bro, sorry :(');
				}
			},true);
		}

		vm.getFilterValue = getFilterValue;
		function getFilterValue(id) {
			var elem = angular.element('#part_'+id);
			var val = elem.attr('filter-value');
			return val;
		}

		vm.getElementId = getElementId;
		function getElementId() {
			var elem = angular.element('#part_'+vm.idItemSelected);
			var val = elem.attr('element-id');
			return val;
		}
		
		vm.getVariantId = getVariantId;
		function getVariantId() {
			var elem = angular.element('#part_'+vm.idItemSelected);
			var val = elem.attr('variant-id');
			return val;
		}


		function selectElementVariation(tab, change){
			vm.elementIdSelected = tab.element_type_id;
			vm.element_variation = tab.element_variation;
			if(change){
				vm.changePart(vm.element_variation[0], vm.idItemSelected);
			}
		}
		
		vm.switchTab = switchTab;
		
		function switchTab(tab) {
			vm.elementSelected = tab;
			vm.idItemSelected = tab.element_id;
			if(vm.idItemSelected == 0){
				selectElementVariation(tab.element_type[0]);
			} else if(vm.idItemSelected == 15) {
				selectElementVariation(tab.element_type[0]);
			} else if(vm.idItemSelected == 23) {
				selectElementVariation(tab.element_type[2]);
			} else {
				for(var i = 0; i < vm.defaultAvatar.length; i++){
					if(vm.defaultAvatar[i].filter_id == tab.element_id){
						for(var j = 0; j < tab.element_type.length; j++){
							var element_id = vm.getElementId()?vm.getElementId():vm.defaultAvatar[i].element_type_id;
							if(element_id == tab.element_type[j].element_type_id){
								selectElementVariation(tab.element_type[j]);
							}
						}
					}
				}
			}
		}

		vm.inConstraints = inConstraints;
		function inConstraints(id) {
			if(vm.idItemSelected == 15){
				var elem = angular.element('#part_9');
				var variant_id = elem.attr('variant-id');
				var cur_constraint = vm.constraints[parseInt(variant_id)];
				return cur_constraint.hasOwnProperty(id);
			}
		}

		function changeFacialHair() {
			var elem = angular.element('#part_9');
			var face = elem.attr('variant-id');
			var elem = angular.element('#part_15');
			var fh = elem.attr('variant-id');
			var efh = elem.attr('element-id');
			var cur_constraint = vm.constraints[parseInt(face)];
			if(cur_constraint.hasOwnProperty(parseInt(fh))){
				var val = cur_constraint[fh];
				if(val){
					for(var i = 0; i < vm.init.length; i++){
						if(vm.init[i].element_id == "15"){
							var element = vm.init[i].element_type;
							for(var j = 0; j < element.length; j++){
								if(efh == element[j].element_type_id){
									var variant = element[j].element_variation;
									for(var k = 0; k < variant.length; k++){
										if(variant[k].variant_id == val){
											changePart(variant[k], '15');
										}
									}
								}
							}
						}
					}
				} else {
					vm.removePart(15);
				}
			}
		}

		function arrow_next(){
			$(".frame").animate({scrollLeft: "+="+100});
		}

		function arrow_prev(){
			$(".frame").animate({scrollLeft: "-="+100});
		}

		function cancelAvatar(){
			window.location = './#/profile/';
		}

		vm.getAvatar();
	}
})();;
(function () {
	'use strict';
	angular
		.module('app')
		.controller('FriendConnectionController', FriendConnectionController)
	;
	
	FriendConnectionController.$inject = ['$rootScope','AuthService','CiayoService','ConnectionService','$cookieStore', '$stateParams', '$state'];
	function FriendConnectionController($rootScope,AuthService, CiayoService,ConnectionService,$cookieStore, $stateParams, $state){
		var me = this;
		angular.extend(me,{
			action_check_me:action_check_me,
			show_frame:show_frame,
			close_frame:close_frame,
			cancel_friend_request:cancel_friend_request,
			action_addfriend:action_addfriend,
			action_response:action_response,
			closeActionResponse:closeActionResponse,
			action_response_accept:action_response_accept,
			action_response_delete:action_response_delete,
			action_deletefriend:action_deletefriend,
			action_follow:action_follow,
			action_unfollow:action_unfollow
		});

		function action_check_me(username){
			//alert(username);
			$state.go('profile', {user: username});
		}

		function show_frame(user){



				$rootScope.$broadcast( "friend.search_result",'data');
				$rootScope.$broadcast( "friend.profile",'data');
				$rootScope.$broadcast( "mutual_friend.profile",'data');
				$rootScope.$broadcast( "friend.trending_people",'data');
				user.open_action = true;

			
		}
		function close_frame(user){
			user.open_action = false;
		}

		// add friend
		function action_addfriend(user){
			//alert(user_id+'_'+id);
			user.addfriend_disabled = true;

			if(user.type_page=='trending'){
				$rootScope.$broadcast( "add_friend.trending", user.user_id);
			}

			var user_id = user.user_id;

			ConnectionService.requestAddFriend(user_id, function(response){
				console.log(response);
				user.icon_addfriend = false;
				user.name_addfriend = false;
				user.ci_check = true;

				user.icon_follow = false;
				user.name_follow = false;
				user.addfriend_disabled = false;

			},function(response){
				//console.log(response);
			});
		}

		// cancel friend request
		function cancel_friend_request(user){

			user.cancel_disabled = true;

			if(user.type_page=='trending'){
				$rootScope.$broadcast( "cancel_friend.trending", user.user_id);
			}

			var user_id = user.user_id;
			ConnectionService.requestCancelFriendRequest(user_id, function(response){
				user.icon_addfriend = true;
				user.name_addfriend = true;
				user.icon_self = 0;
				user.name_self = 0;
				user.ci_star = false;
				user.icon_action_response = false;
				user.cancel_disabled = false;

			},function(response){
				console.log(response);
			});
		}

		// Action response (accept or reject)
		function action_response(user){
			
			user.icon_action_response = true;
			
		}

		// click outside action-response
		function closeActionResponse(user){
			//alert("test");
			user.icon_action_response = false;
		}

		// action accept
		function action_response_accept(user){

			if(user.type_page=='trending'){
				$rootScope.$broadcast( "accept_friend.trending", user.user_id);
			}

			var user_id = user.user_id;
						
			ConnectionService.requestConfirmFriendRequest(user_id, function(response){
				user.icon_addfriend = false;
				user.name_addfriend = false;
				user.checklist_addfriend = false;
				user.icon_follow = false;
				user.name_follow = false;
				user.icon_action_response = false;
				user.status.friend.approve=true;
				user.hide_approve = true;
				user.success_add = true;

				$rootScope.$broadcast( "user.added_friend",'data' );

			},function(response){
				//console.log(response);
			});
		}

		function action_response_delete(user){

			if(user.type_page=='trending'){
				$rootScope.$broadcast( "decline_friend.trending", user.user_id);
			}
			
			var user_id = user.user_id;
						
			ConnectionService.requestRejectFriendRequest(user_id, function(response){
				user.icon_addfriend = true;
				user.name_addfriend = true;
				user.icon_self = 0;
				user.name_self = 0;
				user.ci_star = false;
				user.icon_action_response = false;
				user.success_add = true;

				$rootScope.$broadcast( "user.added_friend",'data' );

			},function(response){
				//console.log(response);
			});
		}
		me.test=test;

		function test(){
			$rootScope.$broadcast( "user.added_friend", 'data');
		}

		// action delete friend
		function action_deletefriend(user){
			
			var user_id = user.user_id;

			ConnectionService.requestDeleteFriend(user_id, function(response){
				console.log(response);
				user.icon_addfriend = true;
				user.name_addfriend = true;
				user.icon_self = 0;
				user.name_self = 0;

			},function(response){
				//console.log(response);
			});
		}

		// action follow
		function action_follow(user){
			
			//console.log(user);
			user.follow_disabled = true;

			if(user.type_page=='timeline'){
				$rootScope.$broadcast( "status_follow.timeline", user.user_id);
			}else if(user.type_page=='trending'){
				$rootScope.$broadcast( "status_follow.trending", user.user_id);
			}

			var user_id = user.user_id;
			
			ConnectionService.requestFollow(user_id, true, function(response){
				//console.log(response);
				user.icon_follow = false;
				user.name_follow = false;
				user.follow_disabled = false;

			},function(response){
				//console.log(response);
			});
		}

		// action unfollow
		function action_unfollow(user){
			user.follow_disabled = true;

			if(user.type_page=='timeline'){
				//console.log('timeline');
				$rootScope.$broadcast( "status_unfollow.timeline", user.user_id);
			}else if(user.type_page=='trending'){
				//console.log('trending');
				$rootScope.$broadcast( "status_unfollow.trending", user.user_id);
			}
			//alert(user_id+'_'+id);
			var user_id = user.user_id;
			
			ConnectionService.requestFollow(user_id, false, function(response){
				//console.log(response);
				user.icon_follow = true;
				user.name_follow = true;
				user.follow_disabled = false;

			},function(response){
				//console.log(response);
			});
		}


		
	}
})();;
(function () {
	'use strict';
	angular
		.module('app')
		.controller('ConnectionFriendRequest', ConnectionFriendRequest);
	
	ConnectionFriendRequest.$inject = ['$rootScope', 'AuthService','CiayoService','ConnectionService','$cookieStore', '$state', '$mdDialog', '$stateParams','CiayoBanner','modalFactory', 'facebookFactory'];
	function ConnectionFriendRequest($rootScope, AuthService, CiayoService,ConnectionService,$cookieStore, $state, $mdDialog, $stateParams, CiayoBanner,modalFactory, facebookFactory) {
		var me=this;
		angular.extend(me,{
			modalInviteEmail:modalInviteEmail,
			modalInviteGmail:modalInviteGmail,
			shareFacebook:shareFacebook
		})
		CiayoBanner.getData("friend_request", function(response){
			me.banner = response.data.c.data.content.image;
			setTimeout(function(){
				$('.c-banner').children("ul").parallax({
					clipRelativeInput: false,
					originY: 0.0
				}); 
			}, 1)
		}, function(){

		})

		function shareFacebook(){

			var access_token = '';
			var uid = '';
			//alert('test');
			facebookFactory.getToken(function (data) {
				//console.log(data);
				access_token = data.accessToken;
				uid = data.uid;

				ConnectionService.shareFacebook(access_token, uid, function(response){
					//console.log(response);
					modalFactory.message('Your message has been sent');
				
				},function(response){
					//console.log(response);
				});
				
			});
			
		}
		function modalInviteEmail(){
			modalFactory.inviteEmail();
		}
		function modalInviteGmail(){
			modalFactory.inviteGmail('');

			var config = {
		      	'client_id': '788891428909-o4a2s2hht5jud5at66crv1je57f9198i.apps.googleusercontent.com',
		      	'scope': 'https://www.google.com/m8/feeds'
		    };
		    gapi.auth.authorize(config, function() {
		       	fetch(gapi.auth.getToken());
		    });

			
		}

		function fetch(token) {
		    $.ajax({
			    url: "https://www.google.com/m8/feeds/contacts/default/full?access_token=" + token.access_token + "&alt=json",
			    dataType: "jsonp",
			    success:function(data) {
			    	//factory.modal_item2 = true;   
			        //console.log(JSON.stringify(data));
			  		var data_json = data;
			        //console.log(data_json);
					var entry_data = data_json.feed.entry;

					var email_list = [];

					//factory.email_name = data_json.feed.author.name;
					
					for(var i=0; i<entry_data.length; i++){
					 	if(entry_data[i].gd$email){
					 		var email = entry_data[i].gd$email[0].address;

					 		email_list.push({address: email});
					 		
					 	}
					}	  

					modalFactory.inviteGmail(email_list);   
 

			    }
			});
		}

		angular.element(document).ready(function () {
			$('.c-fr-body > ul > li').find('a > .m').each(function(){
				console.log('test');
				var a = $(this).parent();
				var t = $(this);
				a.on('mouseover', function(){
					console.log('test');
					var pos = a.parent().parent().parent().position();
					if(pos.top > 200){
						// tootltip ke attas
						t.addClass('keatas').fadeIn(250);
					} else {
						// tooltip ke bawah
						t.fadeIn(250);
					}
				}).on('mouseleave', function(){
					t.removeClass('keatas').fadeOut(0);
				});
			});
		});
		
		function init() {
			$('a > .mt-tooltip').each(function(){
				var a = $(this).parent();
				var t = $(this);
				a.on('mouseover', function(){
					console.log('test');
					var pos = a.parent().parent().parent().position();
					if(pos.top > 200){
						// tootltip ke attas
						t.addClass('keatas').fadeIn(250);
					} else {
						// tooltip ke bawah
						t.fadeIn(250);
					}
				}).on('mouseleave', function(){
					t.removeClass('keatas').fadeOut(0);
				});
			});
			
			$('.c-fr-mutual > .c-fr-popup-body > ul > li').each(function(){
				var li = $(this).find('.c-fr-list-action.mutual > button');
				li.on('click', function(){
					li.parent().find('.c-fr-mutal-action').addClass('is-active');
				});
				
				var close = li.parent().find('.c-fr-mutal-action > button');
				close.on('click', function(){
					li.parent().find('.c-fr-mutal-action').removeClass('is-active');
				});
			});
			
			$('.mt-tooltip > ul > li > span, .close-fr').on('click', function(){
				$('.c-fr-backdrop').toggleClass('is-active');
			});
		}
		
		// //setTimeout(function(){
		// 	init();
		// }, 3000);

		me.list_friend_request=[];
		me.start_friend = false;
		me.action_accept = action_accept;
		me.action_reject = action_reject;
		me.action_delete = action_delete;
		me.action_block = action_block;
		me.view_profile = view_profile;

		me.page = $stateParams.page;

		function getList_friend_request(limit, offset){
			
			ConnectionService.listFriendRequest ( 
				limit, offset,
				function(response){//callback sucess
					//console.log(response.data.c.data.content);
					me.list_friend_request = response.data.c.data.content.data;
					me.start_friend = true;

					angular.forEach(me.list_friend_request,function(value,key){
						value.accept_status = false;
						value.reject_status = false;
						value.default_status = true;
						value.action_loading = false;

							// var new_un = me.list_friend_request[key].user_list.user_full_name;
							// var new_un = new_un.split(" ");

							// var new_full_name = '';
							// for(var i=0; i<=3; i++){
							// 	new_full_name += new_un[i]+" ";
							// }

							// new_full_name += '...';
							// value.new_full_name = new_full_name;
					});

				},
				function(response){//err callback
					console.log(response);
				}
			);
		}

		var paging = me.page * 10;
		var pagination = paging - 10;

		getList_friend_request(10, pagination);

		function action_accept(friend, index){

			friend.action_loading = true;
			var user_id = me.list_friend_request[index].list_user.user_id;
			
			ConnectionService.requestConfirmFriendRequest(user_id, function(response){
				//console.log(response);
				friend.accept_status = true;
				friend.reject_status = false;
				friend.default_status = false;
				friend.action_loading = false;

				$rootScope.$broadcast( "user.added_friend",'data' );
				
			},function(response){
				//console.log(response);
			});

		}

		function action_reject(friend, index){
			
			friend.action_loading = true;
			var user_id = me.list_friend_request[index].list_user.user_id;

			ConnectionService.requestRejectFriendRequest(user_id, function(response){
				friend.accept_status = false;
				friend.reject_status = true;
				friend.default_status = false;
				friend.action_loading = false;

				$rootScope.$broadcast( "user.added_friend",'data' );

			},function(response){
				//console.log(response);
			});

		}

		function action_block(friend, index){
			
			var user_id = me.list_friend_request[index].list_user.user_id;

			ConnectionService.requestBlockFriendRequest(user_id, function(response){
				console.log(response);
				$mdDialog.show(
					$mdDialog.alert()
					.clickOutsideToClose(true)
					.title('This account is successfully blocked')
					.ok('Done')
				);
				me.list_friend_request.splice(index, 1);
				$rootScope.$broadcast( "user.added_friend",'data' );
				
			},function(response){
				//console.log(response);
			});

		}

		function view_profile(username){
			$state.go('profile', {user: username});
		}

		function action_delete(index){
			me.list_friend_request.splice(index, 1);
		}
		
		
	}

})();;
(function() {
'use strict';

	angular
		.module('app')
		.controller('InventoryController', InventoryController);

	InventoryController.$inject = ['CiayoService','$state','$rootScope','$cookieStore'];
	function InventoryController(CiayoService,$state,$rootScope,$cookieStore) {
		var lang = $cookieStore.get('language');
		var vm = this;
		vm.init = init;
		vm.listStickerCollection = [];
		vm.listTrxHistory = [];
		vm.isSortabled = false;

		$rootScope.$on('$stateChangeStart', function(event, toState){ 
				if(toState.name == 'inventory.priority'){
					$(document).ready(function(){
						setTimeout(function(){
							$( "#sortable1, #sortable2" ).sortable({
								connectWith: ".connectedSortable"
							}).disableSelection();
								
							$('#sortable1').on('sortupdate', function(e,u){
								// update priority
								$('#sortable1 li').each(function(e){
									if(u.item.data().id == $(this).attr('data-id')){
										console.log('ahi');
										var order = parseInt($(this).prev().attr('data-order')) + 1;
										if(!order) {
											order = parseInt($(this).next().attr('data-order')) - 1;
										}
										if(!$('#sortable1 li[data-id='+u.item.data().id+']').attr('data-order')){
											$('#sortable1 li[data-id='+u.item.data().id+']').last().attr('data-order', order);
										}
										vm.setPriority(u.item.data().id, order);
									}
								});
							});
							
							$('#sortable2').on('sortreceive', function(e,u){
								// hapus priority
								setTimeout(function(){
									vm.removePriority(u.item.data().id, u.item.index());
								},500);
							});
						},500);
					});
				} else {
					loadStickerCollection();
				}
		})

		function init(){
			$(document).ready(function(){
				setTimeout(function(){
					$("[data-toggle='modal-close']").click(function(e){
						e.preventDefault();
						$('.-inventory').removeClass('-open');
					});
					$( "#sortable1, #sortable2" ).sortable({
						connectWith: ".connectedSortable"
					}).disableSelection();
					$('#sortable1').on('sortupdate', function(e,u){
					// update priority
						$('#sortable1 li').each(function(e){
							if(u.item.data().id == $(this).attr('data-id')){
								console.log('ahi');
								var order = parseInt($(this).prev().attr('data-order')) + 1;
								if(!order) {
									order = parseInt($(this).next().attr('data-order')) - 1;
								}
								if(!$('#sortable1 li[data-id='+u.item.data().id+']').attr('data-order')){
									$('#sortable1 li[data-id='+u.item.data().id+']').last().attr('data-order', order);
								}
								vm.setPriority(u.item.data().id, order);
							}
						});
					});
					
					$('#sortable2').on('sortreceive', function(e,u){
						// hapus priority
						setTimeout(function(){
							vm.removePriority(u.item.data().id, u.item.index());
						},500);
					});
				},500);
			});

			

			loadStickerCollection();
			loadBalance();
			loadTrxHistory();
		}

		function loadBalance(){
			var c = {
				data: ''
			};

			CiayoService.Api('user/coin/balance', c, function(response){
				var data = response.data.c.data.content;
				vm.cash = data.cash;
				vm.coin = data.coin;
			});
		}

		function loadStickerCollection() {
			var c = {
				data: {
					offset: '0',
					limit: '18'
				}
			};

			CiayoService.Api('user/sticker', c, function(response){
				var data = response.data.c.data.content;
				vm.listStickerCollection = data.sticker_collection;
			});
		}

		function loadTrxHistory() {
			var today = new Date();
			var date_to = vm.endDate?vm.endDate:today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
 			today.setDate(today.getDate()-7);
 			var date_from = vm.startDate?vm.startDate:today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();

			var c = {
				data: {
					date_from: date_from,
					date_to: date_to,
					offset: '0',
					limit: '18'
				}
			};

			CiayoService.Api('user/order/history', c, function(response){
				var data = response.data.c.data.content;
				vm.listTrxHistory = data.list_order_history;
				formatDate();
			});
		}

		var bulan = ['Januari','Februari','Maret','April','Mei','Juni','Juli','Agustus','September','Oktober','November','Desember'];
		var month = ['January','February','March','April','May','June','July','August','September','October','November','December'];
		function formatDate() {
			var today = new Date();
			today = today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();
			today = new Date(today);
			for(var i=0; i < vm.listTrxHistory.length; i++){
				var date = new Date(vm.listTrxHistory[i].date);
				if(lang == 1){
					var dateList = month[date.getMonth()]+" "+date.getDate()+" "+date.getFullYear();
				} else {
					var dateList = date.getDate()+" "+bulan[date.getMonth()]+" "+date.getFullYear();
				}
				var difference = today - date;
				if(difference <= 0) {
					vm.isToday = true;
				}
				vm.listTrxHistory[i].date = dateList;
			}
		}

		vm.filterHistory = filterHistory;
		function filterHistory() {
			vm.startDate = angular.element('#startDateHidden').val();

			vm.endDate = angular.element('#endDateHidden').val();
			loadTrxHistory();
		}

		vm.clearFilter = clearFilter;
		function clearFilter() {
			vm.startDate = null;
			angular.element('#startDateHidden').val('');
			angular.element('#startDate').val('');
			vm.endDate = null;
			angular.element('#endDateHidden').val('');
			angular.element('#endDate').val('');
			loadTrxHistory();
		}

		vm.viewDetail = viewDetail;
		vm.itemDetail = {};

		function viewDetail(id) {
			console.log(id);
			vm.preview = false;
			$('.-inventory').addClass('-open');
			var c = {
				data: {
					collection_id: id
				}
			};
			console.log(c);
			vm.itemDetail = {};
			CiayoService.Api('user/sticker/collection/detail', c, function(response){
				if(response.status==200){
					vm.itemDetail = response.data.c.data.content;
				} else {
					console.log('error jow');
				}
			});
		}

		vm.keyword = $state.params.keyword;
		vm.listSearchItem = [];
		vm.searchItem = searchItem;
		function searchItem(){
			$state.transitionTo('inventory.search', {'keyword':vm.keyword});
			var c = {
				data: {
					keyword: vm.keyword,
					offset: '0',
					limit: '18'
				}
			};

			CiayoService.Api('user/sticker', c, function(response){
				var data = response.data.c.data.content;
				vm.listSearchItem = data.sticker_collection;
			});
		}

		vm.deleteSticker = deleteSticker;
		function deleteSticker(id){
			var c = {
				data: {
					sticker_collection_id: id
				}
			};

			CiayoService.Api('user/sticker/delete', c, function(response){
				alert(response.data.c.data.message);
			});
		}

		vm.init();

		// priority function	
		vm.setPriority = setPriority;
		function setPriority(id, pos) {
			var pos = pos + 1;
			var c = {
				data: {
					sticker_collection_id: id,
					order: pos
				}
			}
			CiayoService.Api('ciayoproducts/priority', c, function(response){
				//loadStickerCollection();
			});
		}

		vm.removePriority = removePriority;
		function removePriority(id, pos) {
			var pos = pos + 1;
			var c = {
				data: {
					sticker_collection_id: id
				}
			}
			CiayoService.Api('ciayoproducts/priority/remove', c, function(response){
				//loadStickerCollection();
			});
		}

		function updateOrder(id, pos){
			console.log(pos);
			if(pos){
				pos = pos + 1;
			} else {
				pos = null;
			}
			for(var i = 0; i < vm.listStickerCollection.length; i++){
				if(vm.listStickerCollection[i].id == id){
					vm.listStickerCollection[i].order = pos;
				}
			}
		}
	}
})();;
(function() {
		'use strict';
		angular
				.module('app')
				.controller('languageController', ['$translate', '$scope', 'SettingService', '$cookieStore', function($translate, $scope, SettingService, $cookieStore) {
						var me=this;
						var lang_code = ['', 'en', 'id'];
						function changeLang(id) {
								$translate.use(lang_code[id]);
								$cookieStore.put('language', id);
								SettingService.changeLanguage(id, function(response) {
										getLanguage();
								});
						}
						function getLanguage() {
								SettingService.getLanguage(function(response) {
										me.language=lang_code[response.data.c.data.content.language];
										if(response.data.c.data.content.language==1) {
												me.lang_select = "English";
										} else {
												me.lang_select = "Bahasa Indonesia";
										}
								});
						}
						me.getLanguge=getLanguage;
						me.changeLang=changeLang;
						getLanguage();
				}])
})();;
(function () {
	'use strict';
	angular
		.module('app')
		.controller('ConnectionNotification', ConnectionNotification);
	
	ConnectionNotification.$inject = ['$state','$stateParams', 'AuthService','CiayoService','ConnectionService','$cookieStore', 'modalFactory','CiayoBanner'];
	function ConnectionNotification($state,$stateParams, AuthService, CiayoService,ConnectionService,$cookieStore, modalFactory, CiayoBanner) {
		var me=this;
		me.list_user_all=[];
		me.list_user_fro=[];
		me.list_user_foo=[];
		me.list_user_cio=[];

		me.start_notification = false;
		me.isloading_all = false;
		me.isloading_fro = false;
		me.isloading_foo = false;
		me.isloading_cio = false;

		CiayoBanner.getData("notification", function(response){
			me.banner = response.data.c.data.content.image;
			setTimeout(function(){
				$('.c-banner').children("ul").parallax({
					clipRelativeInput: false,
					originY: 0.0
				});
			}, 1)
		}, function(){

		})

		function getList_next(type, limit, offset){
			
				ConnectionService.listNotification ( 
					type, limit, offset,
					function(response){//callback sucess
						//console.log(response.data.c.data.content.list_notification);

						var tmp_next=(response.data.c.data.content.list_notification);
						//console.log(tmp_next.length);
						if(type=="null"){
							if(tmp_next.length==0){
								me.button_show_more_all = false;
							}else{
								me.button_show_more_all = true;
							}
						}else if(type=="friend_only"){
							if(tmp_next.length==0){
								me.button_show_more_fro = false;
							}else{
								me.button_show_more_fro = true;
							}
						}else if(type=="following_only"){
							if(tmp_next.length==0){
								me.button_show_more_foo = false;
							}else{
								me.button_show_more_foo = true;
							}
						}else if(type=="ciayo_only"){
							if(tmp_next.length==0){
								me.button_show_more_cio = false;
							}else{
								me.button_show_more_cio = true;
							}
						}
					},
					function(response){//err callback
						console.log(response);
					}
				);
		}

		function getList_all(type, limit, offset){

			if(!me.isloading_all){
				//console.log('test');
				me.isloading_all = true;
			
				ConnectionService.listNotification ( 
					type, limit, offset,
					function(response){//callback sucess
						//console.log(response.data.c.data.content.list_notification);
						me.start_notification = true;
						me.isloading_all = false;

						var tmp=(response.data.c.data.content.list_notification);

						angular.forEach(tmp,function(value,key){
							me.list_user_all.push(value);
						});

						

						var offset_next = offset + 10;
						getList_next(type, 10, me.list_user_all.length);
					},
					function(response){//err callback
						console.log(response);
					}
				);
			}
		}

		function getList_fro(type, limit, offset){
			
			if(!me.isloading_fro){
				//console.log('test');
				me.isloading_fro = true;
			
				ConnectionService.listNotification ( 
					type, limit, offset,
					function(response){//callback sucess
						//console.log(response.data.c.data.content.list_notification);

						var tmp=(response.data.c.data.content.list_notification);

						angular.forEach(tmp,function(value,key){
							me.list_user_fro.push(value);
						});

						//me.start_notification = true;
						me.isloading_fro = false;

						var offset_next = offset + 10;
						getList_next(type, 10, me.list_user_fro.length);
					},
					function(response){//err callback
						console.log(response);
					}
				);
			}
		}


		function getList_foo(type, limit, offset){
			
			if(!me.isloading_foo){
				//console.log('test');
				me.isloading_foo = true;
			
				ConnectionService.listNotification ( 
					type, limit, offset,
					function(response){//callback sucess
						//console.log(response.data.c.data.content.list_notification);

						var tmp=(response.data.c.data.content.list_notification);

						angular.forEach(tmp,function(value,key){
							me.list_user_foo.push(value);
						});

						//me.start_notification = true;
						me.isloading_foo = false;

						var offset_next = offset + 10;
						getList_next(type, 10, me.list_user_foo.length);
					},
					function(response){//err callback
						console.log(response);
					}
				);
			}
		}

		function getList_cio(type, limit, offset){
			
			if(!me.isloading_cio){
				//console.log('test');
				me.isloading_cio = true;
			
				ConnectionService.listNotification ( 
					type, limit, offset,
					function(response){//callback sucess
						//console.log(response.data.c.data.content.list_notification);

						var tmp=(response.data.c.data.content.list_notification);

						angular.forEach(tmp,function(value,key){
							me.list_user_cio.push(value);
						});

						//me.start_notification = true;
						me.isloading_cio = false;

						var offset_next = offset + 10;
						getList_next(type, 10, me.list_user_cio.length);
					},
					function(response){//err callback
						console.log(response);
					}
				);
			}
		}

		
		//me.getList=getList;

		getList_all("null", 10, 0);
		getList_fro("friend_only", 10, 0);
		getList_foo("following_only", 10, 0);
		getList_foo("ciayo_only", 10, 0);

		function loadMoreRecords(type){
			if(type=='all'){
				//me.button_show_more_all = true;
				getList_all("null", 10, me.list_user_all.length);
			}else if(type=='fro'){
				//me.button_show_more_fro = true;
				getList_fro("friend_only", 10, me.list_user_fro.length);
			}else if(type=='foo'){
				//me.button_show_more_foo = true;
				getList_foo("following_only", 10, me.list_user_foo.length);
			}else if(type=='cio'){
				//me.button_show_more_cio = true;
				getList_cio("ciayo_only", 10, me.list_user_cio.length);
			}
		}

		me.loadMoreRecords = loadMoreRecords;

		function view_notification(kind, index){
						
					if(kind=='all'){
						var post_id = me.list_user_all[index].post_id;
						var read_at_real = me.list_user_all[index].read_at;
						var id = me.list_user_all[index].notification_id;
						var type = me.list_user_all[index].type;
						var username = me.list_user_all[index].username;
						var post_code = me.list_user_all[index].post_code;
					}else if(kind=='fro'){
						var post_id = me.list_user_fro[index].post_id;
						var read_at_real = me.list_user_fro[index].read_at;
						var id = me.list_user_fro[index].notification_id;
						var type = me.list_user_fro[index].type;
						var username = me.list_user_fro[index].username;
						var post_code = me.list_user_fro[index].post_code;
					}else if(kind=='foo'){
						var post_id = me.list_user_foo[index].post_id;
						var read_at_real = me.list_user_foo[index].read_at;
						var id = me.list_user_foo[index].notification_id;
						var type = me.list_user_foo[index].type;
						var username = me.list_user_foo[index].username;
						var post_code = me.list_user_foo[index].post_code;
					}else if(kind=='cio'){
						var post_id = me.list_user_cio[index].post_id;
						var read_at_real = me.list_user_cio[index].read_at;
						var id = me.list_user_cio[index].notification_id;
						var type = me.list_user_cio[index].type;
						var username = me.list_user_cio[index].username;
						var post_code = me.list_user_cio[index].post_code;
					}

						if(read_at_real==null){

							var read_at = Number(new Date());

							ConnectionService.requestViewNotification (id, type, read_at, function(response){
								console.log(response);
								//alert("Halaman detail post id : " + post_id);
								//me.notification_popup_all[index].read_at = 1;

								if(type=="friend_request" || type == "follow_request" || type == "added_friend"){
									$state.go('profile', {user: username});
								}else if(type=="ask_with"){
									modalFactory.withCard(post_code);
								}else if(type=="ask_place"){
									modalFactory.placeCard(post_code);
								}else{
									if($stateParams.post_id==post_code){
										$state.reload()
									}else
									$state.go('detail-page', {post_id: post_code});
								}	


							},function(response){
								//console.log(response);
							});
						}else{
								if(type=="friend_request" || type == "follow_request" || type == "added_friend"){
									$state.go('profile', {user: username});
								}else if(type=="ask_with"){
									modalFactory.withCard(post_code);
								}else if(type=="ask_place"){
									modalFactory.placeCard(post_code);
								}else{
									if($stateParams.post_id==post_code){
										$state.reload()
									}else
									$state.go('detail-page', {post_id: post_code});
								}	
						}
		}

		me.view_notification = view_notification;
		me.notification_delete = notification_delete;

		function notification_delete(index, kind){

						// modalFactory.confirm(
						// 	'Are you sure want to delete this notification ?',
						// 	function(response){
						// 		if(response){

									if(kind=='all'){
										var id = me.list_user_all[index].notification_id;
										var type = me.list_user_all[index].type;
									}else if(kind=='fro'){
										var id = me.list_user_fro[index].notification_id;
										var type = me.list_user_fro[index].type;
									}else if(kind=='foo'){
										var id = me.list_user_foo[index].notification_id;
										var type = me.list_user_foo[index].type;
									}else if(kind=='cio'){
										var id = me.list_user_cio[index].notification_id;
										var type = me.list_user_cio[index].type;
									}
									
									ConnectionService.requestDeleteNotification (id, type, function(response){
										if(kind=='all'){
											me.list_user_all.splice(index, 1);
										}else if(kind=='fro'){
											me.list_user_fro.splice(index, 1);
										}else if(kind=='foo'){
											me.list_user_foo.splice(index, 1);
										}else if(kind=='cio'){
											me.list_user_cio.splice(index, 1);
										}
										$rootScope.$broadcast( "user.notification",'data' );	
									},function(response){
										console.log(response);
									});
									
						// 		}
						// 	}
						// );
		}

	}

})();;
(function() {
'use strict';

angular
	.module('app')
	.directive('toggleModal', function(){
		return {
			restrict: "A",
			link: function(scope, elem, attr){
				$(elem).on("click", function(e){
					e.preventDefault();

					if(attr.toggleModal === "close"){
							$(document.body).removeAttr("style");
							$('.c-modal').removeClass('-open');
							$('.ui-datepicker').css('display', 'none');
					} else{
							$(document.body).css("overflow", "hidden");
							$('#' + attr.toggleModal).addClass('-open');
					}
				})
			}
		}
	})
	.filter('spaceless',function() {
		return function(input) {
			if (input) {
				input=input.trim();
				return input.replace(/\s+/g, '-');		
			}
		}
	})
	.controller('ProfileController', ProfileController);

	ProfileController.$inject = ['$rootScope', '$cookieStore','CiayoService','ProfileService', 'SettingService', 'ConnectionService', '$state', '$stateParams', '$filter', '$scope', '$mdDialog','PostService','CiayoBanner','listService','ItemService','$element','modalFactory'];
	function ProfileController($rootScope, $cookieStore,CiayoService, ProfileService, SettingService, ConnectionService, $state, $stateParams, $filter, $mdDialog, $scope, PostService, CiayoBanner, listService, ItemService, $element,modalFactory) {
		var vm = this;
		angular.extend(vm,{
			profile_url:"views/profile.html",
			param_user:$stateParams.user,
			state:0,
			cur_time:'',
			lastId:null,
			reset:reset,
			js_timeline:[],
			setFocus:function(focus,arrayIndex){
				angular.forEach(this.prop,function(value,key){
					if(value.isArray){
						value.isFocus=angular.equals(key,focus)?arrayIndex:-1;
					}else{
						value.isFocus=angular.equals(key,focus);
					}
				});
			},
			setActive:function(active,arrayIndex){
				angular.forEach(this.prop,function(value,key){
					if(value.isArray){
						value.isActive=angular.equals(key,active)?arrayIndex:-1;
					}else{
						value.isActive=angular.equals(key,active);
					}
				});
			},
			prop:{
				list_place:{
					text:'',
					search_list:Object.create(listService)
				},
				caption:{
					text:''
				},
				item:{
					isArray:true,
				},
				with:{
					text:''
				},
				place:{
					text:'',
					selected:{}
				}
			},
			default:{
								
			},
			list_place:{
				isActive:false,
				waiting:false,
				list:[],
				text:'',
				selectedIndex:0,
				prev:function(){
					if(parseInt(this.selectedIndex)>0){
						this.selectedIndex--;
					}
					var wrp = $('._place').offset();
					var off = $('#div_list_place ul li:nth-child('+this.selectedIndex+')').offset();
					try {
						var scale = off.top - wrp.top;
					}catch(err){
						var pos = $("#div_list_place").scrollTop(0);
						$("#div_list_place").scrollTop(pos);
					}
					if(scale<30) {
						var pos = $("#div_list_place").scrollTop() - 32;
						$("#div_list_place").scrollTop(pos);
					}
				},
				next:function(){
					if(parseInt(this.selectedIndex)+1<this.list.length){
						this.selectedIndex++;
					}
					var wrp = $('._place').offset();
					var li = $('#div_list_place ul li:nth-child('+this.selectedIndex+')').offset();
					var off = li.top;
					var scale = off - wrp.top;
					if(scale > 200){
						var pos = $("#div_list_place").scrollTop() + 32;
						$("#div_list_place").scrollTop(pos);
					}
					
				}
			}
		});

		vm.language_id = $cookieStore.get('language');

		function reset(){
			this.setFocus('item',0);
		}

		SettingService.getInfo('').then(function(data) {
			var info=[];
			angular.forEach(data.content.users_info,function(value,key){
                info[value.filter_id] = value;
            });
			try {vm.my_name = info[5].value}catch(err){}
			vm.my_id = data.content.user_id;
		});	
		
		ProfileService.listTitle('score', 'desc', 10, 0, true, function(response){
			vm.listTitle = response.data.c.data.content.data;
		},function(response){

		});

		vm.listCompleted = [];
		vm.listCompletedEmpty = false;
		vm.orderBy = 'asc';
					
		vm.addFriend = function(target) {
			vm.status_add = true;
			vm.add_status_text = "Request Sent";
			vm.status_addstatus = true;
			vm.status_follow = true;

			 ConnectionService.requestAddFriend(vm.user_id, function(response) {
			 	// console.log('request add friend');
	     		// console.log(response);
	    	});
		}

		vm.followFriend = function(status) {
			if(status) {
				vm.status_follow = true;
			} else {
				vm.status_follow = false;
			}
			ConnectionService.requestFollow(vm.user_id, status, function(response){

				console.debug('request follow friend');
	    		// console.log(response);

			},function(response){
				// console.log(response);
			});
		}

		vm.confirmRequestFriend = function(status) {
			vm.showdropconnect = false;
			ProfileService.confirmRequestFriend(vm.user_id, function(response){

				console.debug('confirm request friend');
	    		// console.log(response);
	    		vm.status_approve = true;
	    		vm.status_add = true;
	    		vm.status_follow = true;
	    		$rootScope.$broadcast( "user.added_friend",'data' );

			},function(response){
				// console.log(response);
			});
		}

		vm.rejectRequestFriend = function(status) {
			vm.showdropconnect = false;
			ProfileService.rejectRequestFriend(vm.user_id, function(response){

				console.debug('reject request friend');
	    		// console.log(response);
	    		vm.status_add = false;
	    		$rootScope.$broadcast( "user.added_friend",'data' );

			},function(response){
				//// console.log(response);
			});
		}

		vm.deleteFriend = function(status) {
			vm.showdropadd = false;
			ProfileService.deleteFriend(vm.user_id, function(response){

				console.debug('deletefriend');
	    		// console.log(response);
	    		vm.status_add = false;
	    		vm.status_approve = false;

			},function(response){
				// console.log(response);
			});
		}

		vm.social_media_null = false;

		vm.getSettings = function() {
			SettingService.getSettings().then(function(data) {
				var setting = data.content.list_setting;
				var general = setting.general_setting;
				var email_setting = general.email_setting;
				var edit_account = setting.edit_account;
				var edit_basic_info = setting.edit_basic_info;

				vm.show_email = edit_account.show_email.value;
				vm.show_phone = edit_account.show_phone.value;

				if(!$stateParams.user) {

					try{vm.email = edit_account.email_address.value}catch(err){}
					try{vm.phone = edit_account.phone_number.value}catch(err){}
					vm.edit_email = vm.email;
					vm.edit_phone = vm.phone;

					try{vm.place_of_birth = edit_basic_info.place_of_birth.value}catch(err){}

					try{var timestamp = edit_basic_info.date_of_birth.value}catch(err){}
					var date = new Date(timestamp * 1000);
					var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
					vm.date_of_birth = date.getDate() + " " + months[date.getMonth()] + " " + date.getFullYear();
					if(vm.place_of_birth && vm.date_of_birth) {
						vm.qoma = ", ";
					} else {
						vm.qoma = "";
					}
					//vm.edit_date_of_birth = date.getDate() + "/" + (parseInt(date.getMonth())+1) + "/" + date.getFullYear();
					var _date = parseInt(date.getDate());
					if(_date<10) {
						_date = "0" + date.getDate();
					}
					var _mounth = parseInt(date.getMonth())+1;
					if(_mounth<10) {
						_mounth = "0" + (parseInt(date.getMonth())+1);
					}
					var newdate = _date + "/" + _mounth + "/" + date.getFullYear();

					try {vm.place_of_birth = info[7].value}catch(err){}

					vm.edit_date_of_birth = newdate;
					var $datepicker = $('#datepicker');
					$datepicker.datepicker();
					$datepicker.datepicker('setDate', new Date(newdate));
				}
				//vm.show_birthday = edit_account.show_birthday.value;
				//vm.show_nationality = edit_account.show_nationality.value;
			});
		}

		vm.getSettings();

		vm.showEmail = function() {
			if (vm.show_email) {
				SettingService.userPreference(1, 'show_email').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'show_email').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		vm.showPhone = function() {
			if (vm.show_phone) {
				SettingService.userPreference(1, 'show_phone').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'show_phone').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		vm.showBirthday = function() {
			if (vm.show_birthday) {
				SettingService.userPreference(1, 'show_birthday').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'show_birthday').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		vm.prefixPhoneNumber = function() {
			var limit = 500;
			var offset = 0;
			SettingService.prefixPhoneNumber(limit, offset).then(function(data) {
				vm.list_prefix_phone_number = data.content.list_prefix_phone_number;
				vm.list_nationality = data.content.list_prefix_phone_number;
			},function(response){
            	//error
        	})
		}

		vm.prefixPhoneNumber();

		vm.showNationality = function() {
			if (vm.show_nationality) {
				SettingService.userPreference(1, 'show_nationality').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'show_nationality').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		vm.sendRequest = function(type) {
			if(type=='birthday') {
				vm.ask_birthday = false;
			}
			if(type=='email') {
				vm.ask_email = false;
			}
			if(type=='phone') {
				vm.ask_phone = false;
			}
		}

		vm.getBasicInfo = function() {

			vm.lastId = null;
			vm.reset();
			vm.cur_time=new Date().getTime();

			$rootScope.$on('$stateChangeStart', 
			function(event, toState, toParams, fromState, fromParams){ 
				$('.ui-datepicker').css('display', 'none');
			});

			if(!vm.aboutme) {

				SettingService.getInfo($stateParams.user).then(function(data) {
					if(data.error){
						
					}else{
						vm.user_id = data.content.user_id;
						vm.old_user_id = data.content.user_id;

						loadTimeline();
						vm.token_user_id = vm.user_id;
						//console.log(ProfileService.userData);
						
						angular.extend(vm,data);

						loadAchievement();

						if($stateParams.user) {
							// status info
							vm.cbutton_status = [];

							vm.cbutton_status = data.content;
							//console.log(vm.cbutton_status);

							vm.cbutton_status.username = $stateParams.user;

							vm.cbutton_status.icon_action_response = false;
							vm.cbutton_status.open_action = false;
							vm.cbutton_status.ci_star = false;
							vm.cbutton_status.ci_check = false;

							//console.log(vm.cbutton_status.status.friend.add);

							if(vm.cbutton_status.status.friend.add==false){
								vm.cbutton_status.icon_addfriend = true;
								vm.cbutton_status.name_addfriend = true;
								vm.cbutton_status.icon_self = 0;
								vm.cbutton_status.name_self = 0;
							}else{
								if(vm.cbutton_status.status.friend.addstatus==false){
									if(vm.cbutton_status.status.friend.approve==true){
										vm.cbutton_status.icon_addfriend = false;
										vm.cbutton_status.name_addfriend = false;
										vm.cbutton_status.icon_self = 0;
										vm.cbutton_status.name_self = 0;
									}else{
										vm.cbutton_status.icon_addfriend = true;
										vm.cbutton_status.name_addfriend = true;
										vm.cbutton_status.icon_self = 1;
										vm.cbutton_status.name_self = 1;
										vm.cbutton_status.ci_star = true;
									}
								}else{
									vm.cbutton_status.icon_addfriend = false;
									vm.cbutton_status.name_addfriend = false;
									vm.cbutton_status.icon_self = 0;
									vm.cbutton_status.name_self = 0;
									vm.cbutton_status.ci_check = true;
								}
							}
						
							if(vm.cbutton_status.status.friend.approve==false){
								vm.cbutton_status.checklist_addfriend = true;
							}else{
								vm.cbutton_status.checklist_addfriend = false;
							}

							if(vm.cbutton_status.status.follow==false){
								vm.cbutton_status.icon_follow = true;
								vm.cbutton_status.name_follow = true;
								vm.cbutton_status.checklist_follow = true;
							}else{
								vm.cbutton_status.icon_follow = false;
								vm.cbutton_status.name_follow = false;
							}

							if($stateParams.user){
								vm.cbutton_status.self = 'false';
							}else{
								vm.cbutton_status.self = 'true';
							}
						}

						vm.listAchievement();

						getList_self(vm.searchtext, 10, 0);

						getList(vm.searchtext, 10, 0, vm.user_id);

						// console.log(vm.user_id);

						vm.getMutualFriend = function() {
							ConnectionService.getMutualFriend(vm.user_id, function(response) {
								// console.log('get mutual friend');
		                		// console.log(response);
		                	});
						}

						vm.getMutualFriend();
						
						vm.aboutme = data;
	            		var info=[];
	            		vm.user_avatar = data.content.users_avatar;

	            		vm.status_add = data.content.status.friend.add;
	                	// console.log(vm.status_add);
	                	vm.status_approve = data.content.status.friend.approve;
	                	vm.status_addstatus = data.content.status.friend.addstatus;
	                	if(vm.status_add == true && vm.status_approve == false) {
	                		vm.add_status_text = "Request Sent";
	                	}
	                	if(vm.status_add == true && vm.status_approve == true) {
	                		vm.add_status_text = "Friend";
	                	}
	                	if(vm.status_add == false && vm.status_approve == false) {
	                		vm.add_status_text = "Add Friend";
	                	}
	                	vm.status_follow = data.content.status.follow;
	                	if(vm.status_follow == true) {
	                		vm.follow_status_text = "Following";
	                	} else {
	                		vm.follow_status_text = "Follow";
	                	}
	                	vm.showdropadd = false;
	                	vm.showdropfollow = false;

	                	if($stateParams.user) {

		            		try {
		            			vm.email = data.content.email;
		            			vm.edit_email = vm.email;
		            		}catch(err){}

		            		try {
		            			vm.phone = data.content.phone;
		            			var phone = vm.phone.split('-');
								vm.prefix_verify = phone[0];
								vm.phone_number = phone[1];

		            		}catch(err){}

	            			var info = [];
							angular.forEach(data.content.users_info,function(value,key){
			                    info[value.filter_id] = value;
			                });

							try {vm.profile_name = info[5].value}catch(err){}
							try {vm.title = info[520].value}catch(err){}

							try {var timestamp = info[6].value}catch(err){}
							var date = new Date(timestamp * 1000);
							var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
							vm.date_of_birth = date.getDate() + " " + months[date.getMonth()] + " " + date.getFullYear();
							//vm.edit_date_of_birth = date.getDate() + "/" + (parseInt(date.getMonth())+1) + "/" + date.getFullYear();
							var _date = parseInt(date.getDate());
							if(_date<10) {
								_date = "0" + date.getDate();
							}
							var _mounth = parseInt(date.getMonth())+1;
							if(_mounth<10) {
								_mounth = "0" + (parseInt(date.getMonth())+1);
							}
							var newdate = _date + "/" + _mounth + "/" + date.getFullYear();

							try {
								if(vm.date_of_birth) {
									vm.place_of_birth = info[7].value+', ';
								} else {
									vm.place_of_birth = info[7].value;
								}
							}catch(err){}

							vm.edit_date_of_birth = newdate;
							var $datepicker = $('#datepicker');
							$datepicker.datepicker();
							$datepicker.datepicker('setDate', new Date(newdate));
		            	}

						angular.forEach(data.content.users_info,function(value,key){
		                    info[value.filter_id] = value;
		                });

						try {vm.first_name = info[2].value}catch(err){}
						try {vm.middle_name = info[3].value}catch(err){}
						try {vm.last_name = info[4].value}catch(err){}
						try {vm.profile_name = info[5].value}catch(err){}
						try {vm.edit_profile_name = info[5].value}catch(err){}

						try {vm.pinterest = info[501].value}catch(err){vm.pinterest = false}
						try {vm.facebook = info[480].value}catch(err){ vm.facebook = false}
						try {vm.twitter = info[481].value}catch(err){ vm.twitter = false}
						try {vm.instagram = info[482].value}catch(err){vm.instagram = false}
						try {vm.path = info[500].value}catch(err){vm.path = false}
						if(vm.pinterest==false&&vm.facebook==false&&vm.twitter==false&&vm.instagram==false){
							vm.social_media_nodata=true;
						}
	
						if($stateParams.user) {
							vm.list_social_media = [];
							if(vm.pinterest) vm.list_social_media.push({"name":"Pinterest","value":vm.pinterest});
							if(vm.facebook) vm.list_social_media.push({"name":"Facebook","value":vm.facebook});
							if(vm.twitter) vm.list_social_media.push({"name":"Twitter","value":vm.twitter});
							if(vm.instagram) vm.list_social_media.push({"name":"Instagram","value":vm.instagram});
							if(vm.path) vm.list_social_media.push({"name":"Path-01","value":vm.path});
							if(!vm.list_social_media.length) vm.social_media_null=true;
						} else {
							listSocialMedia();
						}

						try {vm.edit_title = info[520].value}catch(err){}
						try {vm.title = info[520].value}catch(err){vm.title = "no title"}
						
						// // console.log('date' + info[6].value);
						try {vm.nationality = info[8].value}catch(err){}
						try {vm.edit_nationality = info[8].value}catch(err){}
						if(vm.first_name == "-") {vm.first_name = "";}
						if(vm.middle_name == "-") {vm.middle_name = "";}
						if(vm.last_name == "-") {vm.last_name = "";}

						vm.website = null;
						vm.websiteLoading = true;
			            try {
			            	vm.website = null;
			            	vm.edit_list_website = [];
			            	vm.temp_website = [];
			            	vm.website = info[37].value.split(',');
			            	if(vm.website!=' ') {
				            	vm.list_website = [];
				            	for(var i=0 ; i<vm.website.length; i++) {
					            	var val=vm.website[i].split('//');
									if(val[1] != undefined) {
										var value = val[1];
									} else {
										var value = val[0];
									}
									vm.list_website.push({"name":value});
									vm.temp_website[i] = value;
								}
								angular.forEach(vm.list_website,function(value,key){
									vm.edit_list_website.push({"name":value.name});
								});
							} else {
								vm.website = '';
							}
						}catch(err){}

						var keyword = vm.profile_name;
		        		ProfileService.searchUser(keyword, 100, 0, function(response) {
			        		var data = response.data.c.data.content;
			        		var user = [];
			        		angular.forEach(data.list_user,function(value,key){
			                    user[value.user_id] = value;
			                    // console.log(user[value.user_id]);
			                    // console.log(vm.user_id);
			                });
			        		// console.log(response);
				        });
		        	}
				},function(response){
					if(response.status==200){
						var data = response.data.c.data;
						if(data.error==true){
							$state.go('404');
						}
					}
				});
			}
		}

		vm.showdropfollow = false;

		vm.getBasicInfo();

		CiayoBanner.getData("profile", function(response){
			vm.banner = response.data.c.data.content.image;
			setTimeout(function(){
				$('.c-banner').children("ul").parallax({
					clipRelativeInput: false,
					originY: 0.0
				});
			}, 1)
		}, function(){

		})

		vm.addWebsite = function() {
			vm.edit_list_website.push({"name":vm.edit_website});
			var id = 0;
			vm.temp_website = [];
			angular.forEach(vm.edit_list_website,function(value,key){
				vm.temp_website[id]=value.name;
				id++;
			});
			vm.edit_website = '';
		}

		vm.removeWebsite = function(id) {
			for(var i = 0; i < vm.edit_list_website.length; i++) {
				if(vm.edit_list_website[i]['name']==id) {
			    	delete vm.edit_list_website[i];
			    }
			}
			vm.temp_list_website = vm.edit_list_website;
			vm.edit_list_website = [];
			vm.temp_website = [];
			var id = 0;
			angular.forEach(vm.temp_list_website,function(value,key){
				vm.edit_list_website.push({"name":value.name});
				vm.temp_website[id] = value.name;
				id++;
			});
			if(!vm.edit_list_website.length) {
				vm.website_value = ' ';
			}
		}

		vm.saveWebsite = function() {
			if(vm.edit_website) vm.addWebsite();
			if(vm.edit_list_website.length) {
				var id = 0;
				vm.temp_list_website = vm.edit_list_website;
				vm.edit_list_website = [];
				angular.forEach(vm.temp_list_website,function(value,key){
					if(id==0) {
						vm.website_value = vm.temp_website[id];
					} else {
						vm.website_value += ","+vm.temp_website[id];
					}
					vm.edit_list_website.push({"name":vm.temp_website[id]});
					id++;
				});
				vm.website_value = vm.website_value.replace('undefined','');
			}
			if(vm.website_value==undefined) {
				vm.website_value = ' ';
			}
			var type = 2;
			var updated_filter = [{"filter_id":37,"filter_value" : vm.website_value}];
			SettingService.updateUserFilter(updated_filter, type).then(function(data) {
				if(vm.edit_list_website.length) {
					vm.list_website = [];
					angular.forEach(vm.edit_list_website,function(value,key){
						vm.list_website.push({"name":value.name});
					});
				} else {
					vm.list_website = null;
					vm.website = null;
				}
			});
		}

		vm.orderType = 'name';
		vm.orderBy = 'asc';

		vm.offset = 0;
		vm.listCompleted = [];

		function loadAchievement() {
			var c = {
				data: {
					"orderType": vm.orderType,
					"orderBy": vm.orderBy,
					"limit": 20,
					"offset": vm.offset,
					"search": vm.keyword,
					"user_id": vm.user_id
				}
			}
			// get list achievement completed
			CiayoService.Api('achievement/completed', c, function(response){
				if(response.status == 200) {
					scroll();
					var data = response.data.c.data.content.data;
					if(data.length) {
						vm.listCompletedEmpty = false;
						vm.listCompleted = vm.listCompleted.concat(data);
					} else {
						vm.listCompletedEmpty = true;
					}
				} else {
					alert('error ya :(');
				}
			});
		}

		vm.changeOrder = changeOrder;
		function changeOrder(type, by){
			console.log(type);
			vm.orderType = type;
			vm.orderBy = by;
			vm.offset = 0;
			vm.scrollOffset = 200;
			vm.listCompleted = [];
			loadAchievement();
		}

		vm.srchAchievement = srchAchievement;
		function srchAchievement() {
			vm.offset = 0;
			vm.scrollOffset = 200;
			vm.listCompleted = [];
			loadAchievement();
		}

		vm.viewDetail = viewDetail;
		function viewDetail(id) {
			vm.itemDetail = null;
			var elem = angular.element('.c-modal.achievement');
			elem.addClass('-open');

			var c = {
				data: {
					"id_achievement": id,
					"user_id": vm.user_id
				}
			};

			CiayoService.Api('achievement/detail', c, function(response) {
				vm.itemDetail = response.data.c.data.content;
				var date = new Date(vm.itemDetail.date_get*1000);
				vm.itemDetail.date_get = date.getDate()+'/'+(date.getMonth()+1)+'/'+date.getFullYear();
				console.log(vm.itemDetail.date_get)
				vm.threshold = vm.itemDetail.treshold.data;
				console.log(vm.threshold);
			});
		}

		vm.closeDetail = closeDetail;
		function closeDetail() {
			var elem = angular.element('.c-modal.achievement');
			elem.removeClass('-open');
			vm.itemDetail = null;
			vm.threshold = null;
		}

		vm.id_list_cities = 1;

		vm.selectCities = function($event) {
		    if($event.keyCode === 40) {
				$event.preventDefault();
				vm.list_place.next();
			} else if($event.keyCode === 38) {
				$event.preventDefault();
				vm.list_place.prev();
			} else if($event.keyCode === 13) { 
				vm.selectPlace(vm.list_place.list[vm.list_place.selectedIndex]);
			}
		}

		vm.selectPlace = function(value) {
			vm.edit_place_of_birth = value.name;
			vm.place_birth = value.name;
			angular.element('._listplace').removeClass('active');
		}

		vm.listBadge = function() {
			var orderType = 'name';
			var orderBy = 'asc';
			var limit = 5;
			var offset = 0;
			ProfileService.listBadge(orderType, orderBy, limit, offset, function(response) {
				vm.list_badge = response.data.c.data.content.data;
				vm.badge_collect = [];
				angular.forEach(vm.list_badge,function(value,key){
					vm.badge_collect[value.id] = false;
				});

				ProfileService.choiceBadge(vm.user_id, function(response) {
					var list = response.data.c.data.content.data;
					vm.user_threshold_badge = [];
					vm.order_badge = 0;
					angular.forEach(list,function(value,key){
						if(value.order&&value.order<100) {
							vm.user_threshold_badge.push({"threshod_id":value.id,"order":value.order});
							vm.badge_collect[value.id] = true;
							vm.order_badge++;
						}
					});
				});
			});
		}

		vm.listBadge();

		vm.pickBadge = function(item) {
			if(!vm.badge_collect[item]) {
				vm.edit_choice_badge = true;
				vm.order_badge++;
				vm.user_threshold_badge.push({"threshod_id":item,"order":vm.order_badge});
				console.log(vm.user_threshold_badge);
				vm.badge_collect[item] = true;
				$('#choiceaddbadge'+item).fadeIn('fast', function() {
					$('#choiceaddbadge'+item).show();
				});
			} else {
				vm.removeChoiceBadge(item);
			}
		}

		vm.listAchievement = function() {
			var orderType = 'name';
			var orderBy = 'asc';
			var limit = 50;
			var offset = 0;
			var search = vm.keyword_achievement;
			ProfileService.listAchievement(orderType, orderBy, limit, offset, search, function(response) {
				vm.list_achievement = response.data.c.data.content.data;

				vm.achievement_collect = [];
				angular.forEach(vm.list_achievement,function(value,key){
					vm.achievement_collect[value.id] = false;
				});
					
				ProfileService.choiceAchievement(vm.user_id, function(response) {
					vm.user_threshold_achievement = response.data.c.data.content.data;
					vm.threshold_achievement = [];
					vm.edit_threshold_achievement = [];
					vm.order_achievement = 0;
					vm.count = 1;
					vm.column = 1;
					vm.column_data = [];
					vm.achievement_pick = [];
					var length = (vm.user_threshold_achievement.length/6)+1;
					vm.achievement_collect = new Array();
					for(var i=1;i<=length;i++) {
						vm.achievement_collect[i]=[];
					}
					vm.column_data.push({"column":0});
					angular.forEach(vm.user_threshold_achievement,function(value,key){
						if(value.order&&value.order<100) {
							vm.threshold_achievement.push({"threshod_id":value.id,"order":value.order,"name":value.name,"image":value.image});
							vm.edit_threshold_achievement.push({"threshod_id":value.id,"order":value.order,"name":value.name,"image":value.image});
							vm.achievement_collect[vm.column].push({"threshod_id":value.id,"order":value.order,"name":value.name,"image":value.image});
							vm.achievement_pick[value.id] = true;
							if(vm.count%6==0) {
								vm.column_data.push({"column":vm.column});
								vm.column++;
							}
							vm.order_achievement++;
							vm.count++;
						}
					});
					vm.data_row_width = 450*(vm.column_data.length);
					if(!vm.achievement_collect[vm.column_data.length].length) vm.data_row_width -= 450;
				});
			});
		}

		vm.order_achievement = 1;
		vm.pick ="";
		vm.user_threshold = [];
		vm.order = 1;
		
		vm.pickAchievement = function(item,name,image) {
			if(!vm.achievement_pick[item]) {
				vm.edit_choice_achievement = true;
				vm.order_achievement++;
				vm.achievement_collect[vm.column].push({"threshod_id":item,"order":vm.order_achievement,"name":name,"image":image});
				vm.edit_threshold_achievement.push({"threshod_id":item,"order":vm.order_achievement,"name":name,"image":image});
				var length = vm.achievement_collect[vm.column_data.length].length;
				if(length>5) {
					vm.column_data.push({"column":vm.column_data.length+1});
					vm.column = vm.column_data.length;
					vm.achievement_collect[vm.column_data.length] = [];
					vm.data_row_width+=450;
					$('#achievement_wrp').animate({scrollLeft: '+='+vm.data_row_width});
				}
				vm.achievement_pick[item] = true;
				$('#choiceaddachievement'+item).fadeIn('fast', function() {
					$('#choiceaddachievement'+item).show();
				});
			} else {
				vm.removeChoiceAchievement(item);
			}
		}

		vm.removeChoiceAchievement = function(id) {
			vm.edit_choice_achievement = true;
			console.log(vm.column_data.length);
			for(var i = 0; i < vm.edit_threshold_achievement.length; i++) {
				if(vm.edit_threshold_achievement[i]['threshod_id']==id) {
			    	delete vm.edit_threshold_achievement[i];
			    }
			}
			
			vm.count = 1;
			vm.column = 1;
			vm.column_data = [];
			vm.temp_threshold_achievement =[];
			vm.column_data.push({"column":0});
			var length = (vm.edit_threshold_achievement.length/6)+1;
			for(var i=1;i<=length;i++) {
				vm.achievement_collect[i]=[];
			}
			angular.forEach(vm.edit_threshold_achievement,function(value,key){
				vm.temp_threshold_achievement.push({"threshod_id":value.threshod_id,"order":vm.count,"name":value.name,"image":value.image});
				vm.achievement_collect[vm.column].push({"threshod_id":value.threshod_id,"order":vm.count,"name":value.name,"image":value.image});
				if(vm.count%6==0) {
					vm.column_data.push({"column":vm.column});
					vm.column++;
				}
				vm.count++;
			});
			vm.edit_threshold_achievement = vm.temp_threshold_achievement;

			vm.achievement_pick[id] = false;

			vm.edit_threshold_achievement = JSON.stringify(vm.edit_threshold_achievement);
			vm.edit_threshold_achievement = vm.edit_threshold_achievement.replace('[]','[{"threshod_id":"1","order":"100"}]');
			vm.edit_threshold_achievement = JSON.parse(vm.edit_threshold_achievement);
			
			$('#choiceaddachievement'+id).fadeOut('fast', function() {
				$('#choiceaddachievement'+id).hide();
			});
		}

		vm.removeChoiceBadge = function(id) {
			console.log('hapus badge id : '+id);
			vm.edit_choice_badge = true;
			var id = id;

			for(var i = 0; i < vm.user_threshold_badge.length; i++) {
				if(vm.user_threshold_badge[i]['threshod_id']==id) {
			    	delete vm.user_threshold_badge[i];
			    }
			}

			vm.badge_collect[id] = false;

			vm.user_threshold_badge = JSON.stringify(vm.user_threshold_badge).replace(',null','');
			vm.user_threshold_badge = vm.user_threshold_badge.replace('null,','');
			vm.user_threshold_badge = vm.user_threshold_badge.replace('[null]','[{"threshod_id":"1","order":"100"}]');
			vm.user_threshold_badge = JSON.parse(vm.user_threshold_badge);
			
			$('#choiceaddbadge'+id).fadeOut('fast', function() {
				$('#choiceaddbadge'+id).hide();
			});
		}

		vm.choiceAchievementLeft = function() {
			$('#achievement_wrp').animate({scrollLeft: '-=450'},200);
		}

		vm.choiceAchievementRight = function() {
			$('#achievement_wrp').animate({scrollLeft: '+=450'},200);
		}



		function clearName() {
			vm.edit_profile_name = "";
		}

		vm.clearName = clearName;

		function editUsername() {
			var screen_name = vm.edit_profile_name;
			SettingService.updateScreenName(screen_name).then(function(data) {
				vm.my_name = vm.edit_profile_name;
				vm.profile_name = vm.edit_profile_name;
				$rootScope.$broadcast( "user.user_info_header",vm.edit_profile_name);
			});
			SettingService.saveTitle(vm.edit_title).then(function(data) {
				if(vm.edit_title!=undefined) {
					vm.title = vm.edit_title;
				}
				//$rootScope.$broadcast( "user.user_info_header", vm.edit_profile_name);
			});
		}

		vm.editUsername = editUsername;

		vm.searchAchievement = function() {
			vm.key_achievement = vm.keyword_achievement;
		}

			vm.user = $stateParams.user;

			vm.start_mutual_friends = false;
			if($stateParams.user){
				vm.start_mutual_friends = true;
			}

			vm.list_user_self=[];
			vm.list_user_self_next=[];
			vm.start_user_self = false;
			vm.action_check_me_self = action_check_me_self;
			vm.button_show_more_self = false;
			vm.isloading_self = false;
			
			vm.searchtext = '';//$stateParams.search_text;


			function loadMoreRecords_self(){
				//vm.button_show_more_self = true;
				getList_self(vm.searchtext, 10, vm.list_user_self.length);
				
			}

			vm.loadMoreRecords_self = loadMoreRecords_self;

			function getList_self_next(keyword, limit, offset){
				
					var user_friend_id = ($stateParams.user) ? vm.user_id : vm.token_user_id;
					//// console.log(vm.user_id);
					ConnectionService.listFriends (
						user_friend_id, keyword, offset, limit,
						function(response){//callback sucess
								
							//vm.list_user = response.data.c.data.content.list_user;
							var tmp_next=(response.data.c.data.content.list_user);
							//// console.log(tmp_next);
							
							angular.forEach(tmp_next,function(value,key){
									
							
								vm.list_user_self_next.push(value);
								
							});

							//// console.log(tmp.length);
							vm.loading_show_more_self = false;
							if(tmp_next.length==0){
								vm.button_show_more_self = false;
							}else{
								vm.button_show_more_self = true;
							}
						},
						function(response){//err callback
							// console.log(response);
						}
					);
				
			}

			function getList_self(keyword, limit, offset){
				if(!vm.isloading_self){
					vm.isloading_self = true;
					var user_friend_id = ($stateParams.user) ? vm.user_id : vm.token_user_id;
					
					ConnectionService.listFriends (
						user_friend_id, keyword, offset, limit,
						function(response){//callback sucess
								
							//vm.list_user = response.data.c.data.content.list_user;
							var tmp=(response.data.c.data.content.list_user);
							vm.tmp_count_self=(response.data.c.data.meta.total);
							//// console.log(tmp);
							vm.start_user_self = true;
							angular.forEach(tmp,function(value,key){

								if(vm.token_user_id==tmp[key].user_id){
									value.button_self = true;
								}else{
									value.button_self = false;
								}
									
								value.icon_action_response = false;
								value.open_action = false;
								value.ci_star = false;
								value.ci_check = false;
								
								if(tmp[key].status.friend.add==false){
									value.icon_addfriend = true;
									value.name_addfriend = true;
									value.icon_self = 0;
									value.name_self = 0;
									
									
								}else{
									
									if(tmp[key].status.friend.addstatus==false){
										if(tmp[key].status.friend.approve==true){
											value.icon_addfriend = false;
											value.name_addfriend = false;
											value.icon_self = 0;
											value.name_self = 0;
											
										}else{
											value.icon_addfriend = true;
											value.name_addfriend = true;
											value.icon_self = 1;
											value.name_self = 1;
											
											value.ci_star = true;
										}
									}else{
										value.icon_addfriend = false;
										value.name_addfriend = false;
										value.icon_self = 0;
										value.name_self = 0;
										value.ci_check = true;
									}
								}

								/*if(tmp[key].status.self.add==true){
									value.icon_self = 1;
									value.name_self = 1;
								}else{
									value.icon_self = 0;
									value.name_self = 0;
								}*/

								if(tmp[key].status.friend.approve==false){
									value.checklist_addfriend = true;
								}else{
									value.checklist_addfriend = false;
								}

								if(tmp[key].status.follow==false){
									value.icon_follow = true;
									value.name_follow = true;
									value.checklist_follow = true;
								}else{
									value.icon_follow = false;
									value.name_follow = false;
								}

								vm.list_user_self.push(value);
								
							});
							vm.isloading_self = false;
							var offset_next = offset + 10;
							getList_self_next(keyword, limit, offset_next);
						},
						function(response){//err callback
							// console.log(response);
						}
					);
				}
			}

			vm.tab_selected = 1;

			function action_tab_selected(id){
				vm.tab_selected = id;
			}

			vm.action_tab_selected = action_tab_selected;
			vm.search_friend = false;

			function action_search_friend(){
				vm.search_friend = true;
				if(vm.tab_selected==1){
					vm.button_show_more_self = false;
					vm.start_user_self = false;
					vm.list_user_self = [];
					var searchfield = (vm.searchfield) ? vm.searchfield : "";
					getList_self(searchfield, 10, 0);
				}else{
					vm.button_show_more = false;
					vm.start_user = false;
					vm.list_user = [];
					var searchfield = (vm.searchfield) ? vm.searchfield : "";
					getList(searchfield, 10, 0, vm.user_id);
				}
			}

			vm.action_search_friend = action_search_friend;

			function action_check_me_self(username){
				//alert(username);
				$state.go('profile', {user: username});
			}

			function showModalEditTitle() {
				angular.element('#ModalEditTitle').addClass('-open');
				angular.element('body').css('overflow', 'hidden');
			}

			vm.showModalEditTitle = showModalEditTitle;

			function showModalEditUsername() {
				angular.element('#ModalEditUsername').addClass('-open');
				angular.element('body').css('overflow', 'hidden');
			}

			vm.showModalEditUsername = showModalEditUsername;

			function showModalEditAboutMe() {
				angular.element('#ModalEditMe').addClass('-open');
				angular.element('body').css('overflow', 'hidden');
				vm.edit_first_name = vm.first_name;
				vm.edit_middle_name = vm.middle_name;
				vm.edit_last_name = vm.last_name;
				vm.edit_place_of_birth = vm.place_of_birth;
				//window.scrollTo(0, 0);
				setTimeout(function() {
					$("html, body").animate({ scrollTop: 0 }, 100);
				}, 0);
			}

			vm.showModalEditAboutMe = showModalEditAboutMe;

			function showModalEditWebsite() {
				angular.element('#ModalEditWebsite').addClass('-open');
				angular.element('body').css('overflow', 'hidden');
			}

			vm.showModalEditWebsite = showModalEditWebsite;

			function showModalEditUsername() {
				angular.element('#ModalEditUsername').addClass('-open');
				angular.element('body').css('overflow', 'hidden');
			}

			vm.showModalEditUsername = showModalEditUsername;

			function openEditBadge() {
				angular.element('.badge-edit').addClass('active');
			}

			vm.openEditBadge = openEditBadge;

			function closeEditBadge() {
				angular.element('.badge-edit').removeClass('active');
				if(vm.edit_choice_badge) {
					vm.listBadge();
					vm.edit_choice_badge=false;
				}
			}

			vm.closeEditBadge = closeEditBadge;

			function showModalAddBadge() {
				angular.element('#ModalAddBadge').addClass('-open');
				angular.element('body').css('overflow', 'hidden');
			}

			vm.showModalAddBadge = showModalAddBadge;
			
			function openEditAchievement() {
				vm.open_edit_achievement = true;
				$('#achievement_wrp').animate({scrollLeft: '+='+vm.data_row_width});
				$('.achievement-edit').addClass('active');
				if(!vm.achievement_collect[vm.column_data.length].length) vm.data_row_width += 450;
			}

			vm.openEditAchievement = openEditAchievement;

			function closeEditAchievement() {
				vm.open_edit_achievement = false;
				angular.element('.achievement-edit').removeClass('active');
				$('#achievement_wrp').animate({scrollLeft: '0'},200, function() {
					if(!vm.achievement_collect[vm.column_data.length].length) vm.data_row_width -= 450;
				});
				if(vm.edit_choice_achievement) {
					//vm.listAchievement();
					vm.edit_threshold_achievement = [];
					vm.edit_choice_achievement=false;
					vm.count = 1;
					vm.column = 1;
					vm.column_data = [];
					vm.achievement_pick = [];
					var length = (vm.threshold_achievement.length/6)+1;
					for(var i=1;i<=length;i++) {
						vm.achievement_collect[i]=[];
					}
					vm.column_data.push({"column":0});
					angular.forEach(vm.threshold_achievement,function(value,key){
						vm.edit_threshold_achievement.push({"threshod_id":value.threshod_id,"order":value.order,"name":value.name,"image":value.image});
						vm.achievement_collect[vm.column].push({"threshod_id":value.threshod_id,"order":value.order,"name":value.name,"image":value.image});
						vm.achievement_pick[value.threshod_id] = true;
						if(vm.count%6==0) {
							vm.column_data.push({"column":vm.column});
							vm.column++;
						}
						vm.order_achievement++;
						vm.count++;
					});
					vm.data_row_width = 0;
					vm.data_row_width = 450*(vm.column_data.length);
					if(!vm.achievement_collect[vm.column_data.length].length) vm.data_row_width -= 450;
					console.log(vm.column_data.length);
				}
			}

			vm.closeEditAchievement = closeEditAchievement;

			function showModalAddAchievement() {
				angular.element('#ModalAddAchievement').addClass('-open');
				angular.element('body').css('overflow', 'hidden');
			}

			vm.showModalAddAchievement = showModalAddAchievement;

			vm.saveChoiceAchievement = function() {
				vm.list_choice_achievement="";
				var user_threshold = [];
				var order = 1;
				angular.forEach(vm.edit_threshold_achievement,function(value,key){
					user_threshold.push({"threshod_id":value.threshod_id,"order":order});
					order++;
				});
				ProfileService.saveChoiceAchievement(user_threshold, function(response) {
					vm.edit_choice_achievement=false;
				});
				angular.element('.achievement-edit').removeClass('active');

				vm.data_row_width = 0;
				vm.data_row_width = 450*(vm.column_data.length);
				if(!vm.achievement_collect[vm.column_data.length].length) vm.data_row_width -= 450;
				$('#achievement_wrp').animate({scrollLeft: '0'});
			}

			vm.saveChoiceBadge = function() {
				ProfileService.saveChoiceBadge(vm.user_threshold_badge, function(response) {
					vm.edit_choice_badge=false;
				});
				angular.element('.badge-edit').removeClass('active');
			}

			function showModalEditSocialMedia() {
				angular.element('#ModalEditSocialmedia').addClass('-open');
				angular.element('body').css('overflow', 'hidden');
			}

			vm.loading_aboutme = false;

			vm.updateUserFilter = function() {
				if(!vm.edit_first_name) {vm.edit_first_name = "-";}
				if(!vm.edit_middle_name) {vm.edit_middle_name = "-";}
				if(!vm.edit_last_name) {vm.edit_last_name = "-";}
				var updated_filter = [{"filter_id":2,"filter_value" : vm.edit_first_name},{"filter_id":3,"filter_value" : vm.edit_middle_name},{"filter_id":4,"filter_value" : vm.edit_last_name}];
				var type = 2;
				SettingService.updateUserFilter(updated_filter, type).then(function(data) {
					vm.first_name = vm.edit_first_name.replace('-','');
					vm.middle_name = vm.edit_middle_name.replace('-','');
					vm.last_name = vm.edit_last_name.replace('-','');
				});
				if(vm.edit_date_of_birth) {
					var date = vm.edit_date_of_birth.split('/');
					date = date[1]+'/'+date[0]+'/'+date[2];
					var newdate = new Date(date);
					var ms = newdate.valueOf();
					var s = ms / 1000;
					vm.timestamp = s;
					var updated_filter = [{"filter_id":6,"filter_value" : vm.timestamp}];
					SettingService.updateUserFilter(updated_filter, type).then(function(data) {
						var date = new Date(vm.timestamp * 1000);
                        var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
                        vm.date_of_birth = date.getDate() + " " + months[date.getMonth()] + " " + date.getFullYear();
					});
				}
				if(vm.edit_nationality) {
					var updated_filter = [{"filter_id":8,"filter_value" : vm.edit_nationality}];
					SettingService.updateUserFilter(updated_filter, type).then(function(data) {
						vm.nationality = vm.edit_nationality;
					});
				}
				if(vm.place_birth) {
					var updated_filter = [{"filter_id":7,"filter_value" : vm.place_birth}];
					SettingService.updateUserFilter(updated_filter, type).then(function(data) {
						vm.place_of_birth = vm.edit_place_of_birth;
					});
				}
				
			}

			vm.saveTitle = function() {
				var type = 2;
				var updated_filter = [{"filter_id":520,"filter_value" : vm.edit_title}];
				// console.log(updated_filter);
				SettingService.updateUserFilter(updated_filter, type).then(function(data) {
					vm.title = vm.edit_title;
					// console.log('update title');
					// console.log(response);
				});
			}

			//vm.saveWebsite();

			vm.prefixPhoneNumber = function() {
				var limit=500;
	            var offset=0;
	            SettingService.prefixPhoneNumber(limit, offset).then(function(data) {
	                //// console.log(response.data.c.data.content.list_prefix_phone_number);
	                vm.list_prefix_phone_number = data.content.list_prefix_phone_number;
	                vm.list_nationality = data.content.list_prefix_phone_number;
	            });
			}

			vm.prefixPhoneNumber();

			vm.selectNationality = function($event) {
			    if($event.keyCode === 40) {
					$event.preventDefault();
					vm.list_nationality.next();
				} else if($event.keyCode === 38) {
					$event.preventDefault();
					vm.list_nationality.prev();
				} else if($event.keyCode === 13) { 
					vm.selectNationality(vm.list_nationality.list[vm.list_nationality.selectedIndex]);
				}
			}

			vm.setNationality = function(value, image, index) {
	            vm.nationality_name = value;
	            vm.nationality_image = image;
	            vm.edit_nationality = index;
	        }

	        vm.searchCities= function() {
	        	var keyword = vm.edit_place_of_birth;
	        	if(keyword) {
	        		angular.element('._listplace').addClass('active');
	        	} else {
	        		angular.element('._listplace').removeClass('active');
	        	}
	        	// vm.list_place = [{list:null}];
	        	// vm.list_place.list = [];
	        	ProfileService.listCities(keyword, 0, function(response) {
	        		vm.list_place.list = response.data.c.data.content.list_cities;
	        		// console.log('search cities');
	        		// console.log(response);
	        	});
	        }

	        vm.getCities= function(country_id) {
	        	ProfileService.listCities(null, country_id, function(response) {
	        		vm.list_place = response.data.c.data.content.list_cities;
	        		// console.log('get cities');
	        		// console.log(response);
	        	});
	        }

	        vm.hideListPlace = function() {
	        	angular.element('._listplace').removeClass('active');
	        }

			vm.showModalEditSocialMedia = showModalEditSocialMedia;

			vm.iconbox = false;

			function showIconSocialMedia() {
				if(vm.iconbox == false) {
					angular.element('._addpopup').addClass('active');
					vm.iconbox = true;
				} else {
					angular.element('._addpopup').removeClass('active');
					vm.iconbox = false;
				}
			}

				vm.showIconSocialMedia = showIconSocialMedia;

				function chooseSocialMedia(value) {
								vm.choose_social_media = value;
						}

						vm.chooseSocialMedia = chooseSocialMedia;

						function listSocialMedia(){
							vm.edit_social_media = [];
							SettingService.listSocialMedia().then(function(data) {
								vm.list_social_media = data.content.data[0];
								angular.forEach(vm.list_social_media,function(value,key){
									vm.edit_social_media.push({"id":value.id,"name":value.name.replace('Path','path-01'),"value":value.value});
								});
								if(!vm.list_social_media.length) vm.social_media_null=true;
							});
						}

						vm.listSocialMedia = listSocialMedia;

						vm.choose_social_media='clear';

						function addSocialMedia() {
							var name;
							if(vm.choose_social_media==0) {
								name = 'facebook';
								vm.facebook = vm.account_social_media;
							}
							if(vm.choose_social_media==1) {
								name = 'twitter';
								vm.twitter = vm.account_social_media;
							}
							if(vm.choose_social_media==2) {
								name = 'instagram';
								vm.instagram = vm.account_social_media;
							}
							if(vm.choose_social_media==7) {
								name = 'path-01';
								vm.path = vm.account_social_media;
							}
							if(vm.choose_social_media==8) {
								name = 'pinterest';
								vm.pinterest = vm.account_social_media;
							}
							vm.edit_social_media.push({"id":null,"name":name,"value":vm.account_social_media});
							vm.choose_social_media = 'clear';
							vm.account_social_media = '';
						}

						vm.addSocialMedia = addSocialMedia;

						vm.saveSocialMedia = function() {
							if(vm.account_social_media) vm.addSocialMedia();
							for(var i=0;i<vm.delete_account_sosialmedia.length;i++) {
								vm.removeSocialMedia(vm.delete_account_sosialmedia[i].id);
							}
							angular.forEach(vm.edit_social_media,function(value,key){
								if(!value.id) {
									var type;
									if(value.name == 'facebook') type = 0;
									if(value.name == 'twitter') type = 1;
									if(value.name == 'instagram') type = 2;
									if(value.name == 'path-01') type = 7;
									if(value.name == 'pinterest') type = 8;
									console.log('type : '+type);
									console.log(value.name);
									var val=value.value.split('.com/');
									if(val[1] != undefined) {
										var value = val[1];
									} else {
										var value = val[0];
									}
									SettingService.addSocialMedia(type, value).then(function(data) {
										vm.account_social_media = "";
										vm.list_social_media = [];
										angular.forEach(vm.edit_social_media,function(value,key){
											vm.list_social_media.push({"id":value.id,"name":value.name,"value":value.value});
										});
									});
								}
							});
							vm.social_media = null;
							console.log(vm.list_social_media);
						}

						vm.delete_account_sosialmedia = [];

						function deleteSocialMedia(name,id) {
							if(name == 'facebook') vm.facebook = null;
							if(name == 'twitter') vm.twitter = null;
							if(name == 'instagram') vm.instagram = null;
							if(name == 'path-01') vm.path = null;
							if(name == 'pinterest') vm.pinterest = null;
							for(var i = 0; i < vm.edit_social_media.length; i++) {
								if(vm.edit_social_media[i]['name']==name) {
							    	delete vm.edit_social_media[i];
							    }
							}
							if(id) {
								vm.delete_account_sosialmedia.push({"id":id});
							}
							vm.temp_social_media = vm.edit_social_media;
							vm.edit_social_media = [];
							angular.forEach(vm.temp_social_media,function(value,key){
								vm.edit_social_media.push({"id":value.id,"name":value.name,"value":value.value});
							});
							vm.account_social_media = "";
						}

						vm.deleteSocialMedia = deleteSocialMedia;

						vm.removeSocialMedia = function(id) {
							SettingService.deleteSocialMedia(id).then(function(data) {
								vm.list_social_media = [];
								angular.forEach(vm.edit_social_media,function(value,key){
									vm.list_social_media.push({"id":value.id,"name":value.name,"value":value.value});
								});
								vm.social_media = null;
							});
						}

						function showAlert(title, content, event) {
							$mdDialog.show(
							$mdDialog.alert()
								.clickOutsideToClose(true)
								.title(title)
								.textContent(content)
								.ariaLabel('Alert Dialog')
								.ok('Got it!')
								.targetEvent(event)
							);
						}
						vm.showAlert = showAlert;

				angular.extend(vm,{
					loadTimeline:loadTimeline,
					js_timeline:[],
					load_more:false
				});
				

				function loadTimeline(idx){
					if(!vm.isSearching){
						vm.isSearching=true;
						if(idx==undefined){
							idx = 0;vm.load_more = true;
						}
						var last_array = vm.js_timeline[vm.js_timeline.length-1];
					PostService.timelineUser ($stateParams.user,idx,3,vm.lastId,function(response){
				//				// console.log(response.data.c.data.content.posts);
						var tmp=response.data.c.data.content.posts;
						var last_array = vm.js_timeline[vm.js_timeline.length-1];
						angular.forEach(tmp,function(value,key){
							value.activity_detail.avatar_url=value.user_avatar.face;
							value.activity_detail.back_hair=value.user_avatar.back_hair;
			//				value.place.url='https://www.google.com/maps/preview/@'+value.place.place_lat+','+value.place.place_long+',8z';
							value.view='normal';
							value.login_id=vm.token_user_id;
							vm.js_timeline.push(value);
						last_array = value;
					});
					if(last_array){
						vm.lastId = last_array.post_id;
					}
					
						
						vm.isSearching=false;
						vm.load_more=false;
						if (response.data.c.data.meta.current_page<response.data.c.data.meta.last_page) {
						vm.load_more = true;
					} else {
						vm.load_more = false;
					}
//					if(tmp.length==0){
//						vm.load_more=false;
//					}
					},function(response){
						// console.log(response);
						vm.isSearching=false;
					});
				}
				}
		$rootScope.$on('card.delete', function (event, post) {
			PostService.deletePost(post.post_id, function (response) {
				var data = response.data.c.data;
				if (data.error == false) {
					vm.js_timeline.splice(vm.js_timeline.indexOf(post), 1);
					modalFactory.message(data.message);
				} else {
					modalFactory.message(data.message);
				}
			}, function (response) {});
		});

		vm.list_user=[];
		vm.list_user_next=[];
		vm.start_user = false;
		vm.searchtext = '';//$stateParams.search_text;

		vm.pagelist = 1;
	
		vm.isloading = false;
		vm.loading_show_more = false;

		function loadMoreRecords(){

				vm.loading_show_more = true;
				//vm.pagelist++;
				//vm.offset = (vm.pagelist - 1) * 6;
				getList(vm.searchtext, 10, vm.list_user.length, vm.user_id);
		
		}

		vm.loadMoreRecords = loadMoreRecords;

		function getList_next(keyword, limit, offset, user_id){
			
			ConnectionService.listMutualFriends (
				keyword, limit, offset, user_id,
				function(response){//callback sucess
					// // console.log(response.data.c.data.content);
					//vm.list_user = response.data.c.data.content.list_user;
			
					var tmp_next=(response.data.c.data.content.list_user);

					vm.start_user = true;
					angular.forEach(tmp_next,function(value,key){
						vm.list_user_next.push(value);
					});

					//// console.log(tmp_next.length);
					vm.loading_show_more = false;
					if(tmp_next==undefined || tmp_next.length==0){
						vm.button_show_more = false;
					}else{
						vm.button_show_more = true;
					}


					
				},
				function(response){//err callback
					// console.log(response);
				}
			);
		
		}

		function getList(keyword, limit, offset, user_id){
			if(!vm.isloading){
				//// console.log('test');
				vm.isloading = true;
				ConnectionService.listMutualFriends (
					keyword, limit, offset, user_id,
					function(response){//callback sucess
						// console.log(response.data.c.data.content);
						//vm.list_user = response.data.c.data.content.list_user;
						var tmp=(response.data.c.data.content.list_user);
						try {vm.tmp_count=(response.data.c.data.meta.total)}catch(err){}
						vm.start_user = true;
						angular.forEach(tmp,function(value,key){

							value.icon_action_response = false;
							value.open_action = false;


									if(vm.token_user_id==tmp[key].user_id){
										value.button_self = true;
									}else{
										value.button_self = false;
									}
							
							if(tmp[key].status.friend.add==false){
								value.icon_addfriend = true;
								value.name_addfriend = true;
								value.icon_self = 0;
								value.name_self = 0;
							}else{
								
								if(tmp[key].status.friend.addstatus==false){
									if(tmp[key].status.friend.approve==true){
										value.icon_addfriend = false;
										value.name_addfriend = false;
										value.icon_self = 0;
										value.name_self = 0;
									}else{
										value.icon_addfriend = true;
										value.name_addfriend = true;
										value.icon_self = 1;
										value.name_self = 1;
									}
								}else{
									value.icon_addfriend = false;
									value.name_addfriend = false;
									value.icon_self = 0;
									value.name_self = 0;
								}
							}

							/*if(tmp[key].status.self.add==true){
								value.icon_self = 1;
								value.name_self = 1;
							}else{
								value.icon_self = 0;
								value.name_self = 0;
							}*/

							if(tmp[key].status.friend.approve==false){
								value.checklist_addfriend = true;
							}else{
								value.checklist_addfriend = false;
							}

							if(tmp[key].status.follow==false){
								value.icon_follow = true;
								value.name_follow = true;
								value.checklist_follow = true;
							}else{
								value.icon_follow = false;
								value.name_follow = false;
							}
							vm.list_user.push(value);
							
						});
						vm.isloading = false;
						vm.isSearching_hidden++;
						var offset_next = offset + 10;
						getList_next(keyword, 10, offset_next, vm.user_id);
					},
					function(response){//err callback
						// console.log(response);
					}
				);
			}
		}

		var friend = $rootScope.$on(
            "friend.profile",
            function(event, data) {
            	angular.forEach(vm.list_user_self,function(value,key){
					vm.list_user_self[key].open_action = false;
				});
            }
        );

        var mutual_friend = $rootScope.$on(
            "mutual_friend.profile",
            function(event, data) {
            	angular.forEach(vm.list_user,function(value,key){
					vm.list_user[key].open_action = false;
				});
            }
        );		

		vm.scrollOffset = 200;
		function scroll(){
			$('#loadingMoreIcon').hide();
			vm.isLoadMore = false;
			$('.achievement').scroll(function(){
				var scrollTop = $(this).scrollTop();
				if(scrollTop >= vm.scrollOffset && !vm.isLoadMore){
					vm.isLoadMore = true;
					$('#loadingMoreIcon').show();
					loadMore();
				}
			});
		}

		function loadMore() {
			vm.offset += 20;
			vm.scrollOffset += 200;
			loadAchievement();
		}
	}
})();
;
(function() {
'use strict';

	angular
		.module('app')
		.controller('ProfilePublicController', ProfilePublicController);

	ProfilePublicController.$inject = ['$rootScope', '$cookieStore', '$state', 'CiayoService','$stateParams','ProfileService', 'CiayoBanner', 'SettingService', 'PostService'];
	function ProfilePublicController($rootScope, $cookieStore, $state, CiayoService,$stateParams,ProfileService, CiayoBanner, SettingService, PostService) {
		var vm = this;
		vm.profile_url="views/profile-public.html";
		vm.aboutme = false;
		vm.social_media_loading = false;

		var user = $stateParams.user;
		vm.profile = [];

		vm.init=function(){

			// if($cookieStore.get('token')){
			// 	$state.go('profile', {user: $stateParams.user});
			// }

			vm.state=0;

			// get data profile
			ProfileService.userInfoPublic ($stateParams.user,function(response){
				
				vm.aboutme = true;
				vm.social_media_loading = true;
				vm.social_media = true;
			
				var data = response;
				//console.log(data);

				var tmp={};
				angular.forEach(data.profile,function(value_new,key){
				 	tmp[value_new.filter_id]=value_new;
				});	

				vm.user_id = data.user_id;

				vm.profile.full_name = 
				(tmp[2]==undefined?'':tmp[2].value)+ ' ' +
				(tmp[3]==undefined?'':tmp[3].value)+ ' ' +
				(tmp[4]==undefined?'':tmp[4].value);

				vm.profile.user_display_name = tmp[5].value;
				vm.profile.title = (tmp[520]==undefined?'No title':tmp[520].value);
				vm.profile.user_avatar = data.user_avatar.avatar;
				vm.profile.user_first_name = (tmp[2]==undefined?'':tmp[2].value);
				vm.profile.user_middle_name = (tmp[3]==undefined?'':tmp[3].value);
				vm.profile.user_last_name = (tmp[4]==undefined?'':tmp[4].value);
				vm.profile.place_of_birth = (tmp[7]==undefined?'':tmp[7].value);
				vm.profile.nationality = (tmp[8]==undefined?'':tmp[8].value);
				vm.profile.email = data.email;
				vm.profile.phone = data.phone;

				getPlaceDateBirth((tmp[7]==undefined?null:tmp[6].value));
				vm.profile.website = (tmp[37]==undefined?'':tmp[37].value);
				vm.profile.facebook = (tmp[480]==undefined?'':tmp[480].value);
				vm.profile.twitter = (tmp[481]==undefined?'':tmp[481].value);
				vm.profile.instagram = (tmp[482]==undefined?'':tmp[482].value);
				vm.profile.instagram = (tmp[500]==undefined?'':tmp[500].value);

				//vm.listAchievement(vm.user_id);
				vm.choiceAchievement();
				vm.choiceBadge();

				//console.log(vm.profile.user_avatar);

			},function(response){
					if(response.status==200){
						var data = response.data.c.data;
						if(data.error==true){
							//if(data.message=='user_not_found' || data.message=='Akun tidak ditemukan'){
								$state.go('404');
							//}else{
							//	modalFactory.message(data.message);
							//	return;
							//}
						}
					}
			});

			// get data banner
			CiayoBanner.getDataPublic($stateParams.user, "profile", function(response){
				vm.profile.banner = response.data.c.data.content.image;
				//console.log(vm.profile.banner);
				setTimeout(function(){
					$('.c-banner').children("ul").parallax({
						clipRelativeInput: false,
						originY: 0.0
					});
				}, 1)
			}, function(){

			})
		}

		function getPlaceDateBirth(dateBirth){
			if(dateBirth){
				var timestamp = dateBirth;
				var date = new Date(timestamp * 1000);
				var months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
				vm.profile.date_of_birth = date.getDate() + " " + months[date.getMonth()] + " " + date.getFullYear();
				if(vm.profile.place_of_birth && vm.profile.date_of_birth) {
					vm.qoma = ", ";
				} else {
					vm.qoma = "";
				}
			}
		} 

		vm.init();

		vm.prefixPhoneNumber = function() {
			var limit=500;
            var offset=0;
            SettingService.prefixPhoneNumber(limit, offset, function(response) {
                //// console.log(response.data.c.data.content.list_prefix_phone_number);
                vm.list_prefix_phone_number = response.data.c.data.content.list_prefix_phone_number;
                vm.list_nationality = response.data.c.data.content.list_prefix_phone_number;
            });
		}

		
		//vm.prefixPhoneNumber();

		// vm.listAchievement = function(user_id) {
		// 	vm.search_complete = false;
		// 	var orderType = 'name';
		// 	var orderBy = 'asc';
		// 	var limit = 10;
		// 	var offset = 0;
		// 	var search = vm.keyword_achievement;
			
				
		// 	ProfileService.choiceAchievementPublic(username, orderType, orderBy, limit, offset, search, function(response) {
		// 		var list = response.data.c.data.content.data;
		// 		angular.forEach(list,function(value,key){
		// 			if(value.order!=null){
		// 				$('.pickdisabled'+value.id).show();
		// 				$('.pick'+value.id).hide();
		// 				$('.picktext'+value.id).animate({opacity:0.2});
		// 			}
		// 		});
		// 	});
		// 	vm.search_complete = true;
			
		// }

		vm.choiceAchievement = function() {
			vm.list_choice_achievement = "";
			$('.choiceadd').hide();
			
			
			ProfileService.choiceAchievementPublic($stateParams.user, "achievement", function(response) {
				// console.log('List Achievement Choice User');
				// console.log(response);
				vm.list_choice_achievement = response.data.c.data.content.data;
				vm.length_achievement = vm.list_choice_achievement.length;
				vm.user_threshold = [];
				angular.forEach(vm.list_choice_achievement,function(value,key){
					$('.pick'+value['id']).show();
					$('.pickdisabled'+value['id']).hide();
					$('.pick'+value['id']).animate({opacity:1});
					$('.picktext'+value['id']).animate({opacity:1});
					if(value.order!=null){
						vm.user_threshold.push({"threshod_id":value.id,"order":value.order});
					}
				});
				vm.index_data_row=1;
				vm.data_row = [];
				angular.forEach(vm.list_choice_achievement,function(value,key){
					if(value.order!=null){
						vm.data_row.push({"id":value.id,"image":value.image,"name":value.name,"order":value.order});
						$('.pickdisabled'+value.id).show();
						$('.pick'+value.id).hide();
						$('.picktext'+value.id).animate({opacity:0.2});
						var a = Math.round(vm.index_data_row/2) - (vm.index_data_row/2);
						var b = Math.round(vm.index_data_row/2);
						if(a==0) {
							b++;
						}
						vm.data_row_width = b * 150;
						vm.index_data_row++;
					}
				});
				// console.log('choiceAchievement data');
				// console.log(vm.user_threshold);
				vm.carouselActive();
			});
			
		}

		vm.choiceBadge = function() {
			vm.list_choice_badge= "";
			$('.choiceadd').hide();
			
			
			ProfileService.choiceBadgePublic($stateParams.user, "badge", function(response) {
				vm.list_choice_badge = response.data.c.data.content.data;
			});
			
		}

		vm.carouselActive=function(){
			setTimeout(function() {
				$('.c-profile-achievement-carousel').flickity({
					pageDots: false,
					cellAlign: 'left'
				});
			}, 0);

			setTimeout(function() {
				$('.c-profile-badge-carousel').flickity({
					pageDots: false,
					cellAlign: 'left'
				});
			}, 0);
		}

		vm.choiceAchievementLeft = function() {
			$('#achievement_wrp').animate({scrollLeft: '-=150'},200);
		}

		vm.choiceAchievementRight = function() {
			$('#achievement_wrp').animate({scrollLeft: '+=150'},200);
		}		

		vm.login_first = function(){
			$rootScope.$broadcast( "login.header_public", '1');
			//console.log('ok');
		}
	}
})();;
(function () {
	'use strict';
	angular
		.module('app')
		.controller('SampleController', SampleController);
		
	SampleController.$inject = [];
	function SampleController() {
		var me=this;
		me.plx = {
				"activity_id": "2481",
				"name": "Coming Home at Dawn",
				"preview": "https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/c10cce66660f7c9ca069c0d7f9c44cfc3ddbc29c_55x40.png",
				"thumbnail": "https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/c10cce66660f7c9ca069c0d7f9c44cfc3ddbc29c_55x40.png",
				"avatar_url": null,
				"back_hair": null,
				"avatar_size": "0",
				"avatar_rotation": "0",
				"avatar_angle_id": null,
				"avatar_position": {
					"x": 0,
					"y": 0
				},
				"bubble_text_position": {
					"x": 0,
					"y": 0
				},
				"bubble_size": {
					"width": "0",
					"height": "0"
				},
				"image": [{
					"url": "https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/fbb5d292a668f36b088eedc09e93f535b1ae14e0.png",
					"type": "background",
					"layer": "4",
					"index": "0"
				}, {
					"url": "https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/bd61ebf38adfd5ba49f54fd8b672a9b87af4a9e8.png",
					"type": "background",
					"layer": "4",
					"index": "1"
				}, {
					"url": "https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/915e1ca1aad712c5561a3a14eb6e4aad1e4d6651.png",
					"type": "background",
					"layer": "4",
					"index": "2"
				}, {
					"url": "https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/5794fb3fc94119acd2cc97a144de72e049432e5a.png",
					"type": "background",
					"layer": "4",
					"index": "3"
				}]
			};
		me.plx2 = {
				"activity_id": "2481",
				"name": "Coming Home at Dawn",
				"preview": "https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/c10cce66660f7c9ca069c0d7f9c44cfc3ddbc29c_55x40.png",
				"thumbnail": "https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/c10cce66660f7c9ca069c0d7f9c44cfc3ddbc29c_55x40.png",
				"avatar_url": null,
				"back_hair": null,
				"avatar_size": "0",
				"avatar_rotation": "0",
				"avatar_angle_id": null,
				"avatar_position": {
					"x": 0,
					"y": 0
				},
				"bubble_text_position": {
					"x": 0,
					"y": 0
				},
				"bubble_size": {
					"width": "0",
					"height": "0"
				},
				"image": [{
					"url": "https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/fbb5d292a668f36b088eedc09e93f535b1ae14e0.png",
					"type": "background",
					"layer": "4",
					"index": "0"
				}, {
					"url": "https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/bd61ebf38adfd5ba49f54fd8b672a9b87af4a9e8.png",
					"type": "background",
					"layer": "4",
					"index": "1"
				}, {
					"url": "https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/915e1ca1aad712c5561a3a14eb6e4aad1e4d6651.png",
					"type": "background",
					"layer": "4",
					"index": "2"
				}, {
					"url": "https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/5794fb3fc94119acd2cc97a144de72e049432e5a.png",
					"type": "background",
					"layer": "4",
					"index": "3"
				}]
			};
		me.js_timeline = [{"post_id":"427","post_code":"fm0fy3LvBxqsxrLEDvKy9___5k0oW><1HCaE-__1k0oW><beIbAQbWF-__1k0oW><oVfyc=","user_id":"509","user_status":{"friend":{"add":true,"approve":true,"addstatus":true},"follow":true},"user_display_name":"charismapribadi","username":"charismapribadi","user_avatar":{"full_body":{"avatar":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/avatars\/88b27e4f8f4da1084c06ed4d5d886e3a90b82c27_151x108.png","background_avatar":"#FFFFFF"},"face":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/avatars\/aefb4aa69c7eaaef77eea756f47a744ba50d8a30_524x375.png","back_hair":null},"unsubscribe":false,"permission":{"group":0,"category":"public","users":null},"type":"activity","activity_detail":{"activity_id":"125","name":"Cooking Fail","preview":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/post\/0d2e84ae85b4921abac4b498938c76ba660f1fa9_524x375.jpg","image":[{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/035fdba6c4ebb04fa3463db43f670bde8456f5fd_524x375.png"},{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/bfeefa075d35ae02b14183309f3ba469034a60b2_524x375.png"},{"layer":"2","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/bd74da8ac484e95cae2f254b20365b153bf16e6f_524x375.png"}],"avatar_size":"0","avatar_rotation":"0","avatar_angle_id":null,"avatar_position":{"x":0,"y":0},"bubble":false,"bubble_text_position":{"x":0,"y":0},"bubble_size":{"width":"0","height":"0"},"activity_title":"charismapribadi can not cook AT ALL!","caption":null,"caption_buble":false},"filter":null,"ads_content":null,"reference_id":null,"reference_detail":null,"comment_count":0,"comment_detail":[],"reaction":{"post_id":"427","user_react":null,"detail":{"most":null,"count":0,"text":null}},"shared_count":0,"with_status":{"value":"-1","clickable":true},"with_user_count":0,"with_user":null,"items_detail":{"product_count":0,"brand_count":0,"items":[]},"place_status":{"value":"-1","clickable":true},"place":null,"enable_comment":true,"generated_image_url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/post\/download\/8481cf3bb399eabcb47c1cb3648ddc08d4999afd_524x524.jpg","created_at":1468399687,"updated_at":1468399687},{"post_id":"426","post_code":"qchQsAGNmKopLwogMU01pfTHVXz8SucYN___5k0oW><DDBQcaQQ0=","user_id":"509","user_status":{"friend":{"add":true,"approve":true,"addstatus":true},"follow":true},"user_display_name":"charismapribadi","username":"charismapribadi","user_avatar":{"full_body":{"avatar":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/avatars\/88b27e4f8f4da1084c06ed4d5d886e3a90b82c27_151x108.png","background_avatar":"#FFFFFF"},"face":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/avatars\/d013cefb6b5733c7232da12bda8d0438d5b47328_524x375.png","back_hair":null},"unsubscribe":false,"permission":{"group":0,"category":"public","users":null},"type":"activity","activity_detail":{"activity_id":"125","name":"Cooking Fail","preview":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/post\/0d2e84ae85b4921abac4b498938c76ba660f1fa9_524x375.jpg","image":[{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/035fdba6c4ebb04fa3463db43f670bde8456f5fd_524x375.png"},{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/bfeefa075d35ae02b14183309f3ba469034a60b2_524x375.png"},{"layer":"2","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/bd74da8ac484e95cae2f254b20365b153bf16e6f_524x375.png"}],"avatar_size":"0","avatar_rotation":"0","avatar_angle_id":null,"avatar_position":{"x":0,"y":0},"bubble":false,"bubble_text_position":{"x":0,"y":0},"bubble_size":{"width":"0","height":"0"},"activity_title":"charismapribadi might as well start cooking poison. Food is so bad!","caption":"GAGAL","caption_buble":false},"filter":null,"ads_content":null,"reference_id":null,"reference_detail":null,"comment_count":0,"comment_detail":[],"reaction":{"post_id":"426","user_react":null,"detail":{"most":null,"count":0,"text":null}},"shared_count":0,"with_status":{"value":"-1","clickable":true},"with_user_count":0,"with_user":null,"items_detail":{"product_count":0,"brand_count":0,"items":[]},"place_status":{"value":"-1","clickable":true},"place":null,"enable_comment":true,"generated_image_url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/post\/download\/b37997c5e841b0c6b871f816f66a09949b247957_524x524.jpg","created_at":1468399652,"updated_at":1468399652},{"post_id":"423","post_code":"LtFrh1L8Z4aJdn9vybe7BNx9C-__1k0oW><672QlJo7ShAe2pMSw=","user_id":"504","user_status":null,"user_display_name":"Sandy Cahya","username":"Sandy-Cahya","user_avatar":{"full_body":{"avatar":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/avatars\/ff0ca332fc9be1f5f0e045d4209ec2cd5690b65f_151x108.png","background_avatar":"#AEDCF6"},"face":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/fdfac8574ee16cfa147c89dc437a09caaea4636b_524x375.png","back_hair":null},"unsubscribe":false,"permission":{"group":0,"category":"public","users":null},"type":"activity","activity_detail":{"activity_id":"2481","name":"Coming Home at Dawn","preview":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/post\/140c4010d0a8849ebc5513a0ec0a5ef7a4af5fc4_524x375.jpg","image":[{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/fbb5d292a668f36b088eedc09e93f535b1ae14e0_524x375.png"},{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/bd61ebf38adfd5ba49f54fd8b672a9b87af4a9e8_524x375.png"},{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/915e1ca1aad712c5561a3a14eb6e4aad1e4d6651_524x375.png"},{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/5794fb3fc94119acd2cc97a144de72e049432e5a_524x375.png"}],"avatar_size":"0","avatar_rotation":"0","avatar_angle_id":null,"avatar_position":{"x":0,"y":0},"bubble":false,"bubble_text_position":{"x":0,"y":0},"bubble_size":{"width":"0","height":"0"},"activity_title":null,"caption":null,"caption_buble":false},"filter":null,"ads_content":null,"reference_id":null,"reference_detail":null,"comment_count":0,"comment_detail":[],"reaction":{"post_id":"423","user_react":null,"detail":{"most":null,"count":0,"text":null}},"shared_count":0,"with_status":{"value":"-1","clickable":false},"with_user_count":0,"with_user":null,"items_detail":{"product_count":0,"brand_count":0,"items":[]},"place_status":{"value":"-1","clickable":false},"place":null,"enable_comment":true,"generated_image_url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/post\/download\/8955abd8cbb44d2e6bd3825203da2d9f5bfeef6b_524x524.jpg","created_at":1468398544,"updated_at":1468398544},{"post_id":"419","post_code":"zYOfydnWeCjU6o4qwF8foM6Nhi6iplw2kc1t9igDRY0=","user_id":"510","user_status":{"friend":{"add":true,"approve":true,"addstatus":true},"follow":true},"user_display_name":"hendrafront","username":"hendrafront","user_avatar":{"full_body":{"avatar":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/avatars\/681721fa1de29a4fdbaa262a41360156df4a124b_151x108.png","background_avatar":"#AEDCF6"},"face":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/fdfac8574ee16cfa147c89dc437a09caaea4636b_524x375.png","back_hair":null},"unsubscribe":false,"permission":{"group":0,"category":"public","users":null},"type":"activity","activity_detail":{"activity_id":"1320","name":"Fingerprint Scan","preview":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/post\/6c9a10b7632d95e22048ee3cf6308b51279a50d9_524x375.jpg","image":[{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/03a7faf1cc01f114bcd31ba1c2d864cadbf717e2_524x375.png"},{"layer":"3","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/c3cb54bf60cf72a9cfa030b2d13f258bf05c8185_524x375.png"},{"layer":"2","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/06cc5d22beed0fee6555071a8a17b727a016adbe_524x375.png"}],"avatar_size":"0","avatar_rotation":"0","avatar_angle_id":null,"avatar_position":{"x":0,"y":0},"bubble":false,"bubble_text_position":{"x":0,"y":0},"bubble_size":{"width":"0","height":"0"},"activity_title":"hendrafront's fingerprints are detected.","caption":null,"caption_buble":false},"filter":null,"ads_content":null,"reference_id":null,"reference_detail":null,"comment_count":0,"comment_detail":[],"reaction":{"post_id":"419","user_react":null,"detail":{"most":null,"count":0,"text":null}},"shared_count":0,"with_status":{"value":"1","clickable":true},"with_user_count":0,"with_user":null,"items_detail":{"product_count":0,"brand_count":1,"items":[{"post_item_id":"307","type":"brand","item_id":"54","name":"Uniqlo","image":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/7d615ea871160652425d9c84f9e8fca39b864b04_50x50.png","image_detail":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/brands\/999fd68c2dad745b1ad908ab0eb69db46efee63b_200x200.png","keyword":null}]},"place_status":{"value":"-1","clickable":true},"place":null,"enable_comment":true,"generated_image_url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/post\/download\/cc4a8ead4d7de59d75757c23a42414e68d177711_524x524.jpg","created_at":1468395787,"updated_at":1468395787},{"post_id":"418","post_code":"YCxovv2WU3ZDVg___5k0oW><8y5g8XAUGZ-__1k0oW><1oS6GpDasy527UM9U=","user_id":"516","user_status":{"friend":{"add":true,"approve":true,"addstatus":true},"follow":true},"user_display_name":"donnyfront","username":"Donny-Dragon","user_avatar":{"full_body":{"avatar":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/avatars\/1149059c5f0aaefa8818806713bf889987b95146_151x108.png","background_avatar":"#FCB64E"},"face":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/avatars\/6091edd6bc6b7089787bf4dbae1bd1e74d82b664_524x375.png","back_hair":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/39f30c6c9c1897d9b016f62dffd0f2a4fadb884b_873x623.png"},"unsubscribe":false,"permission":{"group":0,"category":"public","users":null},"type":"activity","activity_detail":{"activity_id":"1426","name":"Afterschool","preview":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/post\/9a6b4330f3c0938ffa44a47475daa6e49493f662_524x375.jpg","image":[{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/b3279ce9112952facb66d4f6e415388906efccc3_524x375.png"},{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/653a93e1116cd7cef61ba2b4179c33faed6aadf4_524x375.png"},{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/65f5a8c41f6747c6800203124df897ec26f988b3_524x375.png"},{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/4205166694ea3496c2cf8490a721292f051130c2_524x375.png"},{"layer":"4","type":"background","color_skin":null,"url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/activities\/f77888a73b772eb93da7fe53ad36299de05f856a_524x375.png"}],"avatar_size":"0","avatar_rotation":"0","avatar_angle_id":null,"avatar_position":{"x":0,"y":0},"bubble":false,"bubble_text_position":{"x":0,"y":0},"bubble_size":{"width":"0","height":"0"},"activity_title":"Donny-Dragon is waiting for this moment to come!\r\n","caption":null,"caption_buble":false},"filter":null,"ads_content":null,"reference_id":null,"reference_detail":null,"comment_count":0,"comment_detail":[],"reaction":{"post_id":"418","user_react":null,"detail":{"most":null,"count":0,"text":null}},"shared_count":0,"with_status":{"value":"-1","clickable":true},"with_user_count":0,"with_user":null,"items_detail":{"product_count":0,"brand_count":0,"items":[]},"place_status":{"value":"-1","clickable":true},"place":null,"enable_comment":true,"generated_image_url":"https:\/\/s3-ap-southeast-1.amazonaws.com\/ciayo\/post\/download\/7fb9c1c17566308c7d110f03261ab5a47352b133_524x524.jpg","created_at":1468395690,"updated_at":1468395690}];
		me.compile = false;
		me.add = function(){
			me.plx2.activity_id+=1;console.log(me.plx2.activity_id);
			me.recompile = true;
		}
	}
})();
;
(function () {
	'use strict';
	angular
		.module('app')
		.controller('ConnectionSearchResult', ConnectionSearchResult)
	;
	
	ConnectionSearchResult.$inject = ['$rootScope','AuthService','CiayoService','ConnectionService','$cookieStore', '$stateParams', '$state', 'ProfileService'];
	function ConnectionSearchResult($rootScope,AuthService, CiayoService,ConnectionService,$cookieStore, $stateParams, $state, ProfileService) {
		var me=this;

		me.list_user=[];
		me.list_user_next=[];
		me.start_user = false;
		me.searchtext = $stateParams.search_text;
		me.pagelist = 1;
		me.isloading = false;
		me.loading_show_more = false;

		ProfileService.userInfo('',function(){
			me.token_user_id = ProfileService.userData.user_id;
			getList(me.searchtext, 10, 0);
			me.loading_show_more = false;
		},function(){

		});

		function loadMoreRecords(){
			me.loading_show_more = true;
			getList(me.searchtext, 10, me.list_user.length);
		}

		me.loadMoreRecords = loadMoreRecords;

		function getList_next(keyword, limit, offset){
			
			ConnectionService.listSearchResult (
				keyword, limit, offset,
				function(response){//callback sucess
					// console.log(response.data.c.data.content);
					//me.list_user = response.data.c.data.content.list_user;
			
					var tmp_next=(response.data.c.data.content.list_user);

					me.start_user = true;
					angular.forEach(tmp_next,function(value,key){
						me.list_user_next.push(value);
					});

					//console.log(tmp_next.length);
					me.loading_show_more = false;
					if(tmp_next.length==0){
						me.button_show_more = false;
					}else{
						me.button_show_more = true;
					}		
				},
				function(response){//err callback
					console.log(response);
				}
			);
		}

		function getList(keyword, limit, offset){
			if(!me.isloading){
				//console.log('test');
				me.isloading = true;
				ConnectionService.listSearchResult (
					keyword, limit, offset,
					function(response){//callback sucess
						//console.log(response.data.c.data.content);
						//me.list_user = response.data.c.data.content.list_user;
						var tmp=(response.data.c.data.content.list_user);

						me.start_user = true;
						angular.forEach(tmp,function(value,key){

							// var new_un = tmp[key].user_full_name;
							// var new_un = new_un.split(" ");

							// var new_full_name = '';
							// for(var i=0; i<=3; i++){
							// 	new_full_name += new_un[i]+" ";
							// }

							// new_full_name += '...';
							// //value.user_full_name = new_full_name;

							
									if(me.token_user_id==tmp[key].user_id){
										value.button_self = true;
									}else{
										value.button_self = false;
									}
									
							value.icon_action_response = false;
							value.open_action = false;
							value.ci_star = false;
							value.ci_check = false;
							
							if(tmp[key].status.friend.add==false){
								value.icon_addfriend = true;
								value.name_addfriend = true;
								value.icon_self = 0;
								value.name_self = 0;
								
								
							}else{
								
								if(tmp[key].status.friend.addstatus==false){
									if(tmp[key].status.friend.approve==true){
										value.icon_addfriend = false;
										value.name_addfriend = false;
										value.icon_self = 0;
										value.name_self = 0;
										
									}else{
										value.icon_addfriend = true;
										value.name_addfriend = true;
										value.icon_self = 1;
										value.name_self = 1;
										
										value.ci_star = true;
									}
								}else{
									value.icon_addfriend = false;
									value.name_addfriend = false;
									value.icon_self = 0;
									value.name_self = 0;
									value.ci_check = true;
								}
							}

							/*if(tmp[key].status.self.add==true){
								value.icon_self = 1;
								value.name_self = 1;
							}else{
								value.icon_self = 0;
								value.name_self = 0;
							}*/

							if(tmp[key].status.friend.approve==false){
								value.checklist_addfriend = true;
							}else{
								value.checklist_addfriend = false;
							}

							if(tmp[key].status.follow==false){
								value.icon_follow = true;
								value.name_follow = true;
								value.checklist_follow = true;
							}else{
								value.icon_follow = false;
								value.name_follow = false;
							}

							
							me.list_user.push(value);
							me.isloading = false;
						});

						me.isSearching_hidden++;
						var offset_next = offset + 10;
						getList_next(keyword, 10, offset_next);
					},
					function(response){//err callback
						console.log(response);
					}
				);
			}
		}

		var friend = $rootScope.$on(
            "friend.search_result",
            function(event, data) {

            	angular.forEach(me.list_user,function(value,key){
					me.list_user[key].open_action = false;
				});
                
            }
        );


	}
	
})();;
(function() {
'use strict';

	angular
		.module('app')
		.controller('SelectMascotController', SelectMascotController);

	SelectMascotController.$inject = ['CiayoService','modalFactory'];
	function SelectMascotController(CiayoService,modalFactory) {
		var vm = this;
		vm.getMascot = getMascot;
		vm.saveMascot = saveMascot;
		vm.dataMascot = [];
		
		function getMascot() {
			var c = {
				data: ''
			};
			CiayoService.Api('mascot', c, function(response){
				if(response.status == 200){
					var data = response.data.c.data.content.data;
					vm.dataMascot = data;
				} else {
					modalFactory.message('error bro');
				}
			});
		}
		
		vm.getMascot();
		
		function saveMascot() {
			if(vm.mascot != undefined){
				var c = {
					data: {
						media_id_mascot: vm.mascot
					}
				};
				CiayoService.Api('users/mascot', c, function(response){
					if(response.status == 200){
						modalFactory.message(response.data.c.data.message);
					} else {
						modalFactory.message('error bro');
					}
				});
			} else {
				modalFactory.message('pilih dulu mascot nya');
			}
		}
	}
})();;
(function () {
	'use strict';
	angular
		.module('app')
		.directive("toggleSetting", function () {
		return {
			restrict: "A",
			scope: {},
			link: function (scope, elem, attrs) {
				var open = false;
				$(elem).on("click", function () {
					if (!open) {
						$(this).parent().addClass('-open')
						$(this).parent().css("height", $(this).outerHeight() + $(this).siblings('._pane').outerHeight())
						open = true;
					} else {
						$(this).parent().removeClass('-open')
						$(this).parent().removeAttr("style")
						open = false;
					}
				})
			}
		}
		})
		.directive("toggleBlockFriend", function () {
		return {
			restrict: "A",
			link: function (scope, elem, attr) {
				elem.on('click', function (e) {
					e.preventDefault();
					elem.parent().toggleClass('open');
				})
			}
		}
		})
		.directive("showPane", function () {
		return {
			restrict: "A",
			scope: {},
			link: function (scope, elem, attr) {
				elem.on("click", function () {
					elem.parent().css({
						"bottom": 58,
						"overflow": "visible"
					})
				})
			}
		}
		})
		.directive("uiDatepicker", function () {
			return {
				restrict: "A",
				scope: {},
				link: function (scope, elem, attrs) {
					$(elem).datepicker({
						changeMonth: true,
						changeYear: true,
						dayNamesMin: ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'],
						dateFormat: 'dd/mm/yy'
					});
				}
			}
		})
		.filter('spaceless', function () {
			return function (input) {
				if (input) {
					input = input.trim();
					return input.replace(/\s+/g, '-');
				}
			}
		})
		.controller('SettingController', SettingController);

	SettingController.$inject = ['AuthService', 'CiayoService', 'SettingService', '$cookieStore', '$translate', '$mdDialog', '$location', '$state', '$stateParams', '$scope', '$controller', '$filter', 'modalFactory','ProfileService'];
	function SettingController(AuthService, CiayoService, SettingService, $cookieStore, $translate, $mdDialog, $location, $state, $stateParams, $scope, $controller, $filter, modalFactory,ProfileService) {
		var me = this;

		angular.element('body').removeAttr('style');

		function getSettings() {
			SettingService.getSettings().then(function(data) {
				var setting = data.content.list_setting;
				var general = setting.general_setting;
				var email_setting = general.email_setting;
				var edit_account = setting.edit_account;

				me.parallax_view_timeline = general.card_setting.parallax_view;
				me.comment = general.notification_setting.comment;
				me.connection_request = general.notification_setting.connection_request;
				me.reset_password = email_setting.reset_password;
				me.login_failed = email_setting.login_failed;
				me.deactive_account  = email_setting.deactive_account;
				me.delete_account = email_setting.delete_account;
				me.new_features = email_setting.new_features;
				me.login_notification = edit_account.login_notification.value;
				me.email_address = edit_account.email_address.value;
				me.edit_email_address = me.email_address;
				me.verify_status = edit_account.verified;
				me.show_email = edit_account.show_email.value;
				me.show_phone = edit_account.show_phone.value;

				if (me.verify_status == true) {
					me.codeverif = true;
				}
				
				try {
					me.phone = edit_account.phone_number.value.split('-');
					me.prefix_verify = me.phone[0];
					me.phone_number = me.phone[1];
					me.edit_phone_number = me.phone_number;
					me.phone_number_value = edit_account.phone_number.value
				} catch (err) { }
				
				me.language_setting = $cookieStore.get('language').toString();
				me.language = [{ "value": 1, "name": "English (US)" }, { "value": 2, "name": "Indonesia" }];
			},function(response){
                //error
        	});
		}

		if ($stateParams.menu == 'notification') {
			me.style = { 'height': '209px' };
			me.class = 'c-set-gen-list -open';
		}
		if ($stateParams.menu == 'account') {
			if (!me.codeverif) {
				var type = null;
				if ($stateParams.email) {
					type = 'email';
					me.email_address = $stateParams.email;
				}
				if ($stateParams.phone) {
					type = 'phone';
					var number = $stateParams.phone;
					if (number) {
						var phone = number.substr(number.length - 4);
						me.x = "";
						for (var i = 1; i <= number.length - 4; i++) {
								me.x += "X";
						}
						me.phone_number = me.x + phone;
					}
				}
				verifyModal('open', type);
				var code = $stateParams.code;
				if (code) {
					me.code_1 = code.charAt(0);
					me.code_2 = code.charAt(1);
					me.code_3 = code.charAt(2);
					me.code_4 = code.charAt(3);
					sendverifcode();
				}
			} else {
				status = $filter('translate')('$success.verified');
				verifyModal('close', me.verify);
				successModal('open');
				me.code_1 = "";
				me.code_2 = "";
				me.code_3 = "";
				me.code_4 = "";
				me.verify_status = true;
				me.codeverif = true;
				me.codeconfirmmessage = "";
			}
		}

		SettingService.getLanguage().then(function(data) {
			me.language_setting = data.content.language;
			$cookieStore.put('language', data.content.language);
			var lang_code = ['en', 'id'];
			$translate.use(lang_code[data.content.language+1]);
		},function(response){
            //error
    	});

		me.resendEmailCount = 0;
		me.resendPhoneCount = 0;
		me.new_features = true;
		me._phone_number = me.phone_number;
		me.prefix = "62";
		me.prefix_verify = "62";
		me.choose_social_media = 0;
		me.timeline_access_privacy = 'anyone';
		me.message_previlage_privacy = 'anyone';
		me.post_default_privacy = 'anyone';
		me.find_me_privacy = 'anyone';
		me.add_me_privacy = 'anyone';
		me.isPassValidated = false;

		function getFilterUser() {
			SettingService.getFilterUser(null, null).then(function(data) {
				//success
			},function(response){
                //error
        	});
		}

		function setNationality(value, image) {
			me.nationality = value;
			me.nationality_image = image;
		}

		function changePassword(event) {
			if (!me.isPassValidated) {
				var status = $filter('translate')('$password.not.valid');
				modalFactory.message(status);
			} else {
				var old_password = me.old_password;
				var new_password = me.new_password;
				var confirm_new_password = me.confirm_new_password;
				SettingService.changePassword(old_password, new_password, confirm_new_password).then(function(data) {
					var status = data.message;
					modalFactory.message(status);
					me.old_password = "";
					me.new_password = "";
					me.confirm_new_password = "";
				},function(response){
                	//error
        		})
			}
		}

		function setTimelineAccessPrivacy(value) {
			me.timeline_access_privacy = value;
		}

		function setMessagePrevilagePrivacy(value) {
			me.message_previlage_privacy = value;
		}

		function setPostDefaultPrivacy(value) {
			me.post_default_privacy = value;
		}

		function setFindMePrivacy(value) {
			me.find_me_privacy = value;
		}

		function setAddMePrivacy(value) {
			me.add_me_privacy = value;
		}

		function confirmDeactive(event) {
			var status = $filter('translate')('$deactive.account?');
			modalFactory.confirm(
				status,
				function (response) {
					if (response) {
						var deactive = true;
						SettingService.userDeactive(deactive).then(function(data) {
							modalFactory.message(data.message);
							setTimeout(function () {
								$cookieStore.remove('token');
								$cookieStore.remove('active');
								ProfileService.userData = null;
								angular.element('#ui-datepicker-div').remove();
								$state.go('welcome');
							}, 2000);
						},function(response){
                          //error
        				})
					}
				}
			);
		}

		function userDeactive(event) {
			var deactive = true;
			SettingService.userDeactive(deactive).then(function(data) {
				showAlert('User Deactive', data.message, event);
			},function(response){
                //error
        	})
		}

		function confirmDelete(event) {
			var status = $filter('translate')('$delete.account?');
			modalFactory.confirm(
				status,
				function (response) {
					if (response) {
						SettingService.confirmDelete().then(function(data) {
							modalFactory.message(data.message);
						},function(response){
			                //error
			            })
					}
				}
			);
		}

		function userDelete(event) {
			SettingService.deleteAccount($stateParams.token).then(function(data) {			
				if (data.error) {
					modalFactory.message(data.message);
				} else {
					modalFactory.message(data.message);
					setTimeout(function () {
						$cookieStore.remove('token');
						angular.element('#ui-datepicker-div').remove();
						$state.go('welcome');
					}, 2500);
				}
			},function(response){
            	//error
       		})
		}

		if ($stateParams.menu == 'delete' && $stateParams.token) {
			userDelete();
		}

		function updateEmail() {
			var email = me.edit_email_address;
			SettingService.updateEmail(email).then(function(data) {
				modalFactory.message(data.message);
				if (data.error == false) {
					var email = me.edit_email_address;
					SettingService.updateResendEmail(email).then(function(data) {
						me.verify_status = false;
						me.codeverif = false;
					},function(response){
            			//error
        			})
				}
			},function(response){
            	//error
        	})
		}

		function updatePhone() {
			var phone_number = me.prefix + "-" + me.edit_phone_number;
			SettingService.updatePhone(phone_number).then(function(data) {
				modalFactory.message(data.message);
				if (data.error == false) {
					me.prefix = me.prefix.replace('+', '');
					me.phone_number = me.phone_number;
					var phone_number = me.prefix_verify + "-" + me.phone_number;
					SettingService.updateResendPhone(phone_number).then(function(data) {
						me.prefix = me.prefix.replace('+', '');
						me.verify_status = false;
						me.codeverif = false;
					},function(response){
		                //error
		            })
				}
			},function(response){
            	//error
        	})
		}

		function saveAccountSetting() {
			if (me.edit_email_address && me.email_change) {
				updateEmail();
			}
			if (me.edit_phone_number && me.phone_change) {
				updatePhone();
			}
			modalFactory.message($filter('translate')('$success.change.profile'));
		}

		function prefixPhoneNumber(limit, offset) {
			var limit = 500;
			var offset = 0;
			SettingService.prefixPhoneNumber(limit, offset).then(function(data) {
				me.list_prefix_phone_number = data.content.list_prefix_phone_number;
				me.list_nationality = data.content.list_prefix_phone_number;
			},function(response){
            	//error
        	})
		}

		function setPrefixPhoneNumber(img, prefix) {
			me.image_prefix = img;
			me.prefix = prefix.replace('+', '');;
			phone_number.focus();
		}

		function setPrefixPhoneVerify(img, prefix) {
			me.image_prefix_verify = img;
			me.prefix_verify = "+" + prefix;
			phone_verify.focus();
		}

		function updateResendEmail() {
			var email = me.update_resend_email;
			SettingService.updateEmail(email).then(function(data) {
				modalFactory.message(data.message);
				angular.element("._foot").css('overflow', 'visible');
				angular.element("._foot").css('overflow', '');
				angular.element("._foot").css('bottom', '8px');
				me.verifyModal('close', me.verify);
				if (data.error == false) {
					me.email_address = me.update_resend_email;
					var email = me.update_resend_email;
					SettingService.updateResendEmail(email).then(function(data) {
						me.verify_status = false;
					},function(response){
            			//error
        			})
				}
			},function(response){
            	//error
        	})
		}

		function updateResendPhone() {
			var phone_number = me.prefix_verify + "-" + me.update_resend_phone;
			SettingService.updatePhone(phone_number).then(function(data) {
				modalFactory.message(data.message);
				angular.element("._foot").css('overflow', '');
				angular.element("._foot").css('bottom', '8px');
				me.verifyModal('close', me.verify);
				if (data.error == false) {
					me.prefix = me.prefix_verify.replace('+', '');
					me.phone_number = me.update_resend_phone;
					var phone_number = me.prefix_verify + "-" + me.update_resend_phone;
					SettingService.updateResendPhone(phone_number).then(function(data) {
						me.prefix = me.prefix_verify.replace('+', '');
						me.phone_number = me.update_resend_phone;
						me.verify_status = false;
					},function(response){
            			//error
        			})
				}
			},function(response){
            	//error
        	})
		}

		function updateLoginNotification(value) {
			value = 1;
			SettingService.updateLoginNotification(value).then(function(response) {
				 //success
            },function(response){
                //error
            })
		}

		function changeLanguage(language_id) {
			$cookieStore.put('language', language_id);
			SettingService.changeLanguage(language_id).then(function(data) {
				//success
            },function(response){
                //error
            })
		}

		var logout_confirm = $filter('translate')('$are.you.sure.logout?');
		function logout(event) {
			modalFactory.confirm(
				logout_confirm,
				function (response) {
					if (response) {
						SettingService.logout().then(function(data) {
							//success
						},function(response){
			                //error
			            })
						$cookieStore.remove('token');
						$cookieStore.remove('gender');
						$cookieStore.remove('language');
						$cookieStore.remove('profile');
						$cookieStore.remove('active');
						$cookieStore.remove('end_tour_create_avatar');
						$cookieStore.remove('end_tour_create_post');
						$cookieStore.remove('end_tour_search_activity');
						angular.element('#ui-datepicker-div').remove();
						$state.go('welcome');
					}
				}
			);
		}

		function restoreDefaultSetting() {
			//restore default setting
		}

		function loginNotification() {
			if (me.login_notification) {
				SettingService.userPreference(1, 'login_notification').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'login_notification').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		function showEmail() {
			if (me.show_email) {
				SettingService.userPreference(1, 'show_email').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'show_email').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		function showPhone() {
			if (me.show_phone) {
				SettingService.userPreference(1, 'show_phone').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'show_phone').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		/* setting social media */
		function listSocialMedia() {
			SettingService.listSocialMedia().then(function(data) {
				me.list_social_media = data.content.data[0];
			},function(response){
                //error
            })
		}

		function chooseSocialMedia(event, value) {
			event.stopPropagation();
			me.choose_social_media = value;
		}

		function clearAccountSocialMedia() {
			event.stopPropagation();
			me.account_social_media = "";
		}

		function clearValueSocialMedia(id) {
			event.stopPropagation();
			me.value_social_media[id] = "";
		}

		function addSocialMedia(event) {
			var type = me.choose_social_media;
			var value = me.account_social_media;
			SettingService.addSocialMedia(type, value).then(function(data) {
				if (data.error == false) {
					var status = $filter('translate')('$success.add.socmed');
				} else {
					var status = data.message;
				}
				showAlert('Ciayo', status, event);
				listSocialMedia();
			},function(response){
                //error
            })
		}

		function updateSocialMedia(id, value, event) {
			SettingService.updateSocialMedia(id, value).then(function(data) {
				if (data.error == false) {
					var status = $filter('translate')('$success.update.socmed');
				} else {
					var status = response.data.c.data.message;
				}
				showAlert('Ciayo', status, event);
				listSocialMedia();
			},function(response){
                //error
            })
		}

		function deleteSocialMedia(id, event) {
			SettingService.deleteSocialMedia(id).then(function(data) {
				if (data.error == false) {
					var status = $filter('translate')('$success.delete.socmed');
				} else {
					var status = data.message;
				}
				showAlert('Ciayo', status, event);
				listSocialMedia();
			},function(response){
                //error
            })
		}

		/* setting general */

		function parallaxViewTimeline() {
			if (me.parallax_view_timeline) {
				SettingService.userPreference(1, 'parallax_view_timeline').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'parallax_view_timeline').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		function notificationTone() {
			if (me.notification_tone) {
				SettingService.userPreference(1, 'notification_tone').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'notification_tone').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		function connectionRequest() {
			if (me.connection_request) {
				SettingService.userPreference(1, 'connection_request').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'connection_request').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		function _comment() {
			if (me.comment) {
				SettingService.userPreference(1, 'comment').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'comment').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		function languageSetting() {
			var language = ['', 'English (US)', 'Indonesia'];
			var lang_code = ['', 'en', 'id'];
			$translate.use(lang_code[me.language_setting]);
			changeLanguage(me.language_setting);
		}

		function resetPassword() {
			if (me.reset_password) {
				SettingService.userPreference(1, 'reset_password').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'reset_password').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		function loginFailed() {
			if (me.login_failed) {
				SettingService.userPreference(1, 'login_failed').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'login_failed').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		function deactiveAccount() {
			if (me.deactive_account) {
				SettingService.userPreference(1, 'deactive_account').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'deactive_account').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		function deleteAccount() {
			if (me.delete_account) {
				SettingService.userPreference(1, 'delete_account').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'delete_account').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		function newFeatures() {
			if (me.new_features) {
				SettingService.userPreference(1, 'new_features').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			} else {
				SettingService.userPreference(0, 'new_features').then(function(data) {
					//success
	            },function(response){
	                //error
	            })
			}
		}

		function showAlert(title, content, event) {
			$mdDialog.show(
			$mdDialog.alert()
				.clickOutsideToClose(true)
				.title(title)
				.textContent(content)
				.ariaLabel('Alert Dialog')
				.ok('Got it!')
				.targetEvent(event)
			);
		}

		function showConfirm(title, content, funct, event) {
			var confirm = $mdDialog.confirm()
				.clickOutsideToClose(true)
				.title(title)
				.textContent(content)
				.ariaLabel('Confirm Dialog')
				.ok($filter('translate')('$yes'))
				.cancel($filter('translate')('$no'))
				.targetEvent(event);
				$mdDialog.show(confirm).then(function () {
				if (funct == 'deactive') {
					userDeactive(event);
				}
				if (funct == 'delete') {
					userDelete(event);
				}
			}, function () {
				// console.log('cancel');
			});
		}

		function verifyModal(event, target) {
			me.codeconfirmmessage = "";
			me.verify = target;
			if (event == 'open') {
			$('#c-modal-custom').hide();
				angular.element('body').addClass('modal-is-open');
			} else {
				$('#c-modal-custom').show();
				angular.element('body').removeAttr('class');
			}
			if (target == 'email') {
				var email_address = me.email_address;
				if(me.verify_status==false && !me.codeverif_email) {
					 SettingService.sendConfirmEmail(email_address).then(function(data) {
						me.codeverif=true;
						me.codeverif_email=true;
					 },function(response){
			            //error
			        })
				}
			}
			if (target == 'phone') {
				var number = me.phone_number;
				if (number) {
					var phone = number.substr(number.length - 4);
					me.x = "";
					for (var i = 1; i <= number.length - 4; i++) {
							me.x += "X";
					}
					me._phone_number = me.x + phone;
				}
				me.prefix = me.prefix.replace('+', '');
				me.phone_number = me.phone_number;
				var phone_number = me.prefix_verify + "-" + me.phone_number;
				console.log(me.verify_status, me.verifmodal);
				if (me.verify_status == false && !me.verifmodal) {
					 SettingService.updateResendPhone(phone_number).then(function(data) {
						 me.prefix = me.prefix.replace('+', '');
						 me.codeverif = true;
						 me.codeverif_phone = true;
					 },function(response){
		                //error
		            })
				}
			}
			me.verifmodal = true;
		}

		function successModal(event) {
			if (event == 'open') {
				angular.element('body').addClass('success-is-open');
			} else {
				angular.element('body').removeClass('success-is-open');
			}
		}

		function sendCodeVerify(type) {
			if (type == "email") {
				me.resendEmailCount++;
				var email = me.email_address;
				SettingService.updateResendEmail(email).then(function(data) {
					me.verify_status = false;
					me.codeverif = false;
					me.codeconfirmmessage = data.message;
				},function(response){
	                //error
	            })
			}
			if (type == "phone") {
				me.resendPhoneCount++;
				var phone_number = me.prefix + "-" + me.phone_number;
				SettingService.updateResendPhone(phone_number).then(function(data) {
					me.prefix = me.prefix.replace('+', '');
					me.verify_status = false;
					me.codeverif = false;
					me.codeconfirmmessage = data.message;
				},function(response){
	                //error
	            })
			}
		}

		function sPr(event) {
			event.stopPropagation();
		}
		me.sPr = sPr;

		function inputCodeKey(id, key) {
			console.log(key);
			if (id == 1 && key != 8 && key != 16 && key != 17 && key != 20 && key != 91 && code_1.value != "") {
				code_2.focus();
			}
			if (id == 2 && key != 8 && key != 16 && key != 17 && key != 20 && key != 91 && code_2.value != "") {
				code_3.focus();
			}
			if (id == 3 && key != 8 && key != 16 && key != 17 && key != 20 && key != 91 && code_3.value != "") {
				code_4.focus();
			}

			if (id == 2 && key == 8 && key != 16 && key != 17 && key != 20 && key != 91 && code_2.value == "") {
				code_1.focus();
			}
			if (id == 3 && key == 8 && key != 16 && key != 17 && key != 20 && key != 91 && code_3.value == "") {
				code_2.focus();
			}
			if (id == 4 && key == 8 && key != 16 && key != 17 && key != 20 && key != 91 && me.code_4 == "") {
				me.code_4 == "";
				code_4.value = "";
				code_3.focus();
			}
		}

		me.inputCodeKey = inputCodeKey;

		function sendcode() {
			if (code_1.value && code_2.value && code_3.value && code_4.value) {
				sendverifcode();
			}
		}

		me.sendcode = sendcode;

		function sendverifcode() {
			me.codeconfirmmessage = "verify account...";
			var confirmation_code = me.code_1 + "" + me.code_2 + "" + me.code_3 + "" + me.code_4;
			SettingService.sendCodeVerify(confirmation_code).then(function(data) {
				me.response_api = true;
				var status = data.error;
				if (status == false) {
					status = $filter('translate')('$success.verified');
					me.codeconfirmmessage = 'Your account has been verified.';
					setTimeout(function () {
						verifyModal('close', me.verify);
						successModal('open');
					}, 2000);
					me.code_1 = "";
					me.code_2 = "";
					me.code_3 = "";
					me.code_4 = "";
					me.verify_status = true;
					me.codeverif = true;
					me.codeconfirmmessage = "";
					me.verify_status = true;
				} else {
					status = $filter('translate')('$code.invalid');
					me.codeconfirmmessage = "<span class='verif-code-error'>" + data.message + "</span>";
				}
					//angular.element('body').removeClass('modal-is-open');
			},function(response){
                //error
            })
		}

		me.sendverifcode = sendverifcode;

		function inputCode(id, event) {
			if (id == 0) {
				var item = event.clipboardData.items[0];
				item.getAsString(function (data) {
					var code = data;
					code_1.value = code.charAt(0);
					code_2.value = code.charAt(1);
					code_3.value = code.charAt(2);
					code_4.value = code.charAt(3);
					me.code_1 = code.charAt(0);
					me.code_2 = code.charAt(1);
					me.code_3 = code.charAt(2);
					me.code_4 = code.charAt(3);
					sendcode();
				});
			}
		}

		function datePickerOff() {
			angular.element('#ui-datepicker-div').remove();
		}

		function validatePassword(id) {
			if (id == 'regOldPassword') {
				var pass = me.old_password;
			}
			if (id == 'regNewPassword') {
				var pass = me.new_password;
			}
			if (id == 'regConfirmPassword') {
				var pass = me.confirm_new_password;
			}
			var len = angular.element('#' + id + ' ul li:first-child .unchecked-circle');
			var char = angular.element('#' + id + ' ul li:last-child .unchecked-circle');

			if (pass.length > 7) {
				len.addClass('active');

				if (pass && pass.match(/^[A-Za-z\d\!\@\#\$\%\^\*\{\[\}\}\:\;\,\.\?\+\-\_\=\~\']{8,}$/)) {
					char.addClass('active');
					me.isPassValidated = true;
				} else {
					char.removeClass('active');
					me.isPassValidated = false;
				}
			} else {
				len.removeClass('active');
				char.removeClass('active');
				me.isPassValidated = false;
			}
		}

		function reactive(){
			SettingService.userActive().then(function(data) {
				$cookieStore.put('active', true);
				$state.go('timeline');
			});
		}

		function logout_reactive(event) {
			$cookieStore.remove('token');
			$cookieStore.remove('gender');
			$cookieStore.remove('language');
			$cookieStore.remove('profile');
			$cookieStore.remove('active');
			$cookieStore.remove('end_tour_create_avatar');
			$cookieStore.remove('end_tour_create_post');
			$cookieStore.remove('end_tour_search_activity');
			angular.element('#ui-datepicker-div').remove();
			$state.go('welcome');		
		}

		var lang_code = ['', 'en', 'id'];
		function changeLang(id) {
				$translate.use(lang_code[id]);
				$cookieStore.put('language', id);
				SettingService.changeLanguage(id, function(response) {
						getLanguage();
				});
		}
		function getLanguage() {
				SettingService.getLanguage(function(response) {
						me.language=lang_code[response.data.c.data.content.language];
						if(response.data.c.data.content.language==1) {
								me.lang_select = "English";
						} else {
								me.lang_select = "Bahasa Indonesia";
						}
				});
		}
		me.getLanguge=getLanguage;
		me.changeLang=changeLang;

		me.validatePassword = validatePassword;

		me.datePickerOff = datePickerOff;
		me.inputCode = inputCode;

		me.verifyModal = verifyModal;
		me.sendCodeVerify = sendCodeVerify;

		me.userDeactive = userDeactive;
		me.confirmDeactive = confirmDeactive;
		me.userDelete = userDelete;
		me.confirmDelete = confirmDelete;
		me.deleteAccount = deleteAccount;
		me.updateEmail = updateEmail;
		me.updatePhone = updatePhone;
		me.saveAccountSetting = saveAccountSetting;
		me.prefixPhoneNumber = prefixPhoneNumber;
		me.setPrefixPhoneNumber = setPrefixPhoneNumber;
		me.setPrefixPhoneVerify = setPrefixPhoneVerify;
		me.updateResendEmail = updateResendEmail;
		me.updateResendPhone = updateResendPhone;
		me.restoreDefaultSetting;

		/* setting social media */
		me.addSocialMedia = addSocialMedia;

		/* setting general */
		me.getSettings = getSettings;
		me.loginNotification = loginNotification;
		me.showEmail = showEmail;
		me.showPhone = showPhone;
		me.parallaxViewTimeline = parallaxViewTimeline;
		me.notificationTone = notificationTone;
		me.connectionRequest = connectionRequest;
		me._comment = _comment;
		me.languageSetting = languageSetting;
		me.changeLanguage = changeLanguage;
		me.resetPassword = resetPassword;
		me.loginFailed = loginFailed;
		me.deactiveAccount = deactiveAccount;
		me.deleteAccount = deleteAccount;
		me.newFeatures = newFeatures;
		me.getFilterUser = getFilterUser;
		me.setNationality = setNationality;
		me.changePassword = changePassword;
		me.setTimelineAccessPrivacy = setTimelineAccessPrivacy;
		me.setMessagePrevilagePrivacy = setMessagePrevilagePrivacy;
		me.setPostDefaultPrivacy = setPostDefaultPrivacy;
		me.setFindMePrivacy = setFindMePrivacy;
		me.setAddMePrivacy = setAddMePrivacy;
		me.listSocialMedia = listSocialMedia;
		me.chooseSocialMedia = chooseSocialMedia;
		me.updateSocialMedia = updateSocialMedia;
		me.deleteSocialMedia = deleteSocialMedia;
		me.clearAccountSocialMedia = clearAccountSocialMedia;
		me.clearValueSocialMedia = clearValueSocialMedia;
		me.successModal = successModal;
		me.reactive = reactive;
		me.logout_reactive = logout_reactive;

		me.logout = logout;
		me.showAlert = showAlert;
		me.showConfirm = showConfirm;
		getFilterUser();
		prefixPhoneNumber();
		getSettings();
		listSocialMedia();	
	}
})();;
(function() {
    'use strict';
    angular
        .module('app')
        .controller('StaticController', SettingController);
    
    SettingController.$inject = ['AuthService', 'CiayoService', 'SettingService', '$cookieStore', '$translate', '$mdDialog', '$location', '$state',  '$stateParams', '$scope', '$controller', '$filter', 'modalFactory'];
    function SettingController(AuthService, CiayoService, SettingService, $cookieStore, $translate, $mdDialog, $location, $state, $stateParams, $scope, $controller, $filter, modalFactory) {
        var me=this;

        me.menu = $stateParams.type;

        function listStaticPages(id) {
            $cookieStore.put('static', id);
            var lang=$cookieStore.get('language');
            SettingService.listStaticPages(id,lang,function(response) {
                me.title = response.data.c.data.content.title;
                me.content = response.data.c.data.content.content;
            });
        }
        listStaticPages($stateParams.type);

        me.listStaticPages=listStaticPages;

        var lang_code = ['', 'en', 'id'];

        function changeLang(id) {
            $translate.use(lang_code[id]);
            $cookieStore.put('language', id);
            var static_id = $cookieStore.get('static');
            SettingService.listStaticPages(static_id,id,function(response) {
                me.title = response.data.c.data.content.title;
                me.content = response.data.c.data.content.content;
            });
            SettingService.changeLanguage(id, function(response) {
                getLanguage();
                var lang=$cookieStore.get('language');
            });
        }

        me.changeLang=changeLang;

        function getLanguage() {
            SettingService.getLanguage(function(response) {
                me.language=lang_code[response.data.c.data.content.language];
                if(response.data.c.data.content.language==1) {
                    me.lang_text = "English";
                } else {
                    me.lang_text = "Bahasa Indonesia";
                }
            });
        }

        me.getLanguage=getLanguage;
        getLanguage();
    }

})();;
(function() {
'use strict';

	angular
		.module('app')
		.controller('StoreController', StoreController);

	StoreController.$inject = ['CiayoService','StoreService','$state','modalFactory','$rootScope'];
	function StoreController(CiayoService, StoreService, $state, modalFactory, $rootScope) {
		var vm = this;
		vm.listPopular = [];
		vm.listContributor = [];
		vm.listFreeNew = [];
		vm.listPremiumNew = [];
		vm.listCategoryItem = [];
		vm.listEmoji = [];
		vm.listLoading = [false,false,false,false,false];
		vm.listLoadMore = [false,false,false,false,false];
		vm.listCategory = [];
		vm.cash = '-';
		vm.coin = '-';
		vm.category = $state.params.category;
		vm.init = init;
		vm.setflickity = setflickity;
		vm.loadList = loadList;
		angular.extend(vm,{
			isLoading:[false,false,false,false,false]
		})
		$rootScope.$on('$stateChangeStart', function(){
			setTimeout(function(){
				initBanner();
			},500);
		});

		function init() {
			$(document).ready(function(){
				setTimeout(function(){
					$("[data-toggle='modal-close']").click(function(e){
						e.preventDefault();
						$('.c-modal.store').removeClass('-open');
					});
					initBanner();
				},1000);
			});
			
			loadBalance();
			bannerHome();
			loadList('popular');
			bannerPremium();
			loadList('premium');
			bannerContributor();
			loadList('contributor');
			bannerFree();
			loadList('free');
			loadList('emoji');
			//loadCategory();
		}

		function initBanner() {
			var banner = $('.store-banner ._container');
			var scroll = 0;
			$('.store-banner ._prev').on('click', function(e){
				e.preventDefault();
				if(scroll > 0){
					scroll -= banner.width();
				}
				banner.animate({
					scrollLeft: scroll
				});
			});

			$('.store-banner ._next').on('click', function(e){
				e.preventDefault();
				if(scroll >= 0 && scroll < (banner.width()*2)){
					scroll += banner.width();
				} else {
					scroll = 0;
				}
				banner.animate({
					scrollLeft: scroll
				});
			});

			setInterval(function(){
				if(scroll >= 0 && scroll < (banner.width()*2)){
					scroll += banner.width();
				} else {
					scroll = 0;
				}
				banner.animate({
					scrollLeft: scroll
				});
			},3000);
		}

		vm.init();

		vm.viewDetail = viewDetail;

		function viewDetail(id, type) {
			vm.itemDetail = null;
			if(id){
				vm.preview = false;
				$('.c-modal.store').addClass('-open');
				var c = {
					data: {
						product_id: id
					}
				};
				if(type==='emoji') {
					CiayoService.Api('ciayoproducts/emoji/detail', c, function(response){
						if(response.status==200){
							//console.log(response.data.c.data.content);
							vm.itemDetail = response.data.c.data.content;
							vm.itemDetail.sticker_item = vm.itemDetail.emoji_item;
						} else {
							console.log('error jow');
						}
					});
				} else {
					CiayoService.Api('ciayoproducts/sticker/detail', c, function(response){
						if(response.status==200){
							//console.log(response.data.c.data.content);
							vm.itemDetail = response.data.c.data.content;
						} else {
							console.log('error jow');
						}
					});
				}
			}
		}

		function loadList(type) {
			if(type == 'popular'){
				if(vm.isLoading[0]==true)return;
				vm.isLoading[0]=true;
				StoreService.getList('1','0','0','9','0','', function(response){
					if(response.status == 200){
						vm.listLoading[0] = true;
						vm.listPopular = response.data.c.data.content.data;
						vm.isLoading[0]=false;
					} else {
						console.log('error popular jaw');
						vm.isLoading[0]=false;
					}
				});
			} else if (type == 'premium') {
				if(vm.isLoading[1]==true)return;
				vm.isLoading[1]=true;
				var offset = vm.listPremiumNew.length;
				StoreService.getList('0','1',offset,'12','0','', function(response){
					if(response.status == 200){
						vm.listLoading[1] = true;
						vm.listPremiumNew = vm.listPremiumNew.concat(response.data.c.data.content.data);
						if(response.data.c.data.content.data.length === 0){
							vm.listLoadMore[1] = true;
						}
						vm.isLoading[1]=false;
					} else {
						console.log('error premium jaw');
						vm.isLoading[1]=false;
					}
				});
			} else if (type == 'contributor') {
				if(vm.isLoading[2]==true)return;
				vm.isLoading[2]=true;
				var offset = vm.listContributor.length;
				StoreService.getList('2','0',offset,'12','0','', function(response){
					if(response.status == 200){
						vm.listLoading[2] = true;
						vm.listContributor = vm.listContributor.concat(response.data.c.data.content.data);
						if(response.data.c.data.content.data.length === 0){
							vm.listLoadMore[2] = true;
						}
						vm.isLoading[2]=false;
					} else {
						console.log('error contributor jaw');
						vm.isLoading[2]=false;
					}
				});
			} else if (type == 'free'){
				if(vm.isLoading[3]==true)return;
				vm.isLoading[3]=true;
				var offset = vm.listFreeNew.length;
				StoreService.getList('0','2',offset,'12','0','', function(response){
					if(response.status == 200){
						vm.listLoading[3] = true;
						vm.listFreeNew = vm.listFreeNew.concat(response.data.c.data.content.data);
						if(response.data.c.data.content.data.length === 0){
							vm.listLoadMore[3] = true;
						}
						vm.isLoading[3]=false;
						setflickity();
					} else {
						console.log('error free jaw');
						vm.isLoading[3]=false;
					}
				});
			} else {
				if(vm.isLoading[4]==true)return;
				vm.isLoading[4]=true;
				var offset = vm.listEmoji.length;
				StoreService.getEmoji(offset,'12', function(response){
					if(response.status == 200){
						vm.listLoading[4] = true;
						vm.listEmoji = vm.listEmoji.concat(response.data.c.data.content.list_emoji);
						if(response.data.c.data.content.list_emoji.length === 0){
							vm.listLoadMore[4] = true;
						}
						setflickity();
						vm.isLoading[4]=false;
					} else {
						console.log('error free jaw');
						vm.isLoading[4]=false;
					}
				});
			}
		}

		function setflickity() {
			setTimeout(function() {
				$('.c-store-carousel').flickity({
					pageDots: false,
					cellAlign: 'left'
				});
			}, 250);
		}

		function bannerHome() {
			var c = {
				data: {
					page: 1,
					offset: 0,
					limit: 3
				}
			}
			CiayoService.Api('ciayoproducts/banner', c, function(response){
				if(response.status == 200){
					vm.listBannerHome = response.data.c.data.content.list_store_banner;
				} else {
					console.log('error banner');
				}
			});
		}

		function bannerPremium() {
			var c = {
				data: {
					page: 2,
					offset: 0,
					limit: 3
				}
			}
			CiayoService.Api('ciayoproducts/banner', c, function(response){
				if(response.status == 200){
					vm.listBannerPremium = response.data.c.data.content.list_store_banner;
				} else {
					console.log('error banner');
				}
			});
		}

		function bannerContributor() {
			var c = {
				data: {
					page: 3,
					offset: 0,
					limit: 3
				}
			}
			CiayoService.Api('ciayoproducts/banner', c, function(response){
				if(response.status == 200){
					vm.listBannerContributor = response.data.c.data.content.list_store_banner;
				} else {
					console.log('error banner');
				}
			});
		}

		function bannerFree() {
			var c = {
				data: {
					page: 4,
					offset: 0,
					limit: 3
				}
			}
			CiayoService.Api('ciayoproducts/banner', c, function(response){
				if(response.status == 200){
					vm.listBannerFree = response.data.c.data.content.list_store_banner;
				} else {
					console.log('error banner');
				}
			});
		}

		function loadCategory(){
			var c = {
				data: {
					offset: "0",
					limit: "3"
				}
			}
			CiayoService.Api('ciayoproducts/category', c, function(response){
				if(response.status == 200){
					vm.listCategory = response.data.c.data.content.list_category_ciayo_product;
					if(vm.category){
						loadListCategory();
					}
				} else {
					console.log('error jow');
				}
			});
		}

		function loadBalance(){
			var c = {
				data: ''
			};

			CiayoService.Api('user/coin/balance', c, function(response){
				var data = response.data.c.data.content;
				vm.cash = data.cash;
				vm.coin = data.coin;
				StoreService.emojiCollection = null;
				StoreService.stickerCollection = null;
			});
		}

		function loadListCategory() {
			var type = $state.current.name;
			type = type.split('.');
			type = type[1];
			vm.typeCat = capitalize(type);
			var id = vm.curCatId;
			var cat = capitalize(vm.category);
			vm.catCat = cat;
			for(var i = 0; i < vm.listCategory.length; i++){
				if(cat == vm.listCategory[i].name){
					id = vm.listCategory[i].category_id;
				}
			}

			if(type == 'premium'){
				var order1 = 0;
				var order2 = 1;
			} else {
				var order1 = 2;
				var order2 = 0;
			}

			StoreService.getList(order1,order2,'0','12',id,'', function(response){
				if(response.status == 200){
					vm.listCategoryItem = response.data.c.data.content.data;
					//console.log(vm.listCategoryItem);
				} else {
					console.log('error premium jaw');
				}
			});
		}

		vm.selectCategory = selectCategory;
		vm.curCatId = -1;
		function selectCategory(id, cat) {
			vm.curCatId = id;
			vm.category = cat;
			loadListCategory();
		}

		function capitalize(str) {	
			str = str.toLowerCase().split(' ');

			for(var i = 0; i < str.length; i++){
				str[i] = str[i].split('');
				str[i][0] = str[i][0].toUpperCase(); 
				str[i] = str[i].join('');
			}
			return str.join(' ');
		}

		vm.keyword = $state.params.keyword;
		vm.listSearchItem = [];
		vm.searchItem = searchItem;
		function searchItem(){
			$state.transitionTo('store.search', {'keyword':vm.keyword});
			StoreService.getList('0','0','0','12','0',vm.keyword, function(response){
				if(response.status == 200){
					vm.listSearchItem = response.data.c.data.content.data;
					//console.log(vm.listSearchItem);
				} else {
					console.log('error free jaw');
				}
			});
		}

		if(vm.keyword){
			vm.searchItem();
		}

		vm.buySticker = buySticker;
		function buySticker(){
			if(!vm.itemDetail.bought){
				var c = {
					data: {
						product_id: vm.itemDetail.product_id,
						price: vm.itemDetail.price_1,
						price_type: 'price_1'
					}
				};

				CiayoService.Api('ciayoproducts/buy', c, function(response){
					$('.c-modal.store').removeClass('-open');
					modalFactory.message(response.data.c.data.message);
					loadBalance();
				});
			}
		}
	}
})();;
(function () {
	'use strict';
	angular.module('app').controller('TimelineController', TimelineController).controller('PostController', PostController);

	TimelineController.$inject = ['PostService','CiayoService', 'ItemService', '$cookieStore', '$rootScope', 'SettingService', '$scope', 'modalFactory','ProfileService','$filter','TourService'];
	PostController.$inject = ['$rootScope','$scope','$cookieStore','$sce', 'PostService', 'ProfileService', 'modalFactory','facebookFactory','$filter','TourService'];


	function TimelineController(PostService,CiayoService, ItemService, $cookieStore, $rootScope, SettingService, $scope, modalFactory,ProfileService, $filter,TourService) {
		var me = this;
		angular.extend(me, {
			comment: {},
			js_timeline: [],
			activity_detail: [],
			is_searching: false,
			load_more: false,
			myPagingfunction: myPagingFunction,
			loadData: loadData,
			createEmotion: createEmotion,
			share: share,
			removePost: removePost,
			lastId:null,
			new_post_count:0,
			new_post_paused :false,
			new_post_timer:null,
			loadNewPost:loadNewPost
		});
		
		
		ProfileService.userInfo('',function($filter){
			me.token_user_id = ProfileService.userData.user_id;
			init();
		},function(){

		});

		

		function init() {
//			kepoboxSlide();
			ProfileService.userInfo('',function(){
				me.lastId = null;
				myPagingFunction();
				runSocket();
			},function(){
				
			});

			TourService.tourSearchActivity();
			
		}
		$scope.$on('card.delete', function (event, post) {
			PostService.deletePost(post.post_id, function (response) {
				var data = response.data.c.data;
				if (data.error == false) {
					removePost(me.js_timeline.indexOf(post));
				} else {
					modalFactory.message(data.message);
				}
			}, function (response) {});
		});

		function myPagingFunction() {
			SettingService.getSettings().then(function (data) {
				var general_setting = data.content.list_setting.general_setting;
				me.animate = general_setting.card_setting.parallax_view;
				loadData();
			});
		}

		function loadDataNext(idx) {
			if (idx == undefined) {
				idx = 0;
			}
			idx = idx+3;
			PostService.timeline(idx, 3, function (response) {
				//me.js_timeline=[];
				var tmp_next = response.data.c.data.content.posts;
				var jml = tmp_next.length;
					console.log(jml);
				if (jml == 0) {
					me.load_more = false;
				} else {
					me.load_more = true;
				}
			}, function (response) {
				console.log(response);
				me.is_searching = false;
				me.js_timeline = [];
			});
		}

		function loadData(idx,offset) {
			
			if (!me.is_searching) {
				me.is_searching = true;
				if (idx == undefined) {
					idx = 0;me.load_more=true;
					newPostPause();
				}
				var last_array = me.js_timeline[me.js_timeline.length-1];
				PostService.timeline(idx, 3,me.lastId, function (response) {
					var tmp = response.data.c.data.content.posts;
					angular.forEach(tmp, function (value, key) {
						if (value.activity_detail != undefined) {
							value.activity_detail.animate = me.animate;
							if(value.user_avatar &&value.user_avatar.face)
							value.activity_detail.avatar_url = value.user_avatar.face;
							value.activity_detail.back_hair = value.user_avatar.back_hair;
						}
						
						value.view = 'normal';
						value.type_page = 'timeline';
						value.login_id = ProfileService.userData.user_id;
						me.js_timeline.push(value);
						last_array = value;
					});
					me.lastId = (last_array) ? last_array.post_id : '';
					
					me.is_searching = false;
					if (response.data.c.data.meta.current_page<response.data.c.data.meta.last_page) {
						me.load_more = true;
					} else {
						me.load_more = false;
					}
					if(tmp.length==0){
						me.load_more=false;
					}
				}, function (response) {
					console.log(response);
					me.is_searching = false;
					me.js_timeline = [];
				});
				//loadDataNext(idx);
			}
		}

		function setData(post_id, name, value) {
			angular.forEach(me.js_timeline, function (val, key) {
				if (val.post_id == post_id) {
					val[name] = value;
				}
			});
		}

		function removePost($index) {
			me.js_timeline.splice($index, 1);
		}
		
		function runSocket(){
			var socket = CiayoService.Socket();
			socket.emit('set_userid',ProfileService.userData.user_id);
			socket.on('np001',socketTimeline);
		}
		function socketTimeline(data){
			me.new_post_count++;
		}
		function loadNewPost(){
			me.new_post_loading=true;
			$('div#c-wrp-timeline').animate({'scrollTop':220});
			PostService.timeline(0,me.new_post_count,null,function(response){
				var tmp = response.data.c.data.content.posts.reverse();
					angular.forEach(tmp, function (value, key) {
						if (value.activity_detail != undefined) {
							value.activity_detail.animate = me.animate;
							if(value.user_avatar &&value.user_avatar.face)
							value.activity_detail.avatar_url = value.user_avatar.face;
							value.activity_detail.back_hair = value.user_avatar.back_hair;
						}
						
						value.view = 'normal';
						value.type_page = 'timeline';
						value.login_id = ProfileService.userData.user_id;
						me.new_post_loading=false;
						me.js_timeline.unshift(value);
					});
				newPostPause();
			},true);
			me.new_post_count=0;
		}
		function newPostPause(){
			me.new_post_paused=true;
			clearTimeout(me.new_post_timer);
			me.new_post_timer = setTimeout(newPostResume, 30000);
		}
		function newPostResume(){
			me.new_post_paused = false;
		}
		function createEmotion(post_id, emotion) {
			post_id = 5;
			emotion = 1;
			if(post_id==1){return;}
			PostService.createEmotion(post_id, emotion, function (response) {
				console.log(response);
			});
		}
		
		function share(post_id) {
			post_id = 5;
			PostService.share(post_id, function (response) {
				console.log(response);
			});
		}

		
		
		// follow user yg sama
		var status_follow = $rootScope.$on(
            "status_follow.timeline",
            function(event, data) {
            	//console.log(me.js_timeline);
             	angular.forEach(me.js_timeline,function(value,key){
             		if(me.js_timeline[key].user_id == data){
             			me.js_timeline[key].cbutton_status.icon_follow = false;
             			me.js_timeline[key].cbutton_status.name_follow = false;
             		}		 	
				});
                
            }
        );

		// unfollow user yang sama
        var status_unfollow = $rootScope.$on(
            "status_unfollow.timeline",
            function(event, data) {
            	//console.log(me.js_timeline);
             	angular.forEach(me.js_timeline,function(value,key){
             		if(me.js_timeline[key].user_id == data){
             			me.js_timeline[key].cbutton_status.icon_follow = true;
             			me.js_timeline[key].cbutton_status.name_follow = true;
             		}		 	
				});      
            }
        );

				
	}


	function PostController($rootScope, $scope,$cookieStore,$sce, PostService, ProfileService, modalFactory,facebookFactory,$filter,TourService) {

		$scope.getTemplateUrl = function () {
			if ($scope.post.view == "normal") {
				return "app/directives/views/card-holder.html";
			}
			if ($scope.post.view == "detail") {
				return "app/directives/views/card-detail.html?v=1.4.3";
			}
			if ($scope.post.view == "loading") {
				return "app/directives/views/card-loading.html";
			}
		}
		angular.extend($scope, {
			reactionDetail:reactionDetail,
			commentLoad: commentLoad,
			commentCreate: commentCreate,
			commentEdit:commentEdit,
			likeComment: likeComment,
			deleteComment: deleteComment,
			commentReply: null,
			commentReplyOpen: commentReplyOpen,
			commentReplyClose: commentReplyClose,
			withDetail: withDetail,
			askWith: askWith,
			askPlace: askPlace,
			shareFBAPI:shareFBAPI,
			shareFB:shareFB,
			shareTo:shareTo,
			loadDetail: loadDetail,
			getDownloadImage:getDownloadImage,
			show_with_ask:show_with_ask,
			cancel_show_with_ask:cancel_show_with_ask,
			askWith_detail:askWith_detail,
			show_place_ask:show_place_ask,
			cancel_show_place_ask:cancel_show_place_ask,
			askPlace_detail:askPlace_detail,
			show_place_ask_normal:show_place_ask_normal,
			show_with_ask_normal:show_with_ask_normal,
			open_item_hidden:open_item_hidden,
			close_item_hidden:close_item_hidden
		});
		init();
		
		function init() {
			$scope.post.comment_stop=false;
			$scope.post.loadingImage=false;
			
			var token = $cookieStore.get('token');
			$scope.post.download_link = $sce.trustAsResourceUrl(API_SERVER+'post/download/card');

			$scope.post.userdata='{"data":{"token":"'+token+'","post_id":"'+$scope.post.post_id+'"},"timestamp":1468376374025,"app":"Web","screen_type":"Web","image_type":"","latitude":"-6.225652","longitude":"106.74576","language":1}';
			if($scope.post.activity_detail){
				$scope.post.activity_detail.old_caption = $scope.post.activity_detail.caption;
			$scope.post.activity_detail.activity_title = ($scope.post.activity_detail.activity_title==undefined?'':$scope.post.activity_detail.activity_title)
				.replace(
				'[USERNAME]',
				'<span class="name">'+
					$scope.post.user_display_name+
				'</span>'
				)
				.replace(
					'[MOOD_TEXT]',
					$scope.post.activity_detail.mood==undefined?'':
						'<span class="mood">'+
							$scope.post.activity_detail.mood.text+' '+
							($scope.post.activity_detail.mood.id==2?'<i class="ci-mood-happy"></i>':
							$scope.post.activity_detail.mood.id==3?'<i class="ci-mood-sad"></i>':'')+
						'</span>'
				)
			;
				$scope.post.activity_detail.search_title = ($scope.post.activity_detail.activity_title==undefined?'':$scope.post.activity_detail.activity_title)
				.replace(
				'[USERNAME]',
				+$scope.post.user_display_name
				)
				.replace(
					'[MOOD_TEXT]',
					$scope.post.activity_detail.mood==undefined?'':$scope.post.activity_detail.mood.text+' '
				)
			;
			}
			$scope.post.loadingRightCount=3;
			$scope.post.list_post_share=[];
			if($scope.post.view!='loading'){
				$scope.post.loadingRightCount=0;
				$scope.post.comment_detail=[];
				$scope.post.comment_count=0;
				$scope.post.shared_count=0;
				$scope.post.reaction={
					'post_id':$scope.post.post_id,
					'user_react':null,
					'detail':{
						'most':null,
						'count':0,
						'text':null
					}
				};
				commentLoad($scope.post, null, 0, 5);
				reactionDetail($scope.post.post_id);
				loadShare();
				getStatusInfo($scope.post.username, $scope.post.type_page);
			}
			
			if ($scope.post.with_status != undefined) {
				$scope.post.with_status.class = parseStatusClass($scope.post.with_status.value);
			}
			if ($scope.post.place_status != undefined) {
				$scope.post.place_status.class = parseStatusClass($scope.post.place_status.value);
			}
			if($scope.post.generated_image_url!=undefined){
				$scope.post.activity_detail.share.pinterest.replace('[IMAGE_PINTEREST]',$scope.post.generated_image_url);
				preloadImage();
			}else{
				getDownloadImage();
			}
		}

		function open_item_hidden(index){
			$scope.post.item_hidden_selected = index;
			$scope.post.item_hidden_frame = true;
			$scope.post.item_hidden_close = true;
		}

		function close_item_hidden(){
			$scope.post.item_hidden_selected = -1;
			$scope.post.item_hidden_frame = false;
			$scope.post.item_hidden_close = false;
		}

		function getStatusInfo(username, type_page){
			if($scope.post.isPublic){
				$scope.post.profile = {user_id:-1,user_avatar:''};
			}else
			{
				ProfileService.userInfo('',function(response){
					$scope.post.profile = response;
				},function(){

				});
				ProfileService.getStatusInfo(username, function (response) {
					$scope.post.cbutton_status = [];
					
					$scope.post.cbutton_status = response;
					$scope.post.cbutton_status.type_page = type_page;

					$scope.post.cbutton_status.username = username;

					$scope.post.cbutton_status.icon_action_response = false;
					$scope.post.cbutton_status.open_action = false;
					$scope.post.cbutton_status.ci_star = false;
					$scope.post.cbutton_status.ci_check = false;
					
					if($scope.post.cbutton_status.status.friend.add==false){
						$scope.post.cbutton_status.icon_addfriend = true;
						$scope.post.cbutton_status.name_addfriend = true;
						$scope.post.cbutton_status.icon_self = 0;
						$scope.post.cbutton_status.name_self = 0;
					}else{
						if($scope.post.cbutton_status.status.friend.addstatus==false){
							if($scope.post.cbutton_status.status.friend.approve==true){
								$scope.post.cbutton_status.icon_addfriend = false;
								$scope.post.cbutton_status.name_addfriend = false;
								$scope.post.cbutton_status.icon_self = 0;
								$scope.post.cbutton_status.name_self = 0;
							}else{
								$scope.post.cbutton_status.icon_addfriend = true;
								$scope.post.cbutton_status.name_addfriend = true;
								$scope.post.cbutton_status.icon_self = 1;
								$scope.post.cbutton_status.name_self = 1;
								$scope.post.cbutton_status.ci_star = true;
							}
						}else{
							$scope.post.cbutton_status.icon_addfriend = false;
							$scope.post.cbutton_status.name_addfriend = false;
							$scope.post.cbutton_status.icon_self = 0;
							$scope.post.cbutton_status.name_self = 0;
							$scope.post.cbutton_status.ci_check = true;
						}
					}
					if($scope.post.cbutton_status.status.friend.approve==false){
						$scope.post.cbutton_status.checklist_addfriend = true;
					}else{
						$scope.post.cbutton_status.checklist_addfriend = false;
					}

					if($scope.post.cbutton_status.status.follow==false){
						$scope.post.cbutton_status.icon_follow = true;
						$scope.post.cbutton_status.name_follow = true;
						$scope.post.cbutton_status.checklist_follow = true;
					}else{
						$scope.post.cbutton_status.icon_follow = false;
						$scope.post.cbutton_status.name_follow = false;
					}

					if($scope.post.user_status){
						$scope.post.cbutton_status.self = 'false';

					}else{
						$scope.post.cbutton_status.self = 'true';
						$scope.post.cbutton_status.username = '';
					}

					$scope.post.user_list_button = $scope.post.cbutton_status;

					//console.log($scope.post.user_list_button);
				}, function (response) {
					console.log(response);
				});
			}
		}

		function parseStatusClass(value) {
			var _class = '';
			switch (value) {
			case '-1':
				_class = '-blank';
				break;
			case '1':
				_class = '-secret';
				break;
			case '2':
				_class = '-alone';
				break;
			}
			return _class;
		}
		//REACTION
		function reactionDetail(post_id) {
			if($scope.post.isPublic){$scope.post.loadingRightCount++;return;}
			PostService.reactionDetail(post_id, function (response) {
				var data = response.data.c.data;
				if (data.error == false) {
					var data = data.content;
					$scope.post.reaction=data.rate_detail;
					$scope.post.reaction.user = [];
					angular.forEach(data.rate_count,function(rates,rate_key){
						angular.forEach(rates.users,function(rate,key){
							rate.rate = rate_key.split('_').pop();
							$scope.post.reaction.user.push(rate);
						})

					});
				}
			}, function (response) {

			});
		}
		//COMMENT
		function commentCreate(post, content, comment) {
			var parent_id = comment == undefined ? 0 : comment.id_comment;
			var data = {
				"post_id": post.post_id,
				"content": content,
				"parent_id": parent_id
			};
			if(post.enable_comment==false || post.post_id==1){modalFactory.message('Comment disabled.');return;}
			PostService.createComment(data, function (response) {
				var data = (response.data.c.data.content.data);
				angular.forEach(data, function (value, key) {
					if (parent_id == 0) {
						post.comment_detail.push(value);
						post.comment_count = value.total_post_comment;
					} else {
						if (comment.detail == undefined) comment.detail = [];
						comment.reply_count++;
						comment.detail.push(value);
					}
				});
			});
		}
		function commentEdit(comment) {
			if(comment.content==comment.old_content){
				comment.on_edit=false;
				comment.content = comment.old_content;
				$scope.onEditComment = false;
				return;
			}
			PostService.editComment(comment.id_comment, comment.content, function (response) {
				comment.on_edit=false;
				comment.old_content=null;
				$scope.onEditComment = false;
				if(response.status==200){
					var data = response.data.c.data;
					if(data.error==false){
						comment.updated_at = data.content.updated_at;
					}
				}
			});
		}
		
		function likeComment(comment, value) {
			PostService.likeComment(comment.id_comment, value, function (response) {
				var data = (response.data.c.data.content);
				comment.like_count = data.like_count;
				comment.dislike_count = data.dislike_count;
				comment.like = value;
			});
		}

		function deleteComment(comment_id, $index) {
			modalFactory.confirm('Yakin ingin menghapus?', function (response) {
				if (response) {
					PostService.deleteComment(comment_id, function (response) {
						var data = response.data.c.data;
						if (data.error == false && data.content.status == 'success') {
							$scope.post.comment_detail.splice($index, 1);
							$scope.post.comment_count -= 1;
						}
					});
				}
			});
		}

		function commentLoad(post, comment, offset, limit) {
			if($scope.post.isPublic){$scope.post.loadingRightCount++;return;}
			var id_comment = 0;
			if (comment != undefined) {
				comment.detail = [];
				id_comment = comment.id_comment
			}
			PostService.loadComment(post.post_id, id_comment, offset, limit, function (response) {
				var data = response.content.list_comment;

				if (comment == undefined) {
					if(offset==0){post.comment_detail=[];post.loadingRightCount++;}
					if(data.length>0){
						$scope.post.comment_count=response.meta.total;
						angular.forEach(data, function (value, key) {
							post.comment_detail.unshift(value);
							
						});
						$scope.post.comment_stop=false;
					}else{
						$scope.post.comment_stop=true;
					}
				} else {
					if (offset == 0) {
						comment.detail = [];
						angular.forEach(data, function (value, key) {
							comment.detail.unshift(value);
						});
					} else {
						angular.forEach(data, function (value, key) {
							comment.detail.unshift(value);
						});
					}
				}
			}, function () {
				if(comment == undefined && offset==0){
					$scope.post.loadingRightCount++;
				}
			})
		}

		function commentReplyOpen(post, comment) {
			$scope.commentReply = comment;
			commentLoad(post, comment, 0, 20);
		}

		function commentReplyClose() {
			$scope.commentReply = null;
			console.debug($scope.commentReply);
		}
		//WITH
		function withDetail(post_id) {
			PostService.loadWith(post_id, function (response) {
				var data = response.data.c.data;
				if (data.error == false) {
					$scope.post.with = data.content.data;
				}
			}, function (response) {});
		}
		
		function askWith(post) {
			if(post.post_id==1){modalFactory.message('Asking disabled');return;}
			if (post.user_status && post.with_detail.with_status.value==-1){
				modalFactory.confirm($filter('translate')('$ask.with') + post.user_display_name + $filter('translate')('$ask.with.when'), function (response) {
				if (response) {
					PostService.ask(post.post_id, 'ask_with', function (response) {
						modalFactory.message(response.data.c.data.message);
						//console.log(response.data.c.data.message);
					}, function (response) {
						modalFactory.message(response.data.c.data.message);
					});
				}
			});
			}
		}
		//PLACE
		function askPlace(post) {
			if(post.post_id==1){modalFactory.message('Asking disabled');return;}
			if (post.user_status && post.place_detail.place_status.value==-1){
				modalFactory.confirm($filter('translate')('$ask.place') + post.user_display_name + $filter('translate')('$ask.place.when'), function (response) {
					if (response) {
						PostService.ask(post.post_id, 'ask_place', function (response) {
							modalFactory.message(response.data.c.data.message);
						}, function (response) {
							modalFactory.message(response.data.c.data.message);
						});
					}
				});
			}
		}
		//SHARE
		function shareFBAPI(post){
			$scope.post.facebook_disabled = true;
			var access_token = '';
			var uid = '';
			facebookFactory.getToken(function (data) {
				//console.log(data);
				access_token = data.accessToken;
				uid = data.uid;
				if(data==undefined || data.accessToken==undefined){
					modalFactory.message($filter('translate')('$fb.error'))
					return;
				}
				PostService.shareFB(access_token, uid, post.post_id, function (response) {
					var data = response.data.c.data;
					//console.log(data);
					if(data.error==false){
						modalFactory.message(data.message);
						loadShare();

					}
					$scope.post.facebook_disabled=false;
				}, function () {
					$scope.post.facebook_disabled = false;
				});
			});
		}
		function shareFB(post) {
			$scope.post.facebook_disabled = true;
			var title=post.activity_detail.search_title || '';
			PostService.createShareFB(post.post_id).then(function(data){
				console.log(data);
				FB.ui({
					method: 'share',
					display: 'iframe',
					type: 'photo',
					caption: data.content.caption,
					redirect_uri: data.content.redirect_uri,
					description: data.content.description,
					name: data.content.name,
					href: data.content.href,
					picture: data.content.picture
				}, function(response){
					$scope.post.facebook_disabled = true;
						shareTo('facebook');
				});
			},function(response){
				console.log(response);
				$scope.post.facebook_disabled=false;
			})
			
		}
		function shareTo(to){
			PostService.shareTo($scope.post.post_id,to,function(data){
				loadShare();
				$scope.post.facebook_disabled=false;
			},function(){
				$scope.post.facebook_disabled=false;
			})
		}
		function loadShare(){
			PostService.loadShare($scope.post.post_id,function(response){
				var data = response.data.c.data;
				if(data.error==false){
					$scope.post.list_post_share=data.content.list_post_share;
					$scope.post.shared_count = $scope.post.list_post_share.length;
					$scope.post.facebook_disabled = false;
				}
			},function(){
				
			})
		}
		//DETAIL
		//DETAIL
		function loadDetail(post_code) {
			modalFactory.card(post_code);
		}
		function preloadImage(){
			$scope.post.loading_preload = true;
			var img = new Image();
			img.src = $scope.post.activity_detail.preview;
			img.onload = function(){
				$scope.post.loading_preload = false;
				$rootScope.$apply();
			}
		}
		function getDownloadImage(){
			if($scope.post.generated_image_url==undefined){
				$scope.post.loadingImage=true;
				PostService.getDownloadImage($scope.post.post_id,function(response){
					var data = response.data.c.data;
					if(data.error==false){
						$scope.post.generated_image_url = data.content.card_media_id;
						$scope.post.activity_detail.share.pinterest = $scope.post.activity_detail.share.pinterest.replace('[IMAGE_PINTEREST]',$scope.post.generated_image_url);
						$scope.post.activity_detail.preview = data.content.preview_media_id;
					}
					$scope.post.loadingImage=false;
					preloadImage();
				},function(){
				});
			}
		}


		function show_with_ask(post){

			//console.log($scope.post.user_status);

			if($scope.post.user_status){
				if(post.open_with){
					post.open_with = false;
				}else{
					post.open_with = true;

				}
			}
		}

		function show_with_ask_normal(post){

			if(post.open_with){
				post.open_with = false;
			}else{
				post.open_with = true;
				withDetail(post.post_id);
			}
				
		}

		function cancel_show_with_ask(post){
			post.open_with = false;
		}

		function askWith_detail(post) {		
				//alert('test');
				PostService.ask(post.post_id, 'ask_with', function (response) {
					modalFactory.message(response.data.c.data.message);	
				}, function (response) {
					modalFactory.message(response.data.c.data.message);	
				});
				//post.open_with = false;
				//modalFactory.message("Ask with success");	
		}

		function show_place_ask(post){

			//console.log('ok');
			post.open_with = false;

			if($scope.post.user_status){
				if(post.open_place){
					post.open_place = false;
				}else{
					post.open_place = true;
				}
			}
		}

		function show_place_ask_normal(post){

			//console.log('ok');
			post.open_with = false;
			if(post.open_place){
				post.open_place = false;
			}else{
				post.open_place = true;
			}
		
		}

		function cancel_show_place_ask(post){
			post.open_place = false;
		}

		function askPlace_detail(post) {		
				//alert('test');
				PostService.ask(post.post_id, 'ask_place', function (response) {
					//console.log(response);
					modalFactory.message(response.data.c.data.message);	
				}, function (response) {
					modalFactory.message(response.data.c.data.message);	
				});
				
				
		}
		
	}
})();;
(function () {
	'use strict';
	angular
		.module('app')
		.controller('TrendingController', TrendingController);
		
	TrendingController.$inject = ['$state', 'AuthService','CiayoService','TrendingService','ItemService','$cookieStore','$rootScope', 'ConnectionService', 'SettingService','CiayoBanner', 'ProfileService'];
	function TrendingController($state, AuthService, CiayoService,TrendingService,ItemService,$cookieStore, $rootScope, ConnectionService, SettingService, CiayoBanner, ProfileService) {
		
		var me=this;
		angular.extend(me,{
			state:0,
			is_searching: false,
			js_timeline: [],
			load_more: false
		});
		me.comment={};
		
		me.activity_detail=[];
		me.action_check_me = action_check_me;
		me.action_addfriend = action_addfriend;
		me.action_follow = action_follow;
		me.action_response = action_response;
		me.closeActionResponse = closeActionResponse;
		me.action_response_accept = action_response_accept;
		me.action_response_delete = action_response_delete;
		me.myPagingFunction = myPagingFunction;
		me.isloading = false;
		me.loading_show_more = false;
		me.button_show_more = false;
		me.loadMoreActivity=loadMoreActivity;

		ProfileService.userInfo('',function(){
			me.token_user_id = ProfileService.userData.user_id;
			myPagingFunction();
		},function(){

		});

		CiayoBanner.getData("trending", function(response){
			me.banner = response.data.c.data.content.image;
			setTimeout(function(){
				$('.c-banner').children("ul").parallax({
					clipRelativeInput: false,
					originY: 0.0
				});
			}, 1)
		}, function(){

		})

		

		function myPagingFunction(){
			SettingService.getSettings().then(function(data) {
				console.log(data);
				var general_setting = data.content.list_setting.general_setting;
				me.animate = general_setting.card_setting.parallax_view;
				loadData();
			});
		}

		me.loadData = loadData;

		function loadData(idx){
			//alert('ok');
			if (!me.is_searching) {
				me.is_searching = true;
				if (idx == undefined) {
					idx = 0;
					me.load_more = true;
				}

				if(idx<=9){
					TrendingService.postTrending (idx, function(response){
						//console.log(response.data.c.data.content);
						var tmp=response.data.c.data.content.trending;
						
						angular.forEach(tmp,function(value,key){
							if(value.activity_detail!=undefined){
								value.activity_detail.animate = me.animate;
								value.activity_detail.avatar_url=value.user_avatar.face;
								value.activity_detail.back_hair=value.user_avatar.back_hair;

							}

							//value.place.url='https://www.google.com/maps/preview/@' + value.place.place_lat+',' + value.place.place_long + ',8z';
							value.view='normal';
							value.login_id=me.token_user_id;
							value.type_page = 'trending';
							me.js_timeline.push(value);
						});
						//console.log(me.js_timeline);
						me.is_searching=false;
						if (response.data.c.data.meta.current_page<response.data.c.data.meta.last_page) {
							me.load_more = true;
						} else {
							me.load_more = false;
						}
						if(tmp.length==0){
							me.load_more=false;
						} 
					},function(response){
						console.log(response);
						me.is_searching=false;
						me.js_timeline=[];
					});
				}else{
					me.is_searching = false;
				}
			}else{
				me.is_searching = true;
			}
		}

		function setData(post_id,name,value){
			angular.forEach(me.js_timeline,function(val,key){
				if(val.post_id==post_id){
					val[name]=value;
				}
			});
		}
		function removePost($index){
			me.js_timeline.splice($index,1);
		}
		function createEmotion(post_id,emotion){
			post_id=5;emotion=1;
			TrendingService.createEmotion (post_id,emotion,function(response){
				console.log(response);
			});
		}
		function share(post_id){
			post_id=5;
			TrendingService.share (post_id,function(response){
				console.log(response);
			});
		}
		function disableComment(post_id,disable){
			post_id=5;disable=1;
			TrendingService.disableComment(post_id,disable,function(response){
				console.log(response);
			});
		}
		function updateWith(post_id,with_user,without_user){
			post_id=9;with_user=[{"id": "11","username": "andi"},{"id": "12","username": "budi"}];
			without_user=null;
			TrendingService.likeComment(post_id,with_user,null,function(response){
				console.log(response);
			});
		}
		
		function editComment(comment_id,content){
			//comment_id=9;content="test";
			TrendingService.editComment(comment_id,content,function(response){
				console.log(response);
			});
		}
		
		me.createEmotion=createEmotion;
		me.share=share;
		me.disableComment=disableComment;
		me.updateWith=updateWith;
		me.editComment=editComment;
		
		me.removePost=removePost;
		
		var data=
				{
					"app": "Android",
					"token": 123,
					"timestamp": "1458117439067",
					"latitude": -6.13732894,
					"longitude": 106.83117118,
					"data": {
						"userid": 1
					}
				};
		/*CiayoService.Socket().emit('ck001',data, function(data){console.log(data);
			if (data) {
				// mySocket.emit('send_message', 'from codess');
			} else {
				console.log('user has used');
			}
		});*/

		//trending people 
		me.list_people_trending=[];
		me.start_people_trending = false;

		
		function getListPeopleTrending(){

						

						TrendingService.peopleTrending (
							function(response){//callback sucess
								//console.log(response.data.c.data.content);
								//vm.list_user = response.data.c.data.content.list_user;
								me.start_people_trending = true;

								var tmp=(response.data.c.data.content.trending);
								//console.log(tmp);
								me.count = 1;
								angular.forEach(tmp,function(value,key){

									if(me.token_user_id==tmp[key].user_id){
										value.button_self = true;
									}else{
										value.button_self = false;
									}

									value.icon_action_response = false;
									value.open_action = false;
									value.ci_star = false;
									value.ci_check = false;
									
									if(tmp[key].status.friend.add==false){
										value.icon_addfriend = true;
										value.name_addfriend = true;
										value.icon_self = 0;
										value.name_self = 0;
										
										
									}else{
										
										if(tmp[key].status.friend.addstatus==false){
											if(tmp[key].status.friend.approve==true){
												value.icon_addfriend = false;
												value.name_addfriend = false;
												value.icon_self = 0;
												value.name_self = 0;
												
											}else{
												value.icon_addfriend = true;
												value.name_addfriend = true;
												value.icon_self = 1;
												value.name_self = 1;
												
												value.ci_star = true;
											}
										}else{
											value.icon_addfriend = false;
											value.name_addfriend = false;
											value.icon_self = 0;
											value.name_self = 0;
											value.ci_check = true;
										}
									}

									/*if(tmp[key].status.self.add==true){
										value.icon_self = 1;
										value.name_self = 1;
									}else{
										value.icon_self = 0;
										value.name_self = 0;
									}*/

									if(tmp[key].status.friend.approve==false){
										value.checklist_addfriend = true;
									}else{
										value.checklist_addfriend = false;
									}

									if(tmp[key].status.follow==false){
										value.icon_follow = true;
										value.name_follow = true;
										value.checklist_follow = true;
									}else{
										value.icon_follow = false;
										value.name_follow = false;
									}
								
									me.list_people_trending.push(value);
									value.people_trending_number= me.count;
									if((value.people_trending_number+'').length==1){
										value.people_trending_number = "0"+value.people_trending_number;
									}
									me.count++;
								});
							
							},
							function(response){//err callback
								console.log(response);
							}
						);
		}
		//getListPeopleTrending();

		//trending activity 
		me.list_activity_trending=[];
		me.start_activity_trending = false;

		function loadMoreActivity(){	
			getListActivityTrending();
		}

		function getListActivityTrending_next(){
			
				var limit = 2;
				var offset = me.list_activity_trending.length;

				TrendingService.activityTrending (limit, offset,
					function(response){//callback sucess

						var tmp_next=(response.data.c.data.content.trending);
						//console.log(tmp);

						if(tmp_next.length==0){
							me.button_show_more = false;
						}else{
							me.button_show_more = true;
						}		
						
					},
					function(response){//err callback
						console.log(response);
					}
				);
			
		}

		function getListActivityTrending(start){
			if(!me.isloading){
				//console.log('test');
				me.isloading = true;
				
				var offset = me.list_activity_trending.length;

				if(offset<=19){

					if(offset >= 19){
					 	var limit = 1;
					}else{
						var limit = 3;
					}

					TrendingService.activityTrending (limit, offset,
						function(response){//callback sucess
							//console.log(response.data.c.data.content);
							//vm.list_user = response.data.c.data.content.list_user;
							me.start_activity_trending = true;
							var tmp=(response.data.c.data.content.trending);
							//console.log(tmp);

							if(start){
								me.count_activity = 1;
							}else{
								me.count_activity = (me.count_activity) ? me.count_activity : 1;
							}

							angular.forEach(tmp,function(value,key){

								if(value.activity_detail!=undefined){
									value.activity_detail.animate = me.animate;
									value.activity_detail.avatar_url=(value.user_avatar)?value.user_avatar.face:'';
									value.activity_detail.back_hair=(value.user_avatar)?value.user_avatar.back_hair:'';
								}
							
								me.list_activity_trending.push(value);
								value.activity_trending_number = me.count_activity;
								//console.log((value.activity_trending_number+'').length);
								if((value.activity_trending_number+'').length==1){
									value.activity_trending_number = "0"+value.activity_trending_number;
								}
								me.count_activity++;
								me.isloading = false;
							});
							
							if(offset < 19){
								getListActivityTrending_next();
							}else{
								me.button_show_more = false;
							}
						},
						function(response){//err callback
							console.log(response);
						}
					);
				}
			}
		}

		
		//getListActivityTrending();

		//trending place 
		me.list_place_trending=[];
		me.start_place_trending = false;

		function getListPlaceTrending(){
						TrendingService.placeTrending (
							function(response){//callback sucess
								//console.log(response.data.c.data.content);
								//vm.list_user = response.data.c.data.content.list_user;
								me.start_place_trending = true;
								var tmp=(response.data.c.data.content.trending);
								//console.log(tmp);
								me.count = 1;
								angular.forEach(tmp,function(value,key){
								
									me.list_place_trending.push(value);
									value.place_trending_number = me.count;
									//console.log((value.place_trending_number+'').length);
									if((value.place_trending_number+'').length==1){
										value.place_trending_number = "0"+value.place_trending_number;
									}
									me.count++;
								});
							},
							function(response){//err callback
								console.log(response);
							}
						);
		}
		//getListPlaceTrending();

		function action_check_me(username){
			//alert(username);
			$state.go('profile', {user: username});
		}

		function action_addfriend(user, index){
			//alert(user_id+'_'+id);
			var user_id = me.list_people_trending[index].user_id;

			ConnectionService.requestAddFriend(user_id, function(response){
				console.log(response);
				user.icon_addfriend = false;
				user.name_addfriend = false;
				

				user.icon_follow = false;
				user.name_follow = false;

			},function(response){
				//console.log(response);
			});
		}

		function action_follow(user, index){
			//alert(user_id+'_'+id);
			var user_id = me.list_people_trending[index].user_id;
			
			ConnectionService.requestFollow(user_id, true, function(response){
				console.log(response);
				user.icon_follow = false;
				user.name_follow = false;

			},function(response){
				//console.log(response);
			});
		}

		function action_response(user, index){
			
			me.list_people_trending[index].icon_action_response = true;
			
			
		}

		function closeActionResponse(index){
			//alert("test");
			me.list_people_trending[index].icon_action_response = false;
		}

		function action_response_accept(user, index){


			var user_id = me.list_people_trending[index].user_id;
						
			ConnectionService.requestConfirmFriendRequest(user_id, function(response){
				user.icon_addfriend = false;
				user.name_addfriend = false;
				user.checklist_addfriend = false;
				user.icon_follow = false;
				user.name_follow = false;
				me.list_people_trending[index].icon_action_response = false;

				$rootScope.$broadcast( "user.added_friend",'data' );

			},function(response){
				//console.log(response);
			});
		}

		function action_response_delete(user, index){

			
			var user_id = me.list_people_trending[index].user_id;
						
			ConnectionService.requestRejectFriendRequest(user_id, function(response){
				user.icon_addfriend = true;
				user.name_addfriend = true;
				user.icon_self = 0;
				user.name_self = 0;
				me.list_people_trending[index].icon_action_response = false;

				$rootScope.$broadcast( "user.added_friend",'data' );

			},function(response){
				//console.log(response);
			});
		}
		me.test=test;

		function test(){
			$rootScope.$broadcast( "user.added_friend", 'data');
		}

		function show_frame(user){
			if(me.token_user_id!=me.list_people_trending[index].user_id){
				user.open_action = true;
			}
			//alert("ok");
			
		}

		function close_frame(user){
			user.open_action = false;
		}

		me.show_frame = show_frame;
		me.close_frame = close_frame;
		me.load_state_people = false;
		me.load_state_activity = false;
		me.load_state_place = false;

		function action_state(id){
			
			me.state = id;
			
			switch(me.state){
				case 1:
					if(!me.load_state_people){
						me.start_people_trending = false;
						me.list_people_trending = [];
						me.load_state_people = true;
						getListPeopleTrending(true);
					}
				break;

				case 2:
					if(!me.load_state_activity){
						me.start_activity_trending = false;
						me.list_activity_trending = [];
						me.load_state_activity = true;
						getListActivityTrending(true);
					}
				break;

				case 3:
					if(!me.load_state_place){
						me.start_place_trending = false;
						me.list_place_trending = [];
						me.load_state_place = true;
						getListPlaceTrending(true);
					}
				break;
			}
			

		}

		me.action_state = action_state;

		var friend = $rootScope.$on(
            "friend.trending_people",
            function(event, data) {
            	angular.forEach(me.list_people_trending,function(value,key){
					me.list_people_trending[key].open_action = false;
				});
            }
        );

        // follow user yg sama
		var status_follow = $rootScope.$on(
            "status_follow.trending",
            function(event, data) {
            	//console.log(me.js_timeline);
             	angular.forEach(me.js_timeline,function(value,key){
             		if(me.js_timeline[key].user_id == data){
             			me.js_timeline[key].cbutton_status.icon_follow = false;
             			me.js_timeline[key].cbutton_status.name_follow = false;
             		}		 	
				});
                
            }
        );

        // unfollow user yang sama
        var status_unfollow = $rootScope.$on(
            "status_unfollow.trending",
            function(event, data) {
            	//console.log(me.js_timeline);
             	angular.forEach(me.js_timeline,function(value,key){
             		if(me.js_timeline[key].user_id == data){
             			me.js_timeline[key].cbutton_status.icon_follow = true;
             			me.js_timeline[key].cbutton_status.name_follow = true;
             		}		 	
				});      
            }
        );

        // add friend yang sama
        var add_friend = $rootScope.$on(
            "add_friend.trending",
            function(event, data) {
            	//console.log(me.js_timeline);
             	angular.forEach(me.js_timeline,function(value,key){
             		if(me.js_timeline[key].user_id == data){
             			me.js_timeline[key].cbutton_status.icon_addfriend = false;
             			me.js_timeline[key].cbutton_status.name_addfriend = false;
             			me.js_timeline[key].cbutton_status.ci_check = true;
             			me.js_timeline[key].cbutton_status.icon_follow = false;
             			me.js_timeline[key].cbutton_status.name_follow = false;
             		}		 	
				});      
            }
        );

        // cancel friend yang sama
        var cancel_friend = $rootScope.$on(
            "cancel_friend.trending",
            function(event, data) {
            	//console.log(me.js_timeline);
             	angular.forEach(me.js_timeline,function(value,key){
             		if(me.js_timeline[key].user_id == data){

             			me.js_timeline[key].cbutton_status.icon_addfriend = true;
             			me.js_timeline[key].cbutton_status.name_addfriend = true;
             			me.js_timeline[key].cbutton_status.icon_self = 0;
             			me.js_timeline[key].cbutton_status.name_self = 0;
             			me.js_timeline[key].cbutton_status.ci_star = false;
             			me.js_timeline[key].cbutton_status.icon_action_response = false;
             		}		 	
				});      
            }
        );

         // accept yang sama
        var accept_friend = $rootScope.$on(
            "accept_friend.trending",
            function(event, data) {
            	//console.log(me.js_timeline);
             	angular.forEach(me.js_timeline,function(value,key){
             		if(me.js_timeline[key].user_id == data){
	        			me.js_timeline[key].cbutton_status.icon_addfriend = false;
             			me.js_timeline[key].cbutton_status.name_addfriend = false;
             			me.js_timeline[key].cbutton_status.checklist_addfriend = false;
             			me.js_timeline[key].cbutton_status.icon_follow = false;
             			me.js_timeline[key].cbutton_status.name_follow = false;
             			me.js_timeline[key].cbutton_status.icon_action_response = false;
             			me.js_timeline[key].cbutton_status.status.friend.approve = true;
             			me.js_timeline[key].cbutton_status.hide_approve = true;
             		}		 	
				});      
            }
        );

        // decline yang sama
        var decline_friend = $rootScope.$on(
            "decline_friend.trending",
            function(event, data) {
            	//console.log(me.js_timeline);
             	angular.forEach(me.js_timeline,function(value,key){
             		if(me.js_timeline[key].user_id == data){
             			me.js_timeline[key].cbutton_status.icon_addfriend = true;
             			me.js_timeline[key].cbutton_status.name_addfriend = true;
             			me.js_timeline[key].cbutton_status.icon_self = 0;
             			me.js_timeline[key].cbutton_status.name_self = 0;
             			me.js_timeline[key].cbutton_status.ci_star = false;
             			me.js_timeline[key].cbutton_status.icon_action_response = false;
             		}		 	
				});      
            }
        );
	}
})();;
(function() {
'use strict';

  angular
    .module('app')
    .controller('UpdateLogController', UpdateLogController);

  UpdateLogController.$inject = ['CiayoService','$cookieStore'];
  function UpdateLogController(CiayoService, $cookieStore) {
    var vm = this;

    vm.getUpdate = getUpdate;
    function getUpdate() {
      var lang = $cookieStore.get('language');
      var c={
          data:{
              page_id:10,
              language_id:lang
          }
      }
      CiayoService.Api('page/detail', c, function(response) {
          if(response.status == 200) {
              vm.content = response.data.c.data.content.content;
          } else {
              window.alert('error');
          }
      });
    }

    vm.getUpdate();
  }
})();;
(function() {
'use strict';

	angular
		.module('app')
		.controller('WelcomeController', WelcomeController);

	WelcomeController.$inject = ['$rootScope','$state','$stateParams', 'AuthService','CiayoService','SettingService', '$timeout', '$translate', '$cookieStore', 'modalFactory'];
	function WelcomeController($rootScope,$state,$stateParams, AuthService, CiayoService, SettingService, $timeout, $translate, $cookieStore, modalFactory) {
		var vm = this;

		// clear cookies
		$cookieStore.remove('gender');
		$cookieStore.remove('profile');
		$cookieStore.remove('token');

		// set language
		if(!$cookieStore.get('language')) {
			SettingService.getLanguage().then(function(data) {
				var lang_code = ['', 'en', 'id'];
				$translate.use(lang_code[data.content.language]);
			});
		}
		
		// var untuk registrasi
		vm.validateEmail = validateEmail;
		vm.isEmailValidated = false;
		vm.validatePassword = validatePassword;
		vm.isPassValidated = false;
		vm.checkPassword = checkPassword;
		vm.checkRePass = checkRePass;
		vm.isRePassValidated = false;
		vm.validatePhone = validatePhone;
		vm.isPhoneValidated = false;
		
		vm.listPhoneCode = [];
		
		// fungsi2 regsitrasi
		vm.login = login;
		vm.register = register;
		vm.forgotPassword = forgotPassword;
		vm.resetPassword = resetPassword;
		vm.logout = logout;
		vm.closeFPNotif = closeFPNotif;
		vm.homePopupToggle = homePopupToggle;
		vm.changeLang = changeLang;
		vm.getLanguage = getLanguage;

		// error messsage
		vm.errMsg = '';
		
		vm.inputFocus = inputFocus;
		homePopupToggle();
		
		////////////////
		
		function validateEmail(name, val) {
			var email = val;
			var elem = selectElement('input[name='+name+']');
			
			if(email && email.match(/(?:[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/g)) {
				elem.removeClass('error');
				elem.addClass('success');
				
				vm.isEmailValidated = true;
			} else if(email){
				elem.removeClass('success');
				elem.removeClass('error');
				setTimeout(function(){
					elem.addClass('error');
				}, 1);
				
				vm.isEmailValidated = false;
			} else {
				elem.removeClass('success');
				elem.removeClass('error');
			}
		}
		
		function validatePassword(id){
			if(vm.registerType == 'email') {
				var pass = vm.regEPass;
			} else if(vm.registerType == 'phone') {
				var pass = vm.regPPass;
			} else {
				var pass = vm.newPass;
			}
			var len = selectElement('#'+id+' ul li:first-child .unchecked-circle');
			var char = selectElement('#'+id+' ul li:last-child .unchecked-circle');
			
			if ( pass.length > 7 ) {
					len.addClass('active');
					var re = /^[A-Za-z\d\!\@\#\$\%\^\*\{\[\}\}\:\;\,\.\?\+\-\_\=\~\']{8,}$/; 
					if ( re.exec(pass) ) {
						char.addClass('active');
						
						vm.isPassValidated = true;
					} else {
						char.removeClass('active');
						
						vm.isPassValidated = false;
					}
			} else {
					len.removeClass('active');
					char.removeClass('active');
					
					vm.isPassValidated = false;
			}
		}
		
		function checkPassword(name){
			var elem = selectElement('input[name='+name+']');
			if(vm.registerType == 'email') {
				var pass = vm.regEPass;
			} else if(vm.registerType == 'phone') {
				var pass = vm.regPPass;
			} else {
				var pass = vm.newPass;
			}
			
			if(pass && pass.match(/^[A-Za-z\d\!\@\#\$\%\^\*\{\[\}\}\:\;\,\.\?\+\-\_\=\~\']{8,}$/)) {
				elem.removeClass('error');
				elem.addClass('success');
			} else {
				elem.removeClass('success');
				elem.removeClass('error');
				setTimeout(function(){
					elem.addClass('error');
				}, 1);
			}
		}
		
		function checkRePass() {
			var elem = selectElement('input[name=rePass]');
			if((vm.newPass == vm.rePass) && vm.rePass) {
				elem.removeClass('error');
				elem.addClass('success');
				vm.isRePassValidated = true;
			} else {
				elem.removeClass('success');
				elem.removeClass('error');
				setTimeout(function(){
					elem.addClass('error');
				}, 1);
				vm.isRePassValidated = false;
			}
		}
		
		function validatePhone(name, val) {
			var phone = val;
			var elem = selectElement('input[name='+name+']');
			
			if(!isNaN(phone)) {
				elem.removeClass('error');
				elem.addClass('success');
				
				vm.isPhoneValidated = true;
			} else if(phone){
				elem.removeClass('success');
				elem.removeClass('error');
				setTimeout(function(){
					elem.addClass('error');
				}, 1);
				
				vm.isPhoneValidated = false;
			} else {
				elem.removeClass('success');
				elem.removeClass('error');
			}
		}
		
		///////////////
		
		function login() {
			$cookieStore.remove('token');
			if(vm.loginType == 'email') {
				var c = {
					data: {
						email: vm.logEmail,
						password: vm.logEPass
					}
				};
			} else {
				var phone = '';
				if(vm.logPhone){
					var pclen = vm.logPC.length;
					phone = vm.logPhone;
					if(phone.charAt(0) == '0'){
						phone = phone.substr(1);
					} else if(phone.substring(0,pclen) == vm.logPC){
						phone = phone.substr(pclen);
					} else {
						phone = phone;
					}
				}
				var c = {
					data: {
						phone: vm.logPC+'-'+phone,
						password: vm.logPPass
					}
				};
			}
			vm.showLoading = true;
			AuthService.Login(c, function(response) {
				

				//console.log(response.content.tutorial.desktop);
				
				vm.showLoading = false;
				if(response.error) {
					vm.errMsg = response.message;
					$timeout(function(){
						vm.errMsg = null;
					}, 3000);
					vm.inputFocus(vm.loginType=='email'?'logEPass':'logPPass');
				} else {

					if(response.content.active){
						vm.reactivate_account = false;
					 	$cookieStore.put('active', true);
					}else{
						vm.reactivate_account = true;
					}

					if(response.content.tutorial.desktop=='1'){
						$cookieStore.put('end_tour_search_activity',true);
						$cookieStore.put('end_tour_create_post',true);
					}

					SettingService.getLanguage().then(function(data) {
						var lang_code = ['', 'en', 'id'];
						$translate.use(lang_code[data.content.language]);
						$cookieStore.put('language', data.content.language);
					});

					vm.showLoading = true;
					vm.profile_completed = response.content.profile_completed;
					SettingService.getSettings().then(function(data) {
									vm.active_account = data.content.list_setting.edit_account.active;
									if(vm.reactivate_account) {
										$state.transitionTo('reactivate-account');
									}else{ 
										if(vm.profile_completed){
											var last = $rootScope.last;
//											if($rootScope.last.state.name=='detail-page' && $rootScope.last.params['post_id']!=undefined)
//											{
//												$state.transitionTo('detail-page',{'post_id':$rootScope.last.params.post_id});
//											}
//											else
											{
												$state.transitionTo('timeline');
											}
							} else {
								$state.transitionTo('create-avatar');
							}
						}
					});
				}
			});
		}
		
		function register() {
			var ref = $stateParams.ref;
			var popcon = $state.current.name=='popcon'?1:0;
			if(vm.registerType == 'email') {
				var c = {
					data: {
						email: vm.regEmail,
						password: vm.regEPass,
						info: popcon,
						referral_id: ref
					}
				};
			} else {
				var phone = '';
				if(vm.regPhone){
					var pclen = vm.regPC.length;
					phone = vm.regPhone;
					if(phone.charAt(0) == '0'){
						phone = phone.substr(1);
					} else if(phone.substring(0,pclen) == vm.regPC){
						phone = phone.substr(pclen);
					} else {
						phone = phone;
					}
				}
				var c = {
					data: {
						phone: vm.regPC+'-'+phone,
						password: vm.regPPass,
						info: popcon
					}
				};
			}
			if(vm.registerType == 'email' && !vm.isEmailValidated) {
				vm.errMsg = 'Email tidak valid';
			} else if(vm.registerType == 'phone' && !vm.isPhoneValidated) {
				vm.errMsg = 'Phone tidak valid';
			} else if(!vm.isPassValidated) {
				vm.errMsg = 'Password tidak valid';
			} else {
				vm.showLoading = true;
				AuthService.Register(c, function(response) {
					$cookieStore.put('active', true);
					vm.showLoading = false;
					if(response.error) {
						if(vm.registerType == 'email') {
							vm.errMsg = response.message;
						} else {
							vm.errMsg = response.message;
						}
						$timeout(function(){
							vm.errMsg = null;
						}, 3000);
						vm.inputFocus(vm.registerType=='email'?'regEmail':'regPhone');
					} else {
						$state.transitionTo('create-avatar');
						
					}
				});
			}
			$timeout(function(){
				vm.errMsg = null;
			}, 3000);
			vm.inputFocus(vm.registerType=='email'?'regEmail':'regPhone');
		}
		
		function forgotPassword() {
			if(vm.forPassType == 'email') {
				var c = {
					data: {
						email: ''+vm.forPassEmail+''
					}
				};
			} else {
				var phone = '';
				if(vm.fpPhone){
					var pclen = vm.fpPC.length;
					phone = vm.fpPhone;
					if(phone.charAt(0) == '0'){
						phone = vm.fpPC+'-'+phone.substr(1);
					} else if(phone.substring(0,pclen) == vm.fpPC){
						phone = vm.fpPC+'-'+phone.substr(pclen);
					} else {
						phone = vm.fpPC+'-'+phone;
					}
				}
				var c = {
					data: {
						phone: ''+phone+''
					}
				};
			}
				
			vm.showLoading = true;
			CiayoService.Api('password', c, function(response){
				vm.showLoading = false;
				if(response.data.c.data.error){
					vm.errMsg = response.data.c.data.message;
					if(vm.forPassType == 'email'){
						vm.errMsg = vm.errMsg.email[0] || 'unknown error';
					} else {
						vm.errMsg = vm.errMsg.phone[0] || 'unknown error';
					}
					$timeout(function(){
						vm.errMsg = null;
					}, 3000);
					vm.inputFocus(vm.forPassType=='email'?'fpEmail':'fpPhone');
				} else {
					vm.fpNotif = true;
					var bd = angular.element('body');
					bd.addClass('modal-is-open');
				}
			});
		}
		
		function closeFPNotif() {
			vm.fpNotif = false;
			var bd = angular.element('body');
			bd.removeClass('modal-is-open');
		}
		
		function resetPassword() {
			var token = $stateParams.token; // nanti get token yta
			if(vm.isRePassValidated){
				var c = {
					data: {
						password: vm.newPass,
						confirm_password: vm.rePass,
						password_token: token
					}
				};
				
				CiayoService.Api('password/change', c, function(response){
					if(response.status == 200){
						var data = response.data.c.data;
						modalFactory.message(data.message);
						$state.go('welcome');
					} else {
						modalFactory.message(response.status+': '+response.statusText);
					}
				});
			} else {
				modalFactory.message('Password Tidak Sama');
			}
		}
		
		// logout keun hela
		function logout() {
			AuthService.Logout();
		}
		
		function inputFocus(el) {
			$('input[name='+el+']').removeClass('error');
			$timeout(function(){
				$('input[name='+el+']').focus();
			},250);
		}
		
		function selectElement(el) {
			return angular.element(document.querySelectorAll(el));
		}
		
		// funcgsi get phone code
		function getPhoneCode() {
			var c = {
				data: {
				}
			};
			
			CiayoService.Api('users/setting/prefix_phone_number', c, function(response){
				vm.listPhoneCode =	response.data.c.data.content.list_prefix_phone_number;
				//console.log(vm.listPhoneCode);
			});
		}

		function homePopupToggle() {
			if($cookieStore.get('homePopup') === false)
				angular.element('.homepage-popup').css({'opacity': '0', 'visibility': 'hidden'});
			else {
				angular.element('.homepage-popup').css({'opacity': '1', 'visibility': 'visible','text-align':'center'});
				$cookieStore.put('homePopup',false);
			}
		}
		
		getPhoneCode();

		var lang_code = ['', 'en', 'id'];
		function changeLang(id) {
			$translate.use(lang_code[id]);
			$cookieStore.put('language', id);
			SettingService.changeLanguage(id, function(response) {
				getLanguage();
			});
			vm.open_lang = false;
			if(id==1) {
				vm.current_lang = 'English';
			} else {
				vm.current_lang = 'Bahasa Indonesia';
			}
		}

		function getLanguage() {
			SettingService.getLanguage().then(function(data) {
				vm.language=data.content.language;
				if(vm.language==1) {
					vm.current_lang = 'English';
				} else {
					vm.current_lang = 'Bahasa Indonesia';
				}
			});
		}

		getLanguage();

	}
})();

/*

- kalo bisa fungsi jangan di taro di onclick, tapi tari di query selector

*/;
(function() {
	'use strict';

	angular
		.module('app')
		.directive('achievementItem', achievementItem);

	achievementItem.$inject = [];
	function achievementItem() {
		var directive = {
				//bindToController: true,
				//controller: ControllerController,
				//controllerAs: 'vm',
				link: link,
				restrict: 'A',
				scope: {
				}
		};
		return directive;
		
		function link(scope, element, attrs) {
			angular.element(document).ready(function(){
				setTimeout(function(){
					drawRing(attrs.$$element.context);
				},1);
			});
		}

		function drawRing(el,radius,txt,pct,end){
			var ctx=el.getContext('2d');
			radius = radius || parseInt(el.getAttribute('data-radius')) || 50;
			pct = pct || parseInt(el.getAttribute('data-pct-start')) || 0;
			end = end || parseInt(el.getAttribute('data-pct-end')) || 0;
			txt = txt || el.getAttribute('data-show-text') || false;
			var r=radius*0.8,
					left=radius,
					top=radius*55/50,
					line_width=radius*3/50,
					tw=radius*35/50,th=radius*16/50,
					tx=left-r+radius*22/50,ty=top-r-th/2,
					tr=radius*2/50,
					box_line_width=radius*3/50,
					text=pct+'%',
					font_size=radius*12/50;
			ctx.clearRect(0,0,500,500);
			ctx.lineWidth = line_width;
			ctx.strokeStyle = '#CCE1EC';
			ctx.beginPath();
			ctx.arc(left, top, r,	0, 2 * Math.PI);//x,y ada di tengah lingkaran
			ctx.stroke();
			ctx.strokeStyle = '#49A8DC';
			ctx.beginPath();
			ctx.arc(left, top, r,	-0.5*Math.PI, ((pct/100)*2-0.5) * Math.PI);
			ctx.stroke();
			if(txt){
				ctx.save();
				ctx.beginPath();
				ctx.fillStyle = "white";
				ctx.lineWidth=box_line_width;
				ctx.moveTo(tx+tr, ty);//20,10 tx+tr,
				ctx.lineTo(tx+tw-tr, ty);//80,10
				ctx.quadraticCurveTo(tx+tw, ty, tx+tw, ty+tr);//90,10,90,20
				ctx.lineTo(tx+tw, ty+th-tr);//90,80
				ctx.quadraticCurveTo(tx+tw, ty+th, tx+tw-tr, ty+th);//90,90,80,90
				ctx.lineTo(tx+tr, ty+th);//20,90
				ctx.quadraticCurveTo(tx, ty+th, tx, ty+th-tr);//10,90,10,80
				ctx.lineTo(tx, ty+tr);//10,20
				ctx.quadraticCurveTo(tx, ty, tx+tr, ty);//10,10,20,10
				ctx.stroke();
				ctx.fill();
				ctx.restore();
				
				ctx.fillStyle = '#02679E';
				ctx.font = font_size+"px Arial";
				ctx.textAlign = "center";
				ctx.fillText(text,left,top-r+th/2-tr*2);
			}
			pct+=1;
			if(pct<=end){
				setTimeout(function(){drawRing(el,radius,txt,pct,end);},20);
			}
		}
		
	}
})();;
+ function () {
	"use strict";
	angular
		.module("CiayoCard", ['angular-click-outside'])
		.directive("cCard", function ($rootScope, modalFactory) {
			return {
				restrict: "E",
				scope: {
					post: '=',
					index: '=',
					trending: '=',
					detail: '='
				},
				replace: true,
				template: '<div class="c-tml-row" ng-include="getTemplateUrl()"></div>',
				controller: 'PostController'
			}
		})
		.directive('cCardRight', function ($rootScope, modalFactory) {
			return {
				restrict: "E",
				replace: true,
				templateUrl: 'app/directives/views/card-right.html',
				controller: function ($scope, PostService, ConnectionService, listService, ProfileService, facebookFactory) {
					angular.extend(
						$scope, {
							onEditComment: false,
							commentEditOpen: commentEditOpen,
							commentEditClose: commentEditClose,
							commentEditCloseKey:commentEditCloseKey,
							with: {
								text: "",
								isActive: false,
								search_list: Object.create(listService)
							}
						}
					);
					init();

					function init() {
						if($scope.post.isPublic==undefined){
							PostService.postAttributes(
								function () {
									$scope.permission_list = PostService.permission_list;
								},
								function (response) {
									console.log(response);
								}
							)
						}
					}
					//post
					$scope.deletePost = function (post_id, $index) {
						$rootScope.$broadcast('card.delete', $scope.post);
					}
					$scope.unsubscribePost = function (post) {
							PostService.unsubscribePost(post.post_id, function (response) {
								var data = response.data.c.data;
								if (data.error == false && data.content.status == 'success') {
									post.unsubscribe = true;
								}
								modalFactory.message(data.message);
							}, function (response) {});
						}
					$scope.subscribePost = function (post) {
							PostService.subscribePost(post.post_id, function (response) {
								var data = response.data.c.data;
								if (data.error == false && data.content.status == 'success') {
									post.unsubscribe = false;
								}
								modalFactory.message(data.message);
							}, function (response) {});
						}
						//reaction
					$scope.postReaction = function (post_id, reaction) {
						if(post_id==1){modalFactory.message('Reaction disabled');return;}
						PostService.postReaction(post_id, reaction, function (response) {
							var data = response.data.c.data;
							if (data.error == false) {
								$scope.post.reaction = data.content;
								$scope.reactionDetail(post_id);
							}
						}, function (response) {

						});
					}
					

					//comment
					$scope.reportComment = function (post_id, comment_id, content) {
						PostService.reportComment(
							post_id, comment_id, content,
							function (response) {
								var data = response.data.c.data;
								if (data.error == false) {
									modalFactory.message('Berhasil Report');
								}
							},
							function (response) {

							}
						)
					}

					function commentEditOpen( comment) {
						comment.on_edit=true;
//						angular.element(obj.target.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode).addClass('active');
						comment.old_content = comment.content;
						$scope.onEditComment = true;
					}
					function commentEditCloseKey($event,comment) {
						if ($event.keyCode == 27) {
							commentEditClose(comment);
						}
					}
					function commentEditClose(comment) {
						comment.on_edit=false;
						comment.content = comment.old_content;
//						if (key == 27) {
//							angular.element(obj.target.parentNode.parentNode.parentNode).removeClass('active');
//						}
						$scope.onEditComment = false;
					}
					
					
					//permission
					$scope.updatePermission = function (post_id, permission_id) {
							PostService.updatePermission(
								post_id, permission_id,
								function (response) {
									var data = response.data.c.data;
									if (data.error == false) {
										//modalFactory.message('Berhasil Update Permission');
									}
									modalFactory.message(data.message);
								},
								function (response) {

								}
							)
						}
						//with
					$scope.withDetail = function (post_id) {
						PostService.loadWith(post_id, function (response) {
							var data = response.data.c.data;
							if (data.error == false) {
								$scope.post.with = data.content.data;
								$scope.with.search_list.reset();
							}
						}, function (response) {

						});
					}
					$scope.withRemove = function (_with) {
						$scope.post.with.splice($scope.post.with.indexOf(_with), 1);
					}
					$scope.withUpdate = function (post_id, _with) {
						var withs = [];
						angular.forEach(_with,function(value,key){
							withs.push({id:value.user_id,username:value.username});
						});
						PostService.updateWith(post_id, withs, function (response) {
							var data = response.data.c.data;
							if (data.error == false) {
								$scope.post.with = data.content.data;
								$scope.post.with_count = data.content.data.length;
								$scope.post.with_detail.with_user_count = data.content.data.length;
								if(data.content.data.length==0){
									$scope.post.with_detail.with_status.value=-1;
								}else{
									$scope.post.with_detail.with_status.value=0;
								}
							}
						}, function (response) {

						});
					}
					$scope.withSearch = function () {
						if ($scope.with.text.length > 1) {
							ProfileService.searchFriend($scope.with.text, 20, 0, function (response) {
								$scope.with.search_list.list = response.data.c.data.content.list_user;
							}, function (response) {
								console.log(response);
							});
						}
					}
					$scope.withSelect = function ($index) {
						$scope.with.text = null;
						var selected = $scope.with.search_list.getSelectedItem();
						$scope.post.with.push({
							user_id: selected.user_id,
							username: selected.username,
							'user_display_name': selected.user_display_name,
							user_avatar_thumbnail: selected.user_avatar_thumbnail,
							user_avatar_detail: selected.user_avatar_detail
						})
						$scope.with.search_list.reset();
					}
					$scope.withKeydown = function ($event, $index) {
						if ($event.keyCode === 40) {
							$event.preventDefault();
							$scope.with.search_list.next();
						} else if ($event.keyCode === 38) {
							$event.preventDefault();
							$scope.with.search_list.prev();
						} else if ($event.keyCode === 13) {
							$scope.withSelect($index);
						}
					}

					//caption
					$scope.updateCaption = function (post_id, post_caption, bubble) {
							PostService.updateCaption(post_id, post_caption, bubble, function (response) {
								var data = response.data.c.data;
								if (data.error == false) {
									$scope.post.with = data.content.data;
									$scope.post.activity_detail.old_caption = post_caption;
								}
							}, function (response) {
								
							});
						}
						//C Button
					$scope.requestFollow = function (user_id, follow, post) {
						console.log(post);

						ConnectionService.requestFollow(user_id, follow, function (response) {
							var data = response.data.c.data;
							console.log(data);
							if (data.error == false) {
								//modalFactory.message('Berhasil');
								post.user_status.follow = follow;
							}
						}, function (response) {
						});
					}
					$scope.requestFriend = function (user_id, category_id) {
							ConnectionService.requestCreate(user_id, category_id, function (response) {
								var data = response.data.c.data;
								if (data.error == false) {
									modalFactory.message('Berhasil');
								}
								modalFactory.message(data.message);
							}, function (response) {

							});
						}
						//jquery, etc
					$("._reaction").on({
						mouseover: function () {
							$(this).addClass('-roll');
							$(this).off('animationiteration webkitAnimationIteration', move);
						},
						mouseleave: function () {
							$(this).on('animationiteration webkitAnimationIteration', move);
						}
					});

					function move() {
						$(this).removeClass("-roll");
					}

				}
			}
		})

	.directive("cardActivityToggle", function () {
		return {
			restrict: "E",
			link: function (scope, elem, attrs) {
				elem.on("click", function () {
					if (attrs.clickable) {
						$(this).parent().siblings().removeClass('-active');
						$(this).parent().addClass('-active');
					}
				})
			}
		}
	})

	.directive("toggleActivityClose", function () {
		return {
			restrict: "A",
			scope: {},
			link: function (scope, elem, attrs) {
				elem.on("click", function () {
					$(this).parent().siblings().removeClass('-active');
				});
			}
		}
	})

	.directive("toggleCardOption", function () {
		return {
			restrict: "A",
			scope: {},
			link: function (scope, elem, attrs) {
				elem.on("click", function () {
					if (attrs.toggleCardOption === "close") {
						$(this).closest("card-option-pane").removeClass("-active");
						$(this).closest("card-option-pane").siblings("card-option-button").removeClass("-shift");
					} else {
						$(this).closest("card-option-button").addClass("-shift");
						$(this).closest("card-option").children("." + attrs.toggleCardOption).addClass("-active")
					}
				});
			}
		}
	})

	.directive("cardTabToggle", function () {
		return {
			restrict: "E",
			link: function (scope, elem, attrs) {
				elem.on("click", function () {scope.getDownloadImage();
					var activating = $(this).parent();
					var previously = $(this).parent().siblings('.-active');

					if ($(previously).index() >= 0) {
						$(previously).removeClass('-active');
						$(activating).addClass('-active');
						$(this).parent().siblings('card-tab-active').css({
							"top": $(this).position().top,
							"height": $(this).height()
						});
					}
				});
			}
		}
	})

	.directive("toggleCardComment", function () {
		return {
			restrict: "A",
			link: function (scope, elem, attrs) {
				elem.on("click", function (e) {
					e.preventDefault();
					if (attrs.toggleCardComment === "open") {
						$(this).closest("card-comment-block").css("left", "-100%")
						$(this).closest("card-comment-block").siblings("card-comment-nested").css("left", "0")
					}

					if (attrs.toggleCardComment === "back") {
						$(this).closest("card-comment-nested").css("left", "100%")
						$(this).closest("card-comment-nested").siblings("card-comment-block").css("left", "0")
					}
				})
			}
		}
	})

	.directive('cSticker', function () {
		return {
			restrict: 'E',
			templateUrl: 'app/directives/views/card-sticker.html',
			replace: true,
			link: function () {

			},
			controllerAs: 'me',
			controller: function ($scope, $element, StoreService, PostService) {
				var me = this; //console.log($element.closest('._sticker').addClass('asd'));
				angular.extend(me, {
					emojiCollection: [],
					class: '',
					init: init,
					close:close,
					open:open,
					loadStickerCollection: loadStickerCollection,
					loadEmojiCollection: loadEmojiCollection,
					loadStickerDetail: loadStickerDetail,
					loadEmojiDetail: loadEmojiDetail,
					closeModal: closeModal,
					comment: comment
				});

				function init() {
					console.log(me);
					if (me.class == '') {
						open();
						loadStickerCollection();
						loadEmojiCollection();
					} else {
						close();
					}
				}
				function close(){
					me.class='';
				}
				function open(){
					me.class = '-open';
				}
				function loadStickerCollection() {
					StoreService.getUserStickerCollection(
						0, 20,
						function () {
							me.stickerCollection = StoreService.stickerCollection;
							console.log(StoreService.stickerCollection);
							if (me.stickerCollection.length > 0)
								loadStickerDetail(me.stickerCollection[0]);
						},
						function (response) {
							console.error(response);
						}
					)
				}

				function loadEmojiCollection() {
					StoreService.getUserEmojiCollection(
						0, 20,
						function () {
							me.emojiCollection = StoreService.emojiCollection;
							if (me.emojiCollection.length > 0)
								loadEmojiDetail(me.emojiCollection[0]);
						},
						function (response) {
							console.error(response);
						}
					)
				}

				function loadStickerDetail(collection) {
					var index = me.stickerCollection.indexOf(collection);
					StoreService.getUserStickerDetail(
						collection,
						function (data) {
							me.stickerCollection = StoreService.stickerCollection;
						},
						function (response) {
							console.error(response);
						}
					)
				}

				function loadEmojiDetail(collection) {
					var index = me.emojiCollection.indexOf(collection);
					StoreService.getUserEmojiDetail(
						collection,
						function (data) {
							me.emojiCollection = StoreService.emojiCollection;
						},
						function (response) {
							console.error(response);
						}
					)
				}

				function comment(collection, type) {
					if ($scope.post.comment_text == undefined) {
						$scope.post.comment_text = '';
					}
					if (type == 1) {
						$scope.commentCreate($scope.post, collection.shortcode_format, $scope.commentReply)
						$scope.post.comment_count += 1;
					} else
					if (type == 2) {
						$scope.post.comment_text += collection.shortcode_format;
					}
					me.class = '';

				}

				function closeModal() {
					console.log('close');
					me.class = '';
				}
			}
		}
	});
	
	
}();;
/*global angular, navigator*/
//https://github.com/IamAdamJowett/angular-click-outside
(function() {
    'use strict';

    angular
        .module('angular-click-outside', [])
        .directive('clickOutside', ['$document', '$parse', '$timeout', clickOutside]);

    function clickOutside($document, $parse, $timeout) {
        return {
            restrict: 'A',
            link: function($scope, elem, attr) {

                // postpone linking to next digest to allow for unique id generation
                $timeout(function() {
                    var classList = (attr.outsideIfNot !== undefined) ? attr.outsideIfNot.split(/[ ,]+/) : [],
                        fn;

                    // add the elements id so it is not counted in the click listening
                    if (attr.id !== undefined) {
                        classList.push(attr.id);
                    }

                    function eventHandler(e) {
                        var i,
                            element,
                            r,
                            id,
                            classNames,
                            l;

                        // check if our element already hidden and abort if so
                        if (angular.element(elem).hasClass("ng-hide")) {
                            return;
                        }

                        // if there is no click target, no point going on
                        if (!e || !e.target) {
                            return;
                        }

                        // loop through the available elements, looking for classes in the class list that might match and so will eat
                        for (element = e.target; element; element = element.parentNode) {
                            id = element.id,
                            classNames = element.className,
                            l = classList.length;

                            // Unwrap SVGAnimatedString classes
                            if (classNames && classNames.baseVal !== undefined) {
                                classNames = classNames.baseVal;
                            }

                            // if there are no class names on the element clicked, skip the check
                            if (classNames || id) {

                                // console.log('classNames: ' + classNames);

                                // loop through the elements id's and classnames looking for exceptions
                                for (i = 0; i < l; i++) {
                                    //prepare regex for class word matching
                                    r = new RegExp('\\b' + classList[i] + '\\b');

                                  //  console.log('classList: ' + classList[i]);

                                    // check for exact matches on id's or classes, but only if they exist in the first place
                                    if ((id !== undefined && id === classList[i]) || (classNames && r.test(classNames))) {
                                        // now let's exit out as it is an element that has been defined as being ignored for clicking outside
                                        return;
                                    }
                                }
                            }
                        }

                        // if we have got this far, then we are good to go with processing the command passed in via the click-outside attribute
                        $scope.$apply(function() {
                            fn = $parse(attr['clickOutside']);
                            fn($scope);
                        });
                    }

                    // if the devices has a touchscreen, listen for this event
                    if (_hasTouch()) {
                        $document.on('touchstart', eventHandler);
                    }

                    // still listen for the click event even if there is touch to cater for touchscreen laptops
                    $document.on('click', eventHandler);

                    // when the scope is destroyed, clean up the documents event handlers as we don't want it hanging around
                    $scope.$on('$destroy', function() {
                        if (_hasTouch()) {
                            $document.off('touchstart', eventHandler);
                        }

                        $document.off('click', eventHandler);
                    });

                    // private function to attempt to figure out if we are on a touch device
                    function _hasTouch() {
                        // works on most browsers, IE10/11 and Surface
                        return 'ontouchstart' in window || navigator.maxTouchPoints;
                    };
                });
            }
        };
    }
})();
;
(function() {
	'use strict';

	angular
		.module('app')
		.directive('compile', compile);

	compile.$inject = ['$compile'];
	function compile($compile) {
		return function(scope, element, attrs) {
			scope.$watch(
				function(scope) {
						// watch the 'compile' expression for changes
					return scope.$eval(attrs.compile);
				},
				function(value) {
					// when the 'compile' expression changes
					// assign it into the current DOM
					element.html(value);

					// compile the new DOM and link it to the current
					// scope.
					// NOTE: we only compile .childNodes so that
					// we don't get into infinite loop compiling ourselves
					$compile(element.contents())(scope);
				}
			);
		};
	}
})();;
(function() {
	'use strict';

	angular
		.module('app')
		
		.directive('toggleZoom', function(){
			return {
				restrict: "A",
				link: function(scope, elem, attr){
					elem.on('click', function(e){
						e.preventDefault();
						if(elem.children().hasClass('ci-zoom-out')){
							elem.parent().addClass('zoom-out');
							elem.children().removeClass('ci-zoom-out');
							elem.children().addClass('ci-zoom-in');
						} else{
							elem.parent().removeClass('zoom-out');
							elem.children().removeClass('ci-zoom-in');
							elem.children().addClass('ci-zoom-out');
						}
					});
				}
			}
		})
})();;
+function(){ "use strict";
	angular
		.module("CiayoFriendConnection",['ngMaterial'] )
		.directive('cFriendConnection',function() {
			return {
				restrict: "E",
				scope:{user:'=',type:'@'},
				replace:true,
				templateUrl:'app/directives/views/friend-connection.html',
				controller:'FriendConnectionController',
				controllerAs:'vm'
			};
		});
}();
;
+function(){ "use strict";
	angular
		.module("CiayoHeader",['ngMaterial'] )
		.directive('cHeader',function() {
			return {
				restrict: "E",
				scope:{data:'=','type':'@'},
				replace:true,
				templateUrl:'app/directives/views/header.html',
				controller:function ($cookieStore, $state,$stateParams, $scope, $mdDialog, $mdMedia, $rootScope, $http, $location, listService, ProfileService, ConnectionService, CiayoService, modalFactory, facebookFactory ) {
					$scope.with={
						text:"",
						isActive:false,
						search_list:Object.create(listService)
					}


					//WITH
					$scope.start_notification_popup = false;
					$scope.notification_popup_all=[];

					$scope.invitationFacebook = function(){
						var access_token = '';
						var uid = '';
						//alert('test');
						facebookFactory.getToken(function (data) {
							//console.log(data);
							access_token = data.accessToken;
							uid = data.uid;

							ConnectionService.shareFacebook(access_token, uid, function(response){
								//console.log(response);
								modalFactory.message('Your message has been sent');
							
							},function(response){
								//console.log(response);
							});
							
						});
					}

					$scope.modalInviteEmail = function(){
						modalFactory.inviteEmail();
					}

					$scope.modalInviteGmail = function(){
						modalFactory.inviteGmail('');

						var config = {
					      	'client_id': '788891428909-o4a2s2hht5jud5at66crv1je57f9198i.apps.googleusercontent.com',
					      	'scope': 'https://www.google.com/m8/feeds'
					    };
					    gapi.auth.authorize(config, function() {
					       	fetch(gapi.auth.getToken());
					    });
					}

					function fetch(token) {
					    $.ajax({
						    url: "https://www.google.com/m8/feeds/contacts/default/full?access_token=" + token.access_token + "&alt=json",
						    dataType: "jsonp",
						    success:function(data) {
						    	//factory.modal_item2 = true;   
						        //console.log(JSON.stringify(data));
						  		var data_json = data;
						        //console.log(data_json);
								var entry_data = data_json.feed.entry;

								var email_list = [];

								//factory.email_name = data_json.feed.author.name;
								
								for(var i=0; i<entry_data.length; i++){
								 	if(entry_data[i].gd$email){
								 		var email = entry_data[i].gd$email[0].address;

								 		email_list.push({address: email});
								 		
								 	}
								}	  

								modalFactory.inviteGmail(email_list);   
			 

						    }
						});
					}

					$scope.searchWith=function(){
							$scope.gg = true;
						if($scope.with.text.length>0){
							ProfileService.searchUser ($scope.with.text, 10, 0,function(response){
								
								$scope.gg = false;
								$scope.with.search_list.list=response.data.c.data.content.list_user;
							},function(response){
								console.log(response);
							});
						}else{
							 	 	$scope.suggestions=[];
							$scope.gg = false;
						}
					}

					$scope.close_search_user=function(){
						$scope.with.search_list.list = [];
						$scope.with.text = [];
					}

					$scope.getNotificationNumber=function(){
						
					}
					
					$scope.keydownWith=function($event,$index){
						if($event.keyCode === 40){
								$event.preventDefault();
								$scope.with.search_list.next();
							}
							else if($event.keyCode === 38){
									$event.preventDefault();
									$scope.with.search_list.prev();
							}
							
					}
					$scope.notification_setting=function(){
						
						$state.go('setting', { 'menu': 'notification' },{reload:true});
					}

					$scope.friend_request_find_friend=function(){
						
						$state.go('profile',{},{reload:true});
					}
										
										$scope.setting=function(){
						
						$state.go('setting', { 'menu': '' },{reload:true});
					}

					$scope.trending=function(){
						
//						$state.go('trending', {'menu': 'trending' });
					}

					

					$scope.notification_mark_all=function(){
						
						if($scope.notification_popup_all.length>0){

									ConnectionService.requestMarkAllNotification (function(response){
										//console.log(response);

										angular.forEach($scope.notification_popup_all,function(value,key){
											$scope.notification_popup_all[key].read_at = 1;
										});

										/*$mdDialog.show(
												$mdDialog.alert()
													.clickOutsideToClose(true)
													.title('Mark all notification')
													.textContent('Successfully')
													.ok('Done')
											);*/
											
										$scope.notification_count=0;


									},function(response){
										//console.log(response);
									});
						}else{
							$mdDialog.show(
												$mdDialog.alert()
													.clickOutsideToClose(true)
													.title('Sorry you dont have any notification')
													.ok('Ok')
											);
						}
					}

					$scope.notification_delete=function(index){

						// modalFactory.confirm(
						// 	'Are you sure want to delete this notification ?',
						// 	function(response){
						// 		if(response){
									var id = $scope.notification_popup_all[index].notification_id;
									var type = $scope.notification_popup_all[index].type;

									ConnectionService.requestDeleteNotification (id, type, function(response){
										$scope.notification_popup_all.splice(index, 1);
										//get_notification_count("null", '1', 0);
									},function(response){
										console.log(response);
									});
						//		}
						//	}
						//);
						/*
									var id = $scope.notification_popup_all[index].notification_id;
									var type = $scope.notification_popup_all[index].type;

									ConnectionService.requestDeleteNotification (id, type, function(response){
										$scope.notification_popup_all.splice(index, 1);
										get_notification_count("null", '1', 0);
									},function(response){
										console.log(response);
									});
						*/
							
							
					}

					$scope.search_click = function(username){
						$state.go('profile', {user: username});
					}

					$scope.search_enter = function(){
						var search = $scope.with.text;
						if(search!='')
						$state.go('search-result', {search_text: search});
					}

					$scope.isNotificationOpen=false;
					$scope.toggle_notification = function(){
										
						$scope.isNotificationOpen=!$scope.isNotificationOpen;

						if($scope.notification_count>0){
								ConnectionService.requestMarkAllNotification (function(response){

									angular.forEach($scope.notification_popup_all,function(value,key){
										$scope.notification_popup_all[key].read_at = 1;
									});

								
									$scope.notification_count=0;

								},function(response){
									//console.log(response);
								});
						}
					}
							$scope.closeNotification = function(){
								$scope.isNotificationOpen=false;
								//$scope.notification_popup_all=[];
							}

							$scope.isFriendRequestOpen=false;
					$scope.toggle_friend_request = function(){
										
									 $scope.isFriendRequestOpen=!$scope.isFriendRequestOpen;
									
							}
							$scope.closeFriendRequest = function(){
								$scope.isFriendRequestOpen=false;
								//$scope.notification_popup_all=[];
							}
					
					/*
						$('html').click(function(e) {
									//check up the tree of the click target to check whether user has clicked outside of menu
									if(!$('#show_notification').is(e.target)){
										if(!$('.c-notification-popup').is(e.target)){
											if ($(".c-notification-popup").css('display')=='block' && !$('.c-notification-popup').is(e.target)){ 
												 $(".c-notification-popup").fadeOut(300);
											}
									}
								}
							})
							*/

					$scope.show_all_notification = function(){
						$state.go('notification');
					}

					$scope.show_all_friend_request = function(){
						$state.go('friend-request');
					}

					$scope.start_notification_popup = false;

					function get_notification_popup_all(type, limit, offset){
			
						ConnectionService.listNotification ( 
							type, limit, offset,
							function(response){//callback sucess
								//console.log(response.data.c.data.content);
								$scope.notification_popup_all = response.data.c.data.content.list_notification;
								$scope.start_notification_popup = true;
								$scope.notification_count = response.data.c.data.content.count_notif;

							},
							function(response){//err callback
								console.log(response);
							}
						);
					}
					get_notification_popup_all("null", '10', 0);

					$scope.view_notification = function(notification_all, index){
						
						//$(.).children(id).removeClass("active");
						//$state.go('profile', {user_id: id});
						var post_id = $scope.notification_popup_all[index].post_id;
						var read_at_real = $scope.notification_popup_all[index].read_at;
						var id = $scope.notification_popup_all[index].notification_id;
						var type = $scope.notification_popup_all[index].type;
						var username = $scope.notification_popup_all[index].username;
						var post_code = $scope.notification_popup_all[index].post_code;
						var from_name = $scope.notification_popup_all[index].from_user_display_name;


						
						if(read_at_real==null){

							var read_at = Number(new Date());

							ConnectionService.requestViewNotification (id, type, read_at, function(response){
								console.log(response);
								//alert("Halaman detail post id : " + post_id);
								$scope.notification_popup_all[index].read_at = 1;

								if(type=="friend_request" || type == "follow_request" || type == "added_friend"){
									$state.go('profile', {user: username});
								}else if(type=="ask_with"){
									modalFactory.withCard(post_id, post_code,from_name);
								}else if(type=="ask_place"){
									modalFactory.placeCard(post_id, post_code,from_name);
									
								}else{
									if($stateParams.post_id==post_code){
										$state.reload()
									}else
									$state.go('detail-page', {post_id: post_code});
								}

							},function(response){
								//console.log(response);
							});
						}else{
								if(type=="friend_request" || type == "follow_request" || type == "added_friend"){
									$state.go('profile', {user: username});
								}else if(type=="ask_with"){
									modalFactory.withCard(post_id, post_code,from_name);
								}else if(type=="ask_place"){
									modalFactory.placeCard(post_id, post_code,from_name);
								}else{
									if($stateParams.post_id==post_code){
										$state.reload()
									}else
									$state.go('detail-page', {post_id: post_code});
								}
						}
					}

					
					$scope.view_friend_request=function(username){
						$state.go('profile', {user: username});
					}

					$scope.init=function(){
//						ProfileService.userData = null;
						ProfileService.userInfo ('',function(response){
							angular.extend($scope,response);
							$scope.token_user_id = ProfileService.userData.user_id;
							run_socket();
						},function(response){
							console.log(response);
						});
					}
					$scope.init();

					$scope.format_date=function(date){

						date = date * 1000;
						if (typeof date !== 'object') {
									date = new Date(date);
							}

							var seconds = Math.floor((new Date() - date) / 1000);
							seconds = seconds + 230;
							var intervalType;

							var interval = Math.floor(seconds / 31536000);
							if (interval >= 1) {
									intervalType = 'year';
							} else {
									interval = Math.floor(seconds / 2592000);
									if (interval >= 1) {
											intervalType = 'month';
									} else {
											interval = Math.floor(seconds / 86400);
											if (interval >= 1) {
													intervalType = 'day';
											} else {
													interval = Math.floor(seconds / 3600);
													if (interval >= 1) {
															intervalType = "hour";
													} else {
															interval = Math.floor(seconds / 60);
															if (interval >= 1) {
																	intervalType = "minute";
															} else {
																	interval = seconds;
																	intervalType = "second";
															}
													}
											}
									}
							}

							if (interval > 1 || interval === 0) {
									intervalType += 's';
							}

							return interval + ' ' + intervalType + " ago";		
							
					
					} 

					// API friend-request popup 
					$scope.friend_request_popup=[];
					$scope.start_friend_request_popup = false;
					

					function getList_friend_request_popup(limit, offset){
			
						ConnectionService.listFriendRequest ( 
							limit, offset,
							function(response){//callback sucess
								//console.log(response.data.c.data.content);
								$scope.friend_request_popup = response.data.c.data.content.data;
								$scope.start_friend_request_popup = true;

								angular.forEach($scope.friend_request_popup,function(value,key){
									value.fr_accept_status = false;
									value.fr_reject_status = false;
									value.fr_default_status = true;
									value.fr_action_loading = false;
								});
							},
							function(response){//err callback
								console.log(response);
							}
						);
					}

					getList_friend_request_popup('10', 0);

					$scope.fr_action_accept = function(friend_popup, index){
						friend_popup.fr_action_loading = true;					

						var user_id = $scope.friend_request_popup[index].list_user.user_id;
						//alert(user_id);
						
						ConnectionService.requestConfirmFriendRequest(user_id, function(response){
							//console.log(response);
							friend_popup.fr_accept_status = true;
							friend_popup.fr_reject_status = false;
							friend_popup.fr_default_status = false;
							friend_popup.fr_action_loading = false;

							get_friend_request_count('1', 0);
							
						},function(response){
							//console.log(response);
						});
					
					}

					$scope.fr_action_reject = function(friend_popup, index){
						friend_popup.fr_action_loading = true;			

						var user_id = $scope.friend_request_popup[index].list_user.user_id;
						
						ConnectionService.requestRejectFriendRequest(user_id, function(response){
							//console.log(response);
							
							friend_popup.fr_accept_status = false;
							friend_popup.fr_reject_status = true;
							friend_popup.fr_default_status = false;
							friend_popup.fr_action_loading = false;

							get_friend_request_count('1', 0);
						},function(response){
							//console.log(response);
						});
						
					}

					$scope.fr_action_block = function(friend_popup, index){
						
						var user_id = $scope.friend_request_popup[index].list_user.user_id;
						
						ConnectionService.requestRejectFriendRequest(user_id, function(response){
							//console.log(response);
							
							$mdDialog.show(
								$mdDialog.alert()
								.clickOutsideToClose(true)
								.title('This account is successfully blocked')
								.ok('Done')
							);
							$scope.friend_request_popup.splice(index, 1);

						},function(response){
							//console.log(response);
						});
					}

					$scope.fr_view_profile = function(username){
						$state.go('profile', {user: username});
					}

					// get data count notification
					$scope.list_notification_count=[];
					$scope.notification_count=0;

					function get_notification_count(type, limit, offset){
			
						ConnectionService.listNotification ( 
							type, limit, offset,
							function(response){//callback sucess
								//console.log(response.data.c.data.content);
								$scope.notification_count = response.data.c.data.content.count_notif;
								if($scope.notification_count>99){
									$scope.notification_count = '99+';
								}
								//console.log($scope.notification_count);

							},
							function(response){//err callback
								console.log(response);
							}
						);
					}
					//get_notification_count("null", '1', 0);

					// get data count friend request
					$scope.list_friend_request_count=[];
					$scope.friend_request_count=0;

					function get_friend_request_count(limit, offset){
						$scope.friend_request_count=0;
						ConnectionService.listFriendRequest ( 
							limit, offset,
							function(response){//callback sucess
								
								$scope.friend_request_count = response.data.c.data.meta.total;
								if($scope.friend_request_count>99){
									$scope.friend_request_count == '99+';
								}
								//console.log($scope.friend_request_count);
								
							},
							function(response){//err callback
								console.log(response);
							}
						);
					}
					get_friend_request_count('1', 0);


					function show_popup_achievement(data){
						// if(data){
						// 	modalFactory.popup_achivement(data);
						// }
						//var data = ['66'];
						for(var i=0; i<data.length; i++){
							modalFactory.popup_achivement(data[i]);
						}

						//console.log(data);
					}

					//show_popup_achievement('');

					function run_socket(data){
						// socket commend				
						var socket = CiayoService.Socket();
						//console.log($scope.token_user_id);
						socket.emit('set_userid', $scope.token_user_id);
						socket.on('nf004', function(data){	
							//alert("ada");
						 	//console.log(data);
						 	//get_notification_count("null", '1', 0);
						 	$scope.notification_popup_all=[];
						 	get_notification_popup_all("null", '10', 0);
						});

						//socket popup achievement
						socket.on('ach001', function(data){	
							
							//console.log(data)
							show_popup_achievement(data);
							
						});

						//socket like
						socket.on('nf005', function(data){	
						//alert("ada");
						 	//console.log(data);
						 	//get_notification_count("null", '1', 0);
						 	$scope.notification_popup_all=[];
						 	get_notification_popup_all("null", '10', 0);
						});
						//socket ask response
						socket.on('ant001', function(data){
						 	$scope.notification_popup_all=[];
						 	get_notification_popup_all("null", '10', 0);
						});
						//socket confirm request friend
						socket.on('nf003', function(data){	
							//alert("ada");
						 	//console.log("berhasil conf");
						 	get_friend_request_count('1', 0);
						 	$scope.friend_request_popup=[];
						 	getList_friend_request_popup('10', 0);
						 	//get_notification_count("null", '1', 0);
						 	$scope.notification_popup_all=[];
						 	get_notification_popup_all("null", '10', 0);
						});
							
						//socket add friend
						socket.on('nf002', function(data){	
						//alert("ada");
						 	//console.log(data);
						 	get_friend_request_count('1', 0);
						 	$scope.friend_request_popup=[];
						 	getList_friend_request_popup('10', 0);
						 	//get_notification_count("null", '1', 0);
						 	$scope.notification_popup_all=[];
						 	get_notification_popup_all("null", '10', 0);
						});
					}
					
							
					var user_added_friend = $rootScope.$on(
						"user.added_friend",
						function(event, data) {
							get_friend_request_count('1', 0);
						 	$scope.friend_request_popup=[];
						 	getList_friend_request_popup('10', 0);	
							//console.log(event,data);
								
						}
					);

					var user_notification = $rootScope.$on(
							"user.notification",
							function(event, data) {
									//get_notification_count("null", '1', 0);
									get_notification_popup_all("null", '10', 0);
									
							}
					);
					var user_info_header = $rootScope.$on(
							"user.user_info_header",
							function(event, data) {
									//alert(data);
								 		$scope.profile[5].value = data;
								 		//$scope.init();
							}
					);

				}
			};
		});
}();
;
+function(){ "use strict";
	angular
		.module("CiayoHeaderPublic",['ngMaterial'] )
		.directive('cHeaderPublic',function() {
			return {
				restrict: "E",
				scope:{data:'=','type':'@'},
				replace:true,
				controllerAs:'vm',
				templateUrl:'app/directives/views/header-public.html',
				controller:function ($stateParams, $translate, SettingService, $timeout, AuthService, $cookieStore, $state, $scope, $mdDialog, $mdMedia, $rootScope, $http, $location, listService, ProfileService, ConnectionService, CiayoService, modalFactory ) {
					$scope.with={
						text:""
					}

					var vm = this;	
					vm.validateEmail = validateEmail;
					vm.isEmailValidated = false;
					vm.validatePassword = validatePassword;
					vm.isPassValidated = false;
					vm.checkPassword = checkPassword;
					vm.checkRePass = checkRePass;
					vm.isRePassValidated = false;
					vm.validatePhone = validatePhone;
					vm.isPhoneValidated = false;
					// error messsage
					vm.errMsg = '';


					$scope.action_button_state = function(id){
						$scope.button_state = id;
					}

					$scope.close_panel = function(){
						$scope.button_state = '';
					}

					function inputFocus(el) {
						$('input[name='+el+']').removeClass('error');
						$timeout(function(){
							$('input[name='+el+']').focus();
						},250);
					}
					vm.inputFocus = inputFocus;

					function validateEmail(name, val) {
						var email = val;
						var elem = selectElement('input[name='+name+']');
						
						if(email && email.match(/(?:[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/g)) {
							elem.removeClass('error');
							elem.addClass('success');
							
							vm.isEmailValidated = true;
						} else if(email){
							elem.removeClass('success');
							elem.removeClass('error');
							setTimeout(function(){
								elem.addClass('error');
							}, 1);
							
							vm.isEmailValidated = false;
						} else {
							elem.removeClass('success');
							elem.removeClass('error');
						}
					}
					
					function validatePassword(id){
						if(vm.registerType == 'email') {
							var pass = vm.regEPass;
						} else if(vm.registerType == 'phone') {
							var pass = vm.regPPass;
						} else {
							var pass = vm.newPass;
						}
						var len = selectElement('#'+id+' ul li:first-child .unchecked-circle');
						var char = selectElement('#'+id+' ul li:last-child .unchecked-circle');
						
						if ( pass.length > 7 ) {
								len.addClass('active');
								var re = /^[A-Za-z\d\!\@\#\$\%\^\*\{\[\}\}\:\;\,\.\?\+\-\_\=\~\']{8,}$/; 
								if ( re.exec(pass) ) {
									char.addClass('active');
									
									vm.isPassValidated = true;
								} else {
									char.removeClass('active');
									
									vm.isPassValidated = false;
								}
						} else {
								len.removeClass('active');
								char.removeClass('active');
								
								vm.isPassValidated = false;
						}
					}
					
					function checkPassword(name){
						var elem = selectElement('input[name='+name+']');
						if(vm.registerType == 'email') {
							var pass = vm.regEPass;
						} else if(vm.registerType == 'phone') {
							var pass = vm.regPPass;
						} else {
							var pass = vm.newPass;
						}
						
						if(pass && pass.match(/^[A-Za-z\d\!\@\#\$\%\^\*\{\[\}\}\:\;\,\.\?\+\-\_\=\~\']{8,}$/)) {
							elem.removeClass('error');
							elem.addClass('success');
						} else {
							elem.removeClass('success');
							elem.removeClass('error');
							setTimeout(function(){
								elem.addClass('error');
							}, 1);
						}
					}
					
					function checkRePass() {
						var elem = selectElement('input[name=rePass]');
						if((vm.newPass == vm.rePass) && vm.rePass) {
							elem.removeClass('error');
							elem.addClass('success');
							vm.isRePassValidated = true;
						} else {
							elem.removeClass('success');
							elem.removeClass('error');
							setTimeout(function(){
								elem.addClass('error');
							}, 1);
							vm.isRePassValidated = false;
						}
					}
					
					function validatePhone(name, val) {
						var phone = val;
						var elem = selectElement('input[name='+name+']');
						
						if(!isNaN(phone)) {
							elem.removeClass('error');
							elem.addClass('success');
							
							vm.isPhoneValidated = true;
						} else if(phone){
							elem.removeClass('success');
							elem.removeClass('error');
							setTimeout(function(){
								elem.addClass('error');
							}, 1);
							
							vm.isPhoneValidated = false;
						} else {
							elem.removeClass('success');
							elem.removeClass('error');
						}
					}

					vm.login = login;
					function login() {
						var username_url = $stateParams.user;
						//console.log(username_url);
						$cookieStore.remove('token');
						if(vm.loginType == 'email') {
							var c = {
								data: {
									email: vm.logEmail,
									password: vm.logEPass
								}
							};
						} else {
							var phone = '';
							if(vm.logPhone){
								var pclen = vm.logPC.length;
								phone = vm.logPhone;
								if(phone.charAt(0) == '0'){
									phone = phone.substr(1);
								} else if(phone.substring(0,pclen) == vm.logPC){
									phone = phone.substr(pclen);
								} else {
									phone = phone;
								}
							}
							var c = {
								data: {
									phone: vm.logPC+'-'+phone,
									password: vm.logPPass
								}
							};
						}
						vm.showLoading = true;
						AuthService.Login(c, function(response) {
							

							//console.log(response.content.tutorial.desktop);
							
							vm.showLoading = false;
							if(response.error) {
								vm.errMsg = response.message;
								$timeout(function(){
									vm.errMsg = null;
								}, 3000);
								vm.inputFocus(vm.loginType=='email'?'logEPass':'logPPass');
							} else {

								if(response.content.active){
									vm.reactivate_account = false;
								 	$cookieStore.put('active', true);
								}else{
									vm.reactivate_account = true;
								}

								if(response.content.tutorial.desktop=='1'){
									$cookieStore.put('end_tour_search_activity',true);
									$cookieStore.put('end_tour_create_post',true);
								}

								SettingService.getLanguage(function(response) {
									var lang_code = ['', 'en', 'id'];
									$translate.use(lang_code[response.data.c.data.content.language]);
									$cookieStore.put('language', response.data.c.data.content.language);
								});

								vm.showLoading = true;
								vm.profile_completed = response.content.profile_completed;
								SettingService.getSettings(function(response) {
												vm.active_account = response.data.c.data.content.list_setting.edit_account.active;
												if(vm.reactivate_account) {
													$state.transitionTo('reactivate-account');
												}else{ 
													if(vm.profile_completed){
														var last = $rootScope.last;
			//											if($rootScope.last.state.name=='detail-page' && $rootScope.last.params['post_id']!=undefined)
			//												{
			//												$state.transitionTo('detail-page',{'post_id':$rootScope.last.params.post_id});
			//											}
			//											else
														{
															//$state.transitionTo('profile-publics', {user: username_url});
															$state.reload();
														}
										} else {
											$state.transitionTo('create-avatar');
										}
									}
								});
							}
						});
					}	

					function forgotPassword() {
						if(vm.forPassType == 'email') {
							var c = {
								data: {
									email: ''+vm.forPassEmail+''
								}
							};
						} else {
							var phone = '';
							if(vm.fpPhone){
								var pclen = vm.fpPC.length;
								phone = vm.fpPhone;
								if(phone.charAt(0) == '0'){
									phone = vm.fpPC+'-'+phone.substr(1);
								} else if(phone.substring(0,pclen) == vm.fpPC){
									phone = vm.fpPC+'-'+phone.substr(pclen);
								} else {
									phone = vm.fpPC+'-'+phone;
								}
							}
							var c = {
								data: {
									phone: ''+phone+''
								}
							};
						}
							
						vm.showLoading = true;
						CiayoService.Api('password', c, function(response){
							vm.showLoading = false;
							if(response.data.c.data.error){
								vm.errMsg = response.data.c.data.message;
								//console.log(vm.errMsg);
								if(typeof vm.errMsg=='object'){

								
									if(vm.forPassType == 'email'){
										vm.errMsg = vm.errMsg.email[0] || 'unknown error';
									} else {
										vm.errMsg = vm.errMsg.phone[0] || 'unknown error';
									}
								}
								$timeout(function(){
									vm.errMsg = null;
								}, 3000);
								vm.inputFocus(vm.forPassType=='email'?'fpEmail':'fpPhone');
							} else {
								vm.fpNotif = true;
								var bd = angular.element('body');
								bd.addClass('modal-is-open');
							}
						});
					}

					vm.forgotPassword = forgotPassword;

					function register() {

						var ref = $stateParams.ref;
						var popcon = $state.current.name=='popcon'?1:0;
						if(vm.registerType == 'email') {
							var c = {
								data: {
									email: vm.regEmail,
									password: vm.regEPass,
									info: popcon,
									referral_id: ref
								}
							};
						} else {
							var phone = '';
							if(vm.regPhone){
								var pclen = vm.regPC.length;
								phone = vm.regPhone;
								if(phone.charAt(0) == '0'){
									phone = phone.substr(1);
								} else if(phone.substring(0,pclen) == vm.regPC){
									phone = phone.substr(pclen);
								} else {
									phone = phone;
								}
							}
							var c = {
								data: {
									phone: vm.regPC+'-'+phone,
									password: vm.regPPass,
									info: popcon
								}
							};
						}
						if(vm.registerType == 'email' && !vm.isEmailValidated) {
							vm.errMsg = 'Email tidak valid';
						} else if(vm.registerType == 'phone' && !vm.isPhoneValidated) {
							vm.errMsg = 'Phone tidak valid';
						} else if(!vm.isPassValidated) {
							vm.errMsg = 'Password tidak valid';
						} else {
							vm.showLoading = true;
							AuthService.Register(c, function(response) {
								$cookieStore.put('active', true);
								vm.showLoading = false;
								if(response.error) {
									if(vm.registerType == 'email') {
										vm.errMsg = response.message;
									} else {
										vm.errMsg = response.message;
									}
									$timeout(function(){
										vm.errMsg = null;
									}, 3000);
									vm.inputFocus(vm.registerType=='email'?'regEmail':'regPhone');
								} else {
									$state.transitionTo('create-avatar');
									
								}
							});
						}
						$timeout(function(){
							vm.errMsg = null;
						}, 3000);
						vm.inputFocus(vm.registerType=='email'?'regEmail':'regPhone');
					}

					vm.register = register;

					function selectElement(el) {
						return angular.element(document.querySelectorAll(el));
					}

					var login_first = $rootScope.$on(
						"login.header_public",
						function(event, data) {
							//console.log('ok');
							$scope.button_state = 2;
							//console.log($scope.button_state);
						}
					);




				}
			};
		});
}();
;
(function () {
	"use strict";
	angular
		.module("CiayoModal", [])
		.directive('toggleModal', function () {
		return {
			restrict : "A",
			link: function(scope, elem, attr){
				$(elem).on("click", function(e){
					e.preventDefault();
					function close(){
						$(document.body).removeAttr("style");
						$('.c-modal').removeClass('-open');
					}
					if(attr.toggleModal === "close"){
						close();
					} else{
						close();
						$(document.body).css("overflow", "hidden");
						$('#' + attr.toggleModal).addClass('-open');
					}
				})
			}
		}
	})
		.directive('cModal',cModal)
		.factory('modalFactory', modalFactory)
	;

	modalFactory.$inject = ['$rootScope','$window','$filter','PostService','ProfileService', 'AchievementService', 'facebookFactory','SettingService', 'CiayoService'];
	function cModal() {
		return {
			'restrict' : 'E',
			'replace' : true,
			'templateUrl' : 'app/directives/views/modal-template.html',
			controller:cModalCtrl,
			controllerAs:'me'
		}
		function cModalCtrl($scope,$compile){
			var me=this;
			angular.extend(me,{
				isOpen:'',
				template:'',
				close:close
			});
			$scope.$on('modal.open', function(event, args) {
				parse(args);
				open();
			});
			function parse(args){
				if(args['template']!=undefined){
					me.template=args.template;
					if(args.class==undefined){
						me.class='layout-align-center-center layout-column';
					}else{
						me.class=args.class;
					}
					me.data=args.data;
				}else{
					console.error('Modal must have template');
				}

			}
			function open(){
				me.isOpen='-open';
				angular.element('body').css("overflow", "hidden");
			}
			function close(){
				me.isOpen='';
				me.template=null;
				angular.element('body').removeAttr("style");
			}

		
		}
	}
	function modalFactory($rootScope,$window,$filter,PostService,ProfileService, AchievementService, facebookFactory, SettingService, CiayoService) {
		var factory = {
			message:message,
			confirm:confirm,
			inviteEmail: inviteEmail,
			inviteGmail: inviteGmail,
			withCard:withCard,
			placeCard:placeCard,
			card:card,
			tagFriend:tagFriend,
			tagPlace:tagPlace,
			popup_achivement:popup_achivement
		};
		return factory;

		function message(message){
			$rootScope.$broadcast(
				'modal.open',
				{
					'template':'app/directives/views/modal-message.html',
					'data':{'message':message}
				}
			);
		}
		function inviteEmail(message){
			$rootScope.$broadcast(
				'modal.open',
				{
					'template':'app/directives/views/modal-invite-email.html',
					'data':{'message':message,
							i_email:'',
							i_message:'',
							hideEmail:'',
							actionSendInvitation:function(){
								var i_email = this.i_email;


								if(i_email){
									

									var email_all = i_email;

									var email = email_all.split(',');

									var error = 0;
									for(var i=0; i<email.length; i++){

										//console.log(email[i]);
										var ok = false;
											var c = {
												data: {
													"email": email[i]
												}
											}
										CiayoService.Api('users/invite', c, function(response) {
											if(response.status==200){
												var data = response.data.c.data;

												
												//modalFactory.message(data.message.email[0]);
												
												if (data.error == false) {
													
												}else{
													error++;
												}
											}
											if(ok){
												console.log(data.message);
											}else{
												//...
											}
										});
									}

									if(error==0){
										this.hideEmail = true;
									}else{
										factory.message("Sent invitation error");
									}
									factory.modal_item1 = false;

								}else{
									factory.message('Please fill email');
								}
							}
				}
				}
			);
		}
		function inviteGmail(email_list){
			$rootScope.$broadcast(
				'modal.open',
				{
					'template':'app/directives/views/modal-invite-gmail.html',
					'data':{'message':message,
							'email_list':email_list,
							'hideGmailSearch':false,
							'load_email':false,
							'hideGmail':false,
							'fill_email':false,
							'email_list_next':[],
							open_modal: function(){
								this.load_email = true;
							},
							next_load: function(){
								var email_list = this.email_list;
								
								var jml = 0;
								for(var i=0; i<email_list.length; i++){
									if(email_list[i].value==true){
										jml++;
										this.email_list_next.push({address: email_list[i].address});
										
									}
								}

								if(jml>0){
									this.hideGmailSearch = true;
								}else{
									this.fill_email = true;
								}

							},
							sentInvitationGmail: function(){
								var email_list_next = this.email_list_next;
								
								for(var i=0; i<email_list_next.length; i++){
									
										
									var ok = false;
									var c = {
										data: {
											"email": email_list_next[i].address
										}
									}
									CiayoService.Api('users/invite', c, function(response) {
										if(response.status==200){
											var data = response.data.c.data;

											//modalFactory.message(data.message.email[0]);
											
											if (data.error == false) {
												
											}else{
												//error++;
											}
										}
										if(ok){
											console.log(data.message);
										}else{
											//...
										}
									});
										
									
								}
								this.hideGmail = true;

							}
					}
				}
			);
		}
		function confirm(message,callback){
			$rootScope.$broadcast(
				'modal.open',
				{
					'template':'app/directives/views/modal-confirm.html',
					'data':{
						'message':message,
						tFnc:function(){callback(true)},
						fFnc:function(){callback(false);},
					}
				}
			);
		}
		function withCard(post_id, post_code,from_name,callback){
			PostService.detail (post_code, function(response){
				var js_timeline=response.data.c.data.content;
				if(js_timeline.with_detail.with_status.value!=-1){
					factory.message('Kamu sudah pernah merespon');
					return;
				}
				js_timeline.activity_detail.avatar_url=js_timeline.user_avatar.face;
//				js_timeline.place.url='https://www.google.com/maps/preview/@'+js_timeline.place.place_lat+','+js_timeline.place.place_long+',8z';
			
				js_timeline.view='detail';
				$rootScope.$broadcast(
					'modal.open',
					{
						'template':'app/directives/views/modal-ask-with.html',
						'data':{
							title:$filter('translate')('$asking.with'),
							from_name:from_name,
							created_at:js_timeline.created_at,
							image:js_timeline.activity_detail.preview,
							caption:js_timeline.activity_detail.caption,
							response:function(value){
								PostService.response(post_id,'response_with',value,function(data){
									if(data){
										factory.message(data.data.c.data.message);
									}
								},function(){
									
								})
							},
							tag:function(){
								tagFriend(post_id);
							}
						}
					}
				);
			},function(response){
				console.log(response);
			});
		}
		function placeCard(post_id, post_code,from_name,callback){
			PostService.detail (post_code, function(response){
				var js_timeline=response.data.c.data.content;
				if(js_timeline.place_detail.place_status.value!=-1){
					factory.message('Kamu sudah pernah merespon');
					return;
				}
				console.log(response);
				js_timeline.activity_detail.avatar_url=js_timeline.user_avatar.face;
				js_timeline.view='detail';
				$rootScope.$broadcast(
					'modal.open',
					{
						'template':'app/directives/views/modal-ask-place.html',
						'data':{
							title:$filter('translate')('$asking.place'),
							from_name:from_name,
							created_at:js_timeline.created_at,
							image:js_timeline.activity_detail.preview,
							caption:js_timeline.activity_detail.caption,
							response:function(value){
								PostService.response(post_id,'response_place',value,function(data){
									if(data){
										factory.message(data.data.c.data.message);
									}
								},function(){
									
								})
							},
							tag:function(){
								tagPlace(post_id)
							}
						}
					}
				);
			},function(response){
				console.log(response);
			});
		}
		function card(post_code){
			PostService.detail (post_code, function(response){
				var js_timeline=response.data.c.data.content;
				js_timeline.activity_detail.avatar_url=js_timeline.user_avatar.face;
				js_timeline.view='detail';
				$rootScope.$broadcast(
					'modal.open',
					{
						'template':'app/directives/views/modal-card.html',
						'class':'-card-detail',
						'data':{
							js_timeline:js_timeline,
						}
					}
				);
			},function(response){
				console.log(response);
			});
		}
		function popup_achivement(id){
			AchievementService.popupDetail (id, function(response){
				console.log(response);
				var itemDetail=response.data.c.data.content;
				//var itemDetail.date_get = date.getDate()+'/'+(date.getMonth()+1)+'/'+date.getFullYear();
				
				$rootScope.$broadcast(
					'modal.open',
					{
						'template':'app/directives/views/popup-achievement.html',
						'data':{
							itemDetail:itemDetail,
							shareFB:function(id_achievement,id){
								facebookFactory.getToken(function (data) {
									//alert(data.accessToken);
									access_token = data.accessToken;
									uid = data.uid;


									AchievementService.shareFB(access_token, uid, id_achievement,id, function (response) {
										var data = response.data.c.data;
										if(data.error==false){
											//closeDetail();
											message(data.message);
											//vm.isFB = false;
										}
									}, function () {

									});
								});
								//console.log(id_achievement+'_'+id);
							},
							useAsTitle: function(id){
								var updated_filter = [{"filter_id":520,"filter_value" : id}];
								SettingService.updateUserFilter(updated_filter, '2').then(function(data) {
									
									message(data.message);
								});

							}
						}
					}
				);
			 },function(response){
			 	console.log(response);
			 });
		}
		function tagFriend(post_id){
			$rootScope.$broadcast(
					'modal.open',
					{
						'template':'app/directives/views/modal-response-with.html',
						'data':{
							search:'',
							list:[],
							selected:[],
							searchUser:function(){
								var me = this;
								ProfileService.searchFriend(this.search, 20, 0, function (response) {
									var data = response.data.c.data;
									if(data.error==false){
										var list_user = data.content.list_user;
										if(list_user.length>0){
											me.list = list_user;
										}
									}else{
										
									}
									
								}, function (response) {
									console.log(response);
								});
							},
							selectUser:function(user){
								var index = this.selected.indexOf(user);
								if(index==-1){
									this.selected.push(user);
								}
							},
							removeUser:function(user){
								var index = this.selected.indexOf(user);
								if(index!=-1){
									this.selected.splice(index,1);
								}
							},
							save:function(){
								var _with = [];
								angular.forEach(this.selected,function(value,key){
									_with.push({id:value.user_id,username:value.username});
								});
								PostService.updateWith(post_id, _with, function (response) {
									var data = response.data.c.data;
									message(data.message);
								}, function (response) {

								});
							}
						}
					}
				);
		}
		function tagPlace(post_id){
			var nearby_place = [];
			function getPosition(){
				nearby_place=[];
				if (navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(loadSuggest);
				} else {

				}
			}
			function loadSuggest(position){
				PostService.loadSuggest(
					position.coords.latitude,position.coords.longitude,
					function(response){
						nearby_place = response.data.c.data.content.list_nearby_place;
						data.nearby_list = nearby_place;
						$rootScope.$broadcast(
					'modal.open',
					{
						'template':'app/directives/views/modal-response-place.html',
						'data':data
					}
				);
					},function(response){

				});
			}
			function init(){
				getPosition();
			}
			init();
			
			var data = {
							search:'',
							place_list:[],
							nearby_list:nearby_place,
							selected:null,
							searchPlace:function(){
								var me = this;
								PostService.searchPlace(this.search, function (response) {
								var data = response.data.c.data;
								if(data.error==false){
									if(data.content.data.length>0){
										me.place_list = data.content.data;
									}else{
//										modalFactory.message($filter('translate')('$not.found'));
									}
								}else{
//									modalFactory.message(data.message);
								}
							}, function (response) {
								console.log(response);
							});
							},
							selectPlace:function(place){
								this.selected = place;
								this.search='';
							},
							removePlace:function(){
								this.selected = null;
								this.place_list= [];
								this.search='';
							},
							save:function(callback){
								var me = this;
								if(me.selected==null){
									return;
								}
								PostService.updatePlace(post_id, me.selected.id, function (response) {
									var data = response.data.c.data;
									message(data.message);
									callback();
								}, function (response) {
									callback();
								});
							}
						}
			
		}


	}
})();;
(function() {
	'use strict';

	angular
		.module('app')
		.directive('pagination', pagination);

pagination.$inject = ['CiayoService'];
	function pagination(CiayoService) {
		// Usage:
		//
		// Creates:
		//
		var directive = {
				bindToController: true,
				controller: ControllerController,
				controllerAs: 'vm',
				link: link,
				restrict: 'AE',
				scope: {
					changePage: '=',
					total: '=',
					rePagination: '=',
					page: '='
				},
				template: '<div compile="vm.rePagination()"></div>'
		};
		return directive;
		
		function link(scope, element, attrs) {
		}
	}
	/* @ngInject */
	function ControllerController ($scope) {
		var vm = this;
		
		vm.rePagination = rePagination;

		function rePagination() {
			var total = vm.total;
			var page = vm.page;
			var adjacents = 2;
			var limit = 15;
			

			var prev = parseInt(page) - 1;
			var next = parseInt(page) + 1;
			var lastPage = Math.ceil(total/limit);
			var lpm1 = lastPage - 1;	

			var html = "";

			if(lastPage > 1){
				html += '<div class="c-achv-pagination">';
				//prev button
				if(page > 1){
					html += '<a href="javascript:void(0)" ng-click="vm.changePage('+prev+')"><i class=\"ci-skip s-12 -balik\"></i></a>';
				}

				// pages
				if(lastPage < 7 + (adjacents * 2)){
					for (var c = 1; c <= lastPage; c++){
						if (c == page){
							html += "<span class=\"current\">"+c+"</span>";
						} else {
							html += "<a href=\"javascript:void(0)\" ng-click=\"vm.changePage("+c+")\">"+c+"</a>";	
						}
					}
				} else if (lastPage > 5 + (adjacents * 2)){
					//close to beginning; only hide later pages
					if(page < 1 + (adjacents * 2))		
					{
						for (var c = 1; c < 4 + adjacents; c++)
						{
							if (c == page) {
								html += "<span class=\"current\">"+c+"</span>";
							} else {
								html += "<a href=\"javascript:void(0)\" ng-click=\"vm.changePage("+c+")\">"+c+"</a>";
							}
						}
						// html += "...";
						// html += "<a href=\"javascript:void(0)\" ng-click=\"vm.changePage("+lpm1+")\">"+lpm1+"</a>";
						// html += "<a href=\"javascript:void(0)\" ng-click=\"vm.changePage("+lastPage+")\">"+lastPage+"</a>";
					}
					//in middle; hide some front and some back
					else if(lastPage - (adjacents * 2) > page && page > (adjacents * 2))
					{
						// html += "<a href=\"javascript:void(0)\" ng-click=\"vm.changePage(1)\">1</a>";
						// html += "<a href=\"javascript:void(0)\" ng-click=\"vm.changePage(2)\">2</a>";
						// html += "...";
						for (var c = page - adjacents; c <= page + adjacents; c++)
						{
							if (c == page){
								html += "<span class=\"current\">"+c+"</span>";
							} else {
								html += "<a href=\"javascript:void(0)\" ng-click=\"vm.changePage("+c+")\">"+c+"</a>";
							}
						}
						// html += "...";
						// html += "<a href=\"javascript:void(0)\" ng-click=\"vm.changePage("+lpm1+")\">"+lpm1+"</a>";
						// html += "<a href=\"javascript:void(0)\" ng-click=\"vm.changePage("+lastPage+")\">"+lastPage+"</a>";		
					}
					//close to end; only hide early pages
					else
					{
						// html += "<a href=\"javascript:void(0)\" ng-click=\"vm.changePage(1)\">1</a>";
						// // html += "<a href=\"javascript:void(0)\" ng-click=\"vm.changePage(2)\">2</a>";
						// html += "...";
						for (var c = lastPage - (2 + adjacents ); c <= lastPage; c++)
						{
							if (c == page)
								html += "<span class=\"current\">"+c+"</span>";
							else
								html += "<a href=\"javascript:void(0)\" ng-click=\"vm.changePage("+c+")\">"+c+"</a>";					
						}
					}
				}

				//next button
				if (page < c - 1){
					html += "<a href=\"javascript:void(0)\" ng-click=\"vm.changePage("+next+")\"><i class=\"ci-skip s-12\"></i></a>";
				}

				html += "</div>";	
			}

			return html;
		}
	}
})();;
(function() {
//	'use strict';
	angular
		.module('CiayoParallaxFix',[])
		.directive('cParallax', cParallax)
		.directive('cActivityCard',cActivityCard)
	;
	function cActivityCard($injector){
		return {
			'restrict' : 'E',
			'replace' : true,
			'scope' : {'post':'='},
			'template': '<div id="card"></div>',
			'link':function(scope, element, attrs, controller, transcludeFn){
				var srv={
					amount:0,
					tes1:function(){this.amount++;
						alert('asd');
					},
					tes2:function(){
						console.log('qwe');
					}
				}
				ReactDOM.render(
				  React.createElement(cardComponent, {'post':scope.post,'srv':srv}),
				  element[0]
				);
			}
		}
	}
	function cParallax(){
		return {
			'restrict' : 'E',
			'replace' : true,
			'scope' : {'plx':'=','recompile':'='},
			'templateUrl': 'app/directives/views/parallax.html',
			'controller' : cParallaxCtrl,
			'controllerAs' : 'me'
		}
	}
	function cParallaxCtrl($scope){
		angular.extend(
		$scope,
		{
			init:init,
			state:0,//0->prepare, 1 ready
		});
		init();
		function init(){
			console.log('init');
			$scope.recompile=false;
			$scope.state = 0;
			angular.extend(
			$scope,{
				width : 436,
				height : 312
			});
			$scope.state = 1;
		}
		$scope.toggle = function(){
			$scope.state = $scope.state ==1?0:1;
//			setTimeout($scope.toggle,1);
		}
		$scope.one=function(){
			$scope.state=1;console.log($scope.state);
		}
		$scope.zero=function(){
			$scope.state=0;console.log($scope.state);
		}
		$scope.cek=function(){
			$scope.zero();
			setTimeout($scope.one,1);
		}
		function updateState(){
			
		}
		$scope.$watch(
			function(scope) {
				return scope.recompile;
			},
			function(newValue, oldValue) {
				if(newValue===true && oldValue===false){
					init();
				}
			}
		);
	}
	
})();;
angular
	.module("CiayoParallax", [])
	.controller('ParallaxCtrl',function($scope,$element,$attrs,$transclude,$compile){
		var
			me=$scope.plx,
			ar_img=[
				[10,0.99],//0
				[0,1],//1
				//[-50,1.06],//1
				[-200,1.23],//2
				//[-300,1.33],//3
				[-400,1.44],//3
				//[-500,1.56],//5
				[-600,1.75]//4
			],
			ready=false,
			pause=false,
			mouseOver=false,
			friction=0,
			$el=$element[0];
		me.width=436;me.height=312;
		me.out_width=512;me.out_height=375;
		me.style='';
		me.close_friction=20;	//friction saat mouse over, dan jaraknya kecil
		me.slow_friction=80;		// friction saat keluar dari layar (agar pelan)
		me.allowTilt	= false;
		me.mousePos	= {x : me.width / 2, y : me.height/2};//posisi kursor
		me.lastPos		= {x : me.width / 2, y : me.height/2};//posisi titik pusat
		me.accelPos	= {x : me.width / 2, y : me.height/2};//posisi accelerometer
		me.init=function (){
			me.id=me.activity_id;
			if(me.animate==null){
				me.animate=true;
			}
			me.imgs=[];
			//NOTE get activity_layer
			var activity_layer=0;
			angular.forEach(me.image,function(lyr,index){
				if(lyr.type=='activity'){activity_layer=lyr.layer;}
			});
			
			//NOTE background
			angular.forEach(me.image,function(lyr,index){
				if(lyr.type!='background')return;
				var img = {x:0,y:0,width:me.out_width,height:me.out_height,ax:1,ay:1,tmp:0,text:'',rotation:0,'font_size':10};
				img.layer=lyr.layer;
				img.path=lyr.url;
				img.z=ar_img[img.layer][0];
				img.scale=ar_img[img.layer][1];
				if(img.path!=''){
					img.style=getStyle(img);
					me.imgs.push(img);
				}
			});
			//NOTE back hair
			var img = {
				x:me.out_width*parseFloat(me.avatar_position.x)/100*ar_img[activity_layer][1],
				y:me.out_height*parseFloat(me.avatar_position.y)/100*ar_img[activity_layer][1],
				width:me.out_width,height:me.out_height,
				rotation:me.avatar_rotation,
				layer:activity_layer,animation:0,z:ar_img[activity_layer][0]+1,
				scale:ar_img[activity_layer][1]*parseInt(me.avatar_size)/100,
				path:me.back_hair,text:'','font_size':10};
			if(img.path!=''){
				img.style=getStyle(img);
				me.imgs.push(img);
			}
			//NOTE activity
			angular.forEach(me.image,function(lyr,index){
				if(lyr.type!='activity')return;
				var img = {x:0,y:0,width:me.out_width,height:me.out_height,ax:1,ay:1,tmp:0,text:'',rotation:0,'font_size':10};
				img.layer=lyr.layer;
				img.path=lyr.url;
				img.z=ar_img[img.layer][0]+2;
				img.scale=ar_img[img.layer][1];
				if(img.path!=''){
					img.style=getStyle(img);
					me.imgs.push(img);
				}
			});
			//NOTE head
			var img = {
				x:me.out_width*parseFloat(me.avatar_position.x)/100*ar_img[activity_layer][1],
				y:me.out_height*parseFloat(me.avatar_position.y)/100*ar_img[activity_layer][1],
				width:me.out_width,height:me.out_height,
				rotation:me.avatar_rotation,
				layer:activity_layer,animation:0,z:ar_img[activity_layer][0]+3,
				scale:ar_img[activity_layer][1]*parseInt(me.avatar_size)/100,
				path:me.avatar_url,text:'','font_size':10};
			if(img.path!=''){
				img.style=getStyle(img);
				me.imgs.push(img);
			}
			//NOTE foreground
			angular.forEach(me.image,function(lyr,index){
				if(lyr.type!='foreground')return;
				var img = {x:0,y:0,width:me.out_width,height:me.out_height,ax:1,ay:1,tmp:0,text:'',rotation:0,'font_size':10};
				img.layer=lyr.layer;
				img.path=lyr.url;
				img.z=ar_img[img.layer][0]+4;
				img.scale=ar_img[img.layer][1];
				if(img.path!=''){
					img.style=getStyle(img);
					me.imgs.push(img);
				}
			});
			//NOTE bubble
//			var img = {
//				x:me.out_width*parseInt(me.bubble_text_position.x)/100,
//				y:me.out_height*parseInt(me.bubble_text_position.y)/100,
//				width:parseInt(me.bubble_size.width)/100*me.out_width,
//				height:parseInt(me.bubble_size.height)/100*me.out_height,
//				z:ar_img[activity_layer][0]+3,
//				rotation:0,
//				layer:1,animation:0,
//				scale:ar_img[1][1],
//				path:'',text:me.caption || ''};
//			var length=img.text.length;if(length>50)length=50;
//			img.font_size=19-length/5;
//			img.style=getStyle(img);
//			me.imgs.push(img);
			ready=true;
		}
		function run(){
			setTimeout(function(){render();},10);
		}
		function render(){
			if(!isInView()){onMouseLeave();return;}
			if(!ready){ return;}//kalau gambar belum di inisiasi semua -> do nothing
			//input
			var 
				curx=me.allowTilt?me.accelPos.x:me.mousePos.x,//ambil dari posisi accelerometer atau dari mouse
				cury=me.allowTilt?me.accelPos.y:me.mousePos.y,
			//selisih
				diffx=(me.lastPos.x-curx),
				diffy=(me.lastPos.y-cury),
				diffl=Math.sqrt(Math.pow(diffx,2)+Math.pow(diffy,2)),//jarak diagonal
				diffc=Math.sqrt(Math.pow(me.width,2)+Math.pow(me.height,2));//jarak diagonal layar
			//cek kalau masih jauh frictionnya besar, kalau udah deket jadi kecil
			//friction makin kecil kalau jaraknya kecil
			if(diffl<	me.close_friction){
				friction=me.close_friction;
			}else{
				friction=diffl/($scope.allowTilt?16:4);
			}
			me.lastPos.x-=diffx/friction;
			me.lastPos.y-=diffy/friction;
			if(me.allowTilt)me.lastPos=me.accelPos;
			var 
				ax=((me.lastPos.x/me.width)-0.5)*10,
				ay=-((me.lastPos.y/me.height)-0.5)*10;
			me.style=transform(ax,ay,0,0);
			$scope.$apply(function(){});
			if(!mouseOver){
				if(
					Math.round(me.lastPos.x)===Math.round(me.mousePos.x) && 
					Math.round(me.lastPos.y)===Math.round(me.mousePos.y)
				){
					me.lastPos={x:me.width/2,y:me.height/2};
					pause=true;
				}
			}
			if(!pause){run();}
		}

		function getStyle(img){
			var _return=
				'-webkit-transform: translate3d(0px,0px, '+img.z+'px) scale('+img.scale+', '+img.scale+') rotateZ('+img.rotation+'deg);'+
				'transform: translate3d(0px,0px, '+img.z+'px) scale('+img.scale+', '+img.scale+') rotateZ('+img.rotation+'deg);'+
				'-moz-transform: translate3d(0px,0px, '+img.z+'px) scale('+img.scale+', '+img.scale+') rotateZ('+img.rotation+'deg);'+
				'left :'+(img.x-(me.out_width-me.width)/2)+'px;top:'+(img.y-(me.out_height-me.height)/2)+'px;'+
				'background-image: url('+img.path+');'+
				'width:'+img.width+'px;'+
				'height:'+img.height+'px;'+
				'font-size:'+img.font_size+'px;';
			return _return;
		}
		function isInView(){
			var
				act_x=($el.getBoundingClientRect().left),
				act_y=($el.getBoundingClientRect().top),
				win_w = Math.max(document.documentElement.clientWidth, window.innerWidth || 0),
				win_h = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
			return (act_x>=0 && act_x+me.width<=win_w && act_y>=0 && act_y+me.height<=win_h);
		}
		function getPos($event){//fungsi untuk mengambil attribute x dan y dari event angular
			return {x:$event.offsetX,y:$event.offsetY};
		}
		function transform(rx,ry,tx,ty){
			var 
				out=
					'rotateY('+rx+'deg) rotateX('+ry+'deg) '+
					'translateY('+ty+'px) translateX('+tx+'px)',
					text =
			'-webkit-transform:'+out+';'+
			'-moz-transform:'+out+';'+
			//'-moz-transform:'+out+';'+
			'transform:'+out+';';
			return text;
		}
		function onMouseEnter(){
			if(!me.animate)return;
			pause=false;mouseOver=true;
			friction=me.slow_friction;
			run();
		}
		function onMouseLeave(){
			if(!me.animate)return;
			mouseOver=false;
			friction=me.slow_friction;
			me.mousePos={x:me.width/2,y:me.height/2};
		}
		function onMouseMove($event){
			if(!me.animate)return;
			if(mouseOver===false){onMouseEnter();}
			me.mousePos=(getPos($event));
		}
		function onMouseUp(){
//			me.animate=!me.animate;
			if(isInView()){
				//if($scope.allowTilt)
				{
					if(pause==true){
						//pause=false;
						onMouseEnter();
					}else{
						pause=true;
					}
				}
			}
		}
		function onMouseDown(){}
		function handleOrientation(event) {
			var
				x = event.beta,
				y = event.gamma,
				batas=[20,25,65],
				orientation=window.orientation,//1^,2<,3|,4>
				diffx=0,diffy=0;
				me.allowTilt=(event.beta!=undefined);
			if(orientation===0){//0 normal [20 50][-15 15]
				x=x<batas[1]?batas[1]:x;
				x=x>batas[2]?batas[2]:x;
				y=y<-batas[0]?-batas[0]:y;
				y=y>batas[0]?batas[0]:y;
				diffx=x-(batas[2])+(batas[2]-batas[1])/2;diffy=y;
			}else
			if(orientation===90){//90 miring ke kiri [-15 15] [-50 -20]
				x=x<-batas[0]?-batas[0]:x;
				x=x>batas[0]?batas[0]:x;
				y=y<-batas[2]?-batas[2]:y;
				y=y>-batas[1]?-batas[1]:y;
				diffy=x;diffx=(y+((batas[2]-batas[1])/2+batas[1]))*-1;
			}else
			if(orientation===180){//180 dibalik [-50 -20] [15 -15]
				x=x<-batas[2]?-batas[2]:x;
				x=x>-batas[1]?-batas[1]:x;
				y=y<-batas[0]?-batas[0]:y;
				y=y>batas[0]?batas[0]:y;
				diffx=(x+((batas[2]-batas[1])/2+batas[1]))*-1;diffy=-y;
			}else
			if(orientation===-90){//-90 kanan [15 -15] [20 50]
				x=x<-batas[0]?-batas[0]:x;
				x=x>batas[0]?batas[0]:x;
				y=y<batas[1]?batas[1]:y;
				y=y>batas[2]?batas[2]:y;
				diffy=-x;diffx=y-((batas[2]-batas[1])/2+batas[1]);
			}
			me.accelPos.x=(diffy/40+0.5)*me.width;me.accelPos.y=(diffx/40+0.5)*me.height;
			//$scope.debug=diffy+' '+diffx;
			if(me.allowTilt && mouseOver===false){
				onMouseEnter();
			}
		}

//		$element.bind('mouseenter',onMouseEnter);
//		$element.bind('mouseleave', onMouseLeave);
//		$element.bind('mousemove',onMouseMove);
//		$element.bind('mouseup',onMouseUp);
//		$element.bind('mousedown',onMouseDown);
//		window.addEventListener('deviceorientation', handleOrientation);
		me.init();
		$scope.plx.init=me.init;
	})
	.directive('parallax',function(){
		return {
			restrict: 'E',
			replace: true,
			controller:'ParallaxCtrl as plx',
			scope: {'plx':'='},
			template: 
			'<div class="parallax" style="width:{{plx.width}}px; height:{{plx.height}}px">' + 
				'<div class="parallax-wrapper" style="{{plx.style}};width:100%;height:100%;">' +
					'<div class="parallax-layer" ng-repeat="img in plx.imgs" style="{{img.style}}">{{img.text}}</div>' +
				'</div>' +
			'</div>'
		}
	});
;
+ function () {
	"use strict";
	angular
		.module("CiayoPost", [])
		.directive('cPost', function () {
			return {
				restrict: "E",
				scope: {
					post: '=',
					time: '='
				},
				replace: true,
				templateUrl: 'app/directives/views/post.html',
				controller: function ($scope, $element, $state, PostService, ItemService, ProfileService, listService, $location, $rootScope, modalFactory,TourService,$filter) {
					var me = this;
					if ($scope.time == undefined) $scope.time = true;
					//proses migrasi
					angular.extend(me, {
						cur_time: '',
						init: function () {
							this.reset();
							this.cur_time = new Date().getTime();
						},
						reset: function () {
							this.setFocus('item', 0);
						},
						setFocus: function (focus, arrayIndex) {
							angular.forEach(this.prop, function (value, key) {
								if (value.isArray) {
									value.isFocus = angular.equals(key, focus) ? arrayIndex : -1;
								} else {
									value.isFocus = angular.equals(key, focus);
								}
							});
						},
						setActive: function (active, arrayIndex) {
							angular.forEach(this.prop, function (value, key) {
								if (value.isArray) {
									value.isActive = angular.equals(key, active) ? arrayIndex : -1;
								} else {
									value.isActive = angular.equals(key, active);
								}
							});
						},
						prop: {
							activity: {
								text: '',
								search_list: Object.create(listService)
							},
							caption: {
								text: ''
							},
							item: {
								isArray: true,
							},
							with: {
								text: ''
							},
							place: {
								text: '',
								selected: {}
							}
						},
						default: {

						},
						activity: {
							isActive: false,
							waiting: false,
							list: [],
							text: '',
							selectedIndex: -1,
							prev: function () {
								if (parseInt(this.selectedIndex) > 0) {
									this.selectedIndex--;
								}
								var li = $('#listActivity ul li:nth-child(' + this.selectedIndex + ')').offset();
								var off = li.top;
								if (off <= 125) {
									var pos = $("#listActivity").scrollTop() - 60;
									$("#listActivity").scrollTop(pos);
								}
							},
							next: function () {
								console.log(this.list.length);
								if (parseInt(this.selectedIndex) + 1 < this.list.length) {
									this.selectedIndex++;
								}

								var li = $('#listActivity ul li:nth-child(' + this.selectedIndex + ')').offset();
								var off = li.top;
								if (off >= 325) {
									var pos = $("#listActivity").scrollTop() + 60;
									$("#listActivity").scrollTop(pos);
								}

							}
						},
						loading_activity:false,
						loading_detail:false,
						kepoboxSlide:kepoboxSlide
					});
					this.init();
					function kepoboxSlide(){
					var myDate = new Date(); 
					var current_time = 'day';
					if (myDate.getHours() >= 5 && myDate.getHours() < 10)  
						current_time = 'morning';
					else if (myDate.getHours() >= 15 && myDate.getHours() < 19) 
						current_time = 'afternoon';
					else if ( myDate.getHours() >= 19 || myDate.getHours() < 5) 
						current_time = 'night';
					PostService.getKepoboxImage(current_time,function(data){
						me.kepobox_image = data.content.list_kepobox[0].kepobox_images[0].image;
					})
		//			$('.kepobox img.'+current_time).show();
				}
					//CLASS
					me.category = {
						isActive: false,
						list: [],
						selectedIndex: 0,
						toggle: function () {
							this.isActive = !this.isActive;
						},
						getSelectedId: function () {
							return this.list[this.selectedIndex].id;
						}
					};
					me.mood = {
						list: [],
						selectedIndex: 0
					};

					me.activity_detail = [];
					me.item = {
						text: null,
						position: -1,
						edit: -1,
						dummy: function () {
							this.item_id = null;
							this.item_name = null;
							this.item_image_thumbnail = null;
							this.item_image_detail = null;
							this.item_type = null;
						},
						size: 4,
						selectedItem: [],
						init: function () {
							this.selectedItem = [];
							for (var i = 0; i < this.size; i++) {
								this.selectedItem.push(new(this.dummy));
							}
						},
						open: function (pos) {
							me.prop.item.text = null;
							me.item.search_list.reset();
							me.setActive('none');
							me.setFocus('none');
							
							this.edit = -1;
							this.position = pos;
							me.place.isActive = false;
							me.with.isActive = false;
							
							setTimeout(function () {
								angular.element('#txt-post-item-' + pos).focus();
							}, 100);
						},
						openEdit: function (pos) {
							this.edit = pos;
							this.position = -1;
							me.place.isActive = false;
							me.with.isActive = false;
						},
						remove:function(item){
							this.selectedItem[this.selectedItem.indexOf(item)]=new(this.dummy);
							this.edit=-1;
						},
						search_list: Object.create(listService),
						search_view: 5,
						search_pos: 0,
					}
					me.with = {
						text: "",
						isActive: false,
						open: function (pos) {
							this.isActive = true;
							me.item.position = -1;
							me.item.edit = -1;
							me.place.isActive = false;
						},
						search_list: Object.create(listService)
					}
					me.place = {
						text: '',
						isActive: false,
						open: function (pos) {
							this.isActive = true;
							me.item.position = -1;
							me.item.edit = -1;
							me.with.isActive = false;
						},
						search_list: Object.create(listService)
					}
					me.post = {
						"activity_id": null,
						"mood_id": 1,
						"place_id": null,
						"post_category": "0",
						"caption": "",
						"bubble": false,
						"items": [],
						"with_users": [
							//{"id": "11","username": "andi"},post
						]
					};

					me.initPost = function () {
						kepoboxSlide();
							PostService.postAttributes(function () {
								me.category.list = PostService.permission_list;
								me.mood.list = PostService.mood_list;
								me.mood.selectedIndex = 0;
								me.resetActivity();
								me.post.post_category = me.category.getSelectedId();
								me.selectCategory(1);
								me.item.search_list.reset();
								me.with.search_list.reset();
								me.place.search_list.reset();
								me.place.text = '';
								me.post = {
									"activity_id": null,
									"mood_id": 1,
									"place_id": null,
									"post_category": "0",
									"caption": "",
									"bubble": false,
									"items": [],
									"with_users": []
								};
								me.prop.place.selected={};
								//ci-box-caption, ci-bubble-caption
								getPosition();
							}, function (response) {
								console.log(response);
							});
						}
						//MOOD
					me.selectMood = function (index) {
						var const_mood =['normal','happy','sad'];
						me.mood.selectedIndex = index;
						me.post.mood_id = me.mood.list[index].mood_id;
						me.updateMood(const_mood[me.mood.list[index].mood_id-1]);
					}
					me.updateMood = function (mood) {
							if (mood == null) {
								mood = 'normal';
							}
							if (me.activity_detail[0].avatar_url_list != null) {
								me.activity_detail[0].avatar_url = me.activity_detail[0].avatar_url_list[mood.toLowerCase()];
								if(me.activity_detail[0].init!=undefined){
									me.activity_detail[0].init();
								}
							}
						}
						//ACTIVITY
					me.resetActivity = function () {
						//						var animationEnd = 'webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend';
						//						angular.element($element).find('#posting-activity').addClass('animated fadeOutUp').one(animationEnd,function(){
						//							angular.element(this).removeClass('animated fadeOutUp');
						//						});
						me.loading_activity=false;
						me.loading_detail=false;
						me.activity_detail=[];
						me.item.init();
						me.prop.activity.text = "";
						me.post.activity_id = null;
						me.activity.list = [];
						me.setActive('none');
						me.setFocus('none');

					}
					me.searchActivity = function (from) {
						var text = me.prop.activity.text;
						if (text.length > 1) {
							me.loading_activity=true;
							me.post.activity_id = null;
							PostService.searchActivity(text, 20, 0, function (response) {
								me.loading_activity=false;
								var data = response.data.c.data;
								if (data.error == false) {
									me.activity.list = data.content.list_activity;
									me.setActive('activity');
									if(me.activity.list.length==0 && from==undefined){
										modalFactory.message($filter('translate')('$not.found'));
									}else{
										TourService.tourSelectActivity();
										me.activity.selectedIndex=0;
									}
								} else {
									modalFactory.message(data.message);
								}
								
							}, function (response) {
								modalFactory.message('error API');
								me.loading_activity=false;
							});
						}
					}
					me.selectActivity = function (index) {
						var activity_id = me.activity.list[index].activity_id;
						me.setActive('none');
						me.loading_detail=true;
						me.post.activity_id = -1;
						me.activity.waiting = true;
						PostService.activityDetail(
							activity_id,
							function (response) {
								me.loading_detail=false;
								var data = response.data.c.data;
								if (data.error == false) {
									TourService.tourCreatePost();
									me.prop.activity.text = me.activity.list[index].activity_name;
									me.post.activity_id = me.activity.list[index].activity_id;
									me.activity.list = [];
									me.activity_detail = [data.content];
									me.setFocus('caption');
									me.item.init();
									me.activity_detail[0].avatar_url_list = me.activity_detail[0].avatar_url;
									me.updateMood();
									me.post.bubble = me.activity_detail[0].bubble == true;
								} else {
									modalFactory.message(data.message);
									me.post.activity_id = null;
								}
								me.waiting = false;
							},
							function (response) {
								me.loading_detail=false;
								modalFactory.message('error API');
								me.waiting = false;
								me.post.activity_id = null;
							}
						);
					}
					me.keypressActivity = function ($event) {
							if ($event.keyCode === 40) {
								$event.preventDefault();
								me.activity.next();
							} else if ($event.keyCode === 38) {
								$event.preventDefault();
								me.activity.prev();
							} else if ($event.keyCode === 13) {console.log(me.activity.selectedIndex);
								me.selectActivity(me.activity.selectedIndex);
							}
						}
						//ITEM
					me.searchItem = function ($index) {
						if (me.prop.item.text.length > 1) {
							//me.post.items[$index].item_id=null;
							ItemService.list(me.prop.item.text, null, 20, 0, function (response) {
								var data = response.data.c.data;
								if(data.error==false){
									var list = data.content.list_item;
									var selected = [];
									angular.forEach(me.item.selectedItem, function (value, key) {
										if (value.item_id) {
											selected.push(value.item_id);
										}
									});
									for (var key = list.length - 1; key >= 0; key--) {
										var value = list[key];
										var index = selected.indexOf(value.item_id);
										if (index != -1) {
											list.splice(key, 1);
										}
									}
									if(list.length>0){
										me.item.search_list.list = list;
									}else{
										modalFactory.message($filter('translate')('$not.found'));
									}
								}else{
									modalFactory.message(data.message);
								}
							}, function (response) {
								console.log(response);
							});
						}
					}
					me.selectItem = function ($index) {
						me.item.selectedItem[$index] = me.item.search_list.getSelectedItem();
						me.item.open(-1);
//						if (me.item.position < me.item.size) {
//							me.item.open(me.item.position + 1);
//						}
					}
					me.keypressItem = function ($event, $index) {
							if ($event.keyCode === 40) {
								$event.preventDefault();
								me.item.search_list.next('.c-tml-ilc', 60, 5);
								//								if(me.item.search_list.selectedIndex >= me.item.search_pos+me.item.search_view){
								//									var diff = me.item.search_list.selectedIndex+1 - (me.item.search_view);if(diff<0){diff=0;}
								//									var last_pos = me.item.search_pos;
								//									me.item.search_pos = diff;
								//									var el = angular.element('.c-tml-ilc');
								//									el.scrollTop(me.item.search_pos*60);
								//								}

							} else if ($event.keyCode === 38) {
								$event.preventDefault();
								me.item.search_list.prev('.c-tml-ilc', 60, 5);
								//									if( me.item.search_pos >= me.item.search_list.selectedIndex )
								//									{
								//										me.item.search_pos = me.item.search_list.selectedIndex;
								//										var el = angular.element('.c-tml-ilc');
								//										el.scrollTop(me.item.search_pos*60);
								//									}
							} else if ($event.keyCode === 13) {
								me.selectItem($index);
							}
						}
						//WITH
					me.searchWith = function () {
						if (me.with.text.length > 1) {
							ProfileService.searchFriend(me.with.text, 20, 0, function (response) {
								var data = response.data.c.data;
								if(data.error==false){
									var list = data.content.list_user;
									var selected = [];
									angular.forEach(me.post.with_users, function (value, key) {
										if (value.id) {
											selected.push(value.id);
										}
									});
									for (var key = list.length - 1; key >= 0; key--) {
										var value = list[key];
										var index = selected.indexOf(value.user_id);
										if (index != -1) {
											console.log(index);
											list.splice(key, 1);
										}
									}
									if(list.length>0){
										me.with.search_list.list = list;
									}else{
										modalFactory.message($filter('translate')('$not.found'));
									}
								}else{
									modalFactory.message(data.message);
								}
							}, function (response) {
								console.log(response);
							});
						}
					}
					me.selectWith = function ($index) {
						me.with.text = null;
						var selected = me.with.search_list.getSelectedItem();
						me.post.with_users.push({
							id: selected.user_id,
							username: selected.user_display_name
						})
						me.with.search_list.reset();
					}
					me.removeWith = function (user) {
						var index = me.post.with_users.indexOf(user);
						me.post.with_users.splice(index, 1);
					}
					me.keypressWith = function ($event, $index) {
							if ($event.keyCode === 40) {
								$event.preventDefault();
								me.with.search_list.next();
							} else if ($event.keyCode === 38) {
								$event.preventDefault();
								me.with.search_list.prev();
							} else if ($event.keyCode === 13) {
								me.selectWith($index);
							}
						}
						//PLACE
					me.searchPlace = function () {
						if (me.place.text.length > 1) {
							PostService.searchPlace(me.place.text, function (response) {
								var data = response.data.c.data;
								if(data.error==false){
									if(data.content.data.length>0){
										me.place.search_list.list = data.content.data;
									}else{
										modalFactory.message($filter('translate')('$not.found'));
									}
								}else{
									modalFactory.message(data.message);
								}
							}, function (response) {
								console.log(response);
							});
						}
					}
					me.selectPlace = function (selected) {
//						var selected = me.place.search_list.getSelectedItem();
						me.place.text = selected.name;
						me.post.place_id = selected.id;
						me.with.search_list.reset();
						me.prop.place.selected = selected;
						me.place.isActive = false;
					}
					me.keypressPlace = function ($event, $index) {
							if ($event.keyCode === 40) {
								$event.preventDefault();
								me.place.search_list.next();
							} else if ($event.keyCode === 38) {
								$event.preventDefault();
								me.place.search_list.prev();
							} else if ($event.keyCode === 13) {
								me.selectPlace($index);
							}
						}
					function getPosition(){
						me.nearby_place=[];
						if (navigator.geolocation) {
							navigator.geolocation.getCurrentPosition(loadSuggest);
						} else {

						}
					}
					function loadSuggest(position){PostService.loadSuggest(
						position.coords.latitude,position.coords.longitude,
						function(response){
							me.nearby_place = response.data.c.data.content.list_nearby_place;
						},function(response){
							
						});
					}
						//CATEGORY
					me.selectCategory = function (index, id) {
							me.category.selectedIndex = index;
							me.post.post_category = me.category.getSelectedId();
							me.category.isActive = false;
						}
						//POST
					me.createPost = function () {
						if(me.post.activity_id==undefined){
							modalFactory.message('Silahkan pilih activity');return;
						}if(me.post.activity_id==-1){
							modalFactory.message('Loading Activity, please wait');return;
						}
						
						{
							me.post.items = [];
							angular.forEach(me.item.selectedItem, function (value, key) {
								if (value && value.item_id) {
									me.post.items.push({
										id: value.item_id,
										type: value.item_type
									})
								}
							});
							me.post.caption = me.post.caption.substring(0,50);
							var loading = {
								"view": "loading"
							};
							$scope.post.unshift(loading);
							PostService.create(me.post, function (response) {
								$scope.post.splice(0, 1);
								var data = response.data.c.data;
								if (data.error == false) {
									data.content.view = 'normal';
									if (data.content.activity_detail != undefined) {
										// data.content.activity_detail.animate = me.animate;
										data.content.activity_detail.avatar_url = data.content.user_avatar.face;
										data.content.activity_detail.back_hair = data.content.user_avatar.back_hair;
										// data.type_page = 'timeline';
										data.content.login_id = ProfileService.userData.user_id;
									}
									$scope.post.unshift(data.content);
								} else {
									modalFactory.message(data.message);
								}
								
							},function(){
								modalFactory.message('Please try again');
							});
							me.initPost();
							me.resetActivity();
						}
					}
					me.initPost();
				},
				controllerAs: 'me'
			};
		});
}();;
+function(){ "use strict";
	angular
		.module("CiayoProfile", [])
		.directive('cProfile',function() {
			return {
				restrict: "E",
				scope:{},
				replace:true,
				templateUrl:'app/directives/views/post.html',
				controller: function($scope,$element){
					var me=this;
					angular.extend(me,{
						
					});
				},
				controllerAs:'me'
			};
		})
		.directive('cMutualFriend',function() {
			return {
				restrict: "E",
				scope:{'userId':'=',mutualFriendCount:'='},
				replace:true,
				templateUrl:'app/directives/views/profile-mutual-friend.html',
				controller: function($scope,$element,ConnectionService){
					var me=this;
					angular.extend(me,{
						isActive:false,
						mutual_friend_count:$scope.mutualFriendCount,
						class:'up',
						data:[],
						more:false,
						showTooltip:showTooltip,
						hideTooltip:hideTooltip
					});
					function showTooltip($event){
						if(me.data && me.data.length==0)
						ConnectionService.getMutualFriend(
							$scope.userId,
							function(response){
								var data=response.data.c.data;
								if(data.error==false){
									me.data=data.content.list_user;
									me.more=(me.data && me.mutual_friend_count-me.data.length>10);//console.log(me.more);
								}
							},
							function(){
								alert('ERROR API')
							}
						);
						
						var tooltip=$element.find('.mf-tooltip');
						var offset=$element.offset();
//						tooltip.addClass('up');
						tooltip.css('position','fixed');//console.log(offset);
						if(me.class=='down'){
							tooltip.css('top',offset.top+$element.height()-angular.element(document).scrollTop());
						}
						else
						if(me.class=='up'){console.log()
							tooltip.css('bottom',angular.element(window).height()-(offset.top-angular.element(document).scrollTop()));
						}
						tooltip.css('left',offset.left);
						me.isActive=true;
					}
					function hideTooltip(){
						me.isActive=false;
					}
				},
				link:function($scope,$element){
					
				},
				controllerAs:'me'
			};
		})
	/*
	
	*/
}();;
+function(){ "use strict";
	angular
		.module("CiayoSetting", [])
		.directive('cSetting',function() {
			return {
				restrict: "E",
                controller: function($scope, $location, $state, $stateParams)
                {   
                    if($stateParams.menu == 'setting' || $stateParams.menu == '') {
                        $state.go('setting', { 'menu': 'edit-profile' });
                    } else {
                        $scope.active = $stateParams.menu;
                        $scope.url = 'app/directives/views/setting-'+$stateParams.menu+'.html';
                    }
                    if($stateParams.menu == 'delete') {
                        $scope.url = 'app/directives/views/setting-edit-profile.html';
                    }
                    if($stateParams.menu == 'notification') {
                        $scope.active = 'general';
                        $scope.url = 'app/directives/views/setting-general.html';
                    }
                    if($stateParams.menu == 'account') {
                        $scope.active = 'edit-profile';
                        $scope.url = 'app/directives/views/setting-edit-profile.html';
                    }
                    $scope.menu = function (name) {
                        $scope.active = name;
                        $scope.url = 'app/directives/views/setting-' + name + '.html';
                        $state.go('setting', { 'menu': name });
                    }
                },
                template: '<ng-include src="url"></ng-include>'
			};
		})
}();;
(function() {
	'use strict';

	angular
		.module('app')
		.directive('storeCarousel', storeCarousel);

	storeCarousel.$inject = [];
	function storeCarousel() {
		// Usage:
		//
		// Creates:
		//
		var directive = {
				link: link,
				restrict: 'A',
				scope: {
				}
		};
		return directive;
		
		function link(scope, element, attrs) {
			$(document).ready(function(){
				setTimeout(function() {
					$(element).flickity({
						pageDots: false,
						cellAlign: 'left'
					});
				}, 1);
			})
		}
	}
})();;
+function(){ 
	"use strict";
	angular
		.module("CiayoUtil", [])
//		.directive('a', function() {
//		return {
//			restrict: 'E',
//			link: function(scope, elem, attrs) {
//				if(attrs.ngClick || attrs.href === '' || attrs.href === '#'){
//					elem.on('click', function(e){
////						e.preventDefault();
//					});
//				}
//			}
//		}
//	 })
	.directive('ngEnter',function() {
		return {
			link:function(scope,element,attrs) {
				element.bind("keypress", function(event) {
					if(event.which === 13) {
						scope.$apply(function() {
							scope.$eval(attrs.ngEnter);
						});
					event.preventDefault();
					}
				});
			}
		};
	})
	.directive('ngSetFocus',function() {
		return {
			link:function(scope,element,attrs) {
				scope.$watch(attrs.ngSetFocus, function(value) {
					if(value === true) { 
							element[0].focus();
							scope[attrs.focusMe] = false;
					}
				});
			}
		};
	})
	.directive('cSlider',function(){
		return{
			restrict: 'A',
			scope:{'list':'=','alias':'='},
			controller:function($scope){
				console.log($scope.list);
			},
			transclude:true,
			template:'<ng-transclude></ng-transclude><div></div>'
		}
	})
	.filter('formatdate', function($filter,$cookieStore) {

		function timeConverter(UNIX_timestamp){
		  	 		var a = new Date(UNIX_timestamp);
				  var months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
				  var year = a.getFullYear();
				  var month = months[a.getMonth()];
				  var date = a.getDate();
				  var time = date + ' ' + month + ' ' + year;
				  return time;
		}

	function format_filter(date) {
		date = date * 1000;
		if (typeof date !== 'object') {
					date = new Date(date);
			}

			var seconds = Math.floor((new Date() - date) / 1000);
			//seconds = seconds + 240;
			var intervalType;
			var type = 'false';

			var interval = Math.floor(seconds / 31536000);
			if (interval >= 1) {
					intervalType = $filter('translate')('$year');
					type = 'true';
			} else {
					interval = Math.floor(seconds / 2592000);
					if (interval >= 1) {
							intervalType = $filter('translate')('$month');
							type = 'true';
					} else {
							interval = Math.floor(seconds / 86400);
							if (interval >= 1) {
									intervalType = $filter('translate')('$day');
									
							} else {
									interval = Math.floor(seconds / 3600);
									if (interval >= 1) {
											intervalType = $filter('translate')('$hour');
									} else {
											interval = Math.floor(seconds / 60);
											if (interval >= 1) {
													intervalType = $filter('translate')('$minute');
													

											} else {
													interval = $filter('translate')('$just.now');
													intervalType = ''; 
													var typelang = 1; 
													//intervalType = $filter('translate')('$second');
											}
									}
							}
					}
			}
			if(type=='false'){
				if(typelang==1){
					return interval;
				}else{
					if($cookieStore.get('language')==1){
						if (interval > 1 || interval === 0) {
							intervalType += 's';
						}
					}
					return interval + ' ' + intervalType + " "+$filter('translate')('$ago');
				}
			}else{
				return timeConverter(date);
			}
	}

	return format_filter;
	})
	.filter('formatdate_timeline', function($filter,$cookieStore) {
	function format_filter(date) {
		date = date * 1000;
		if (typeof date !== 'object') {
					date = new Date(date);
			}

			var seconds = Math.floor((new Date() - date) / 1000);
			seconds = seconds + 240;
			var intervalType;
			var type = 'false';

			var interval = Math.floor(seconds / 31536000);
			if (interval >= 1) {
					intervalType = $filter('translate')('$year');
			} else {
					interval = Math.floor(seconds / 2592000);
					if (interval >= 1) {
							intervalType = $filter('translate')('$month');
					} else {
							interval = Math.floor(seconds / 86400);
							if (interval >= 1) {
									intervalType = $filter('translate')('$day');
							} else {
									interval = Math.floor(seconds / 3600);
									if (interval >= 1) {
											intervalType = $filter('translate')('$hour');
									} else {
											interval = Math.floor(seconds / 60);
											if (interval >= 1) {
													intervalType = $filter('translate')('$minute');
											} else {
													interval = $filter('translate')('$just.now');
													intervalType = ''; 
													type = 'true';
													//intervalType = $filter('translate')('$second');
											}
									}
							}
					}
			}
			if(type=='false'&&$cookieStore.get('language')==1){
				if (interval > 1 || interval === 0) {


						intervalType += 's';
					}
			}
			return interval + ' ' + intervalType + " "+$filter('translate')('$ago');
	}

	return format_filter;
	})
	.directive('whenScrollEnds', function() {
	return {
			restrict: "A",
			link: function(scope, element, attrs) {
                var visibleHeight = element.height();

                var threshold = 100;

                element.scroll(function() {
                    var scrollableHeight = element.prop('scrollHeight');
                    //var hiddenContentHeight = scrollableHeight - element.height();
                    var hiddenContentHeight = scrollableHeight - element.height();
					//console.log(element);
                    if (hiddenContentHeight - element.scrollTop() <= threshold) {
                        // Scroll is almost at the bottom. Loading more rows
                        scope.$apply(attrs.whenScrollEnds);
                    }
                });
            }
		};
	})
	.directive("limitTo", [function() {
		return {
				restrict: "A",
				link: function(scope, elem, attrs) {
						var limit = parseInt(attrs.limitTo);
						angular.element(elem).on("keypress", function(e) {
							if(e.keyCode==8) return;
							if (this.value.length == limit) e.preventDefault();
						});
				}
		}
	}])
	.filter('comment',function(){
		return function(comment){
			if(comment==undefined)return '';
			var out=comment.content;
			if(comment['entities_message']!=undefined){
				if(comment.entities_message.length==1){
					if(comment.entities_message[0].shortcode_format==comment.content){
						comment.entities_message[0].type='sticker';
					}
				}
				var already_parse_sticker = false;
				angular.forEach(comment.entities_message,parse);
			}
			return out;
			function parse(value,key){
				if(value.type=='sticker'){
						if(already_parse_sticker==true){
							return;
						}else{
							already_parse_sticker = true;
						}
					}
					var _out = out.split(value.shortcode_format);
					if(_out.length>1){
						var last = _out.splice(1,_out.length-1).join(value.shortcode_format);
						_out[1] = last;
					}
				out = _out
					.join('<img '+(value.type=='sticker'?'width="100" height="100"':'width="20" height="20"')+' src=\"'+value.media_url+'\">');
			}
		}
	})
	.directive("contenteditable", function() {
  return {
    restrict: "A",
    require: "ngModel",
    link: function(scope, element, attrs, ngModel) {

      function read() {
        ngModel.$setViewValue(element.html());
      }

      ngModel.$render = function() {
        element.html(ngModel.$viewValue || "");
      };

      element.bind("blur keyup change", function() {
        scope.$apply(read);
      });
    }
  };
})
	.directive('lazyLoad', function() {
		return {
			restrict: "A",
			link: function(scope, element, attrs) {
				setTimeout(function(){
				angular.element(window).scroll(function(){
					var scroll_height = angular.element('body').prop('scrollHeight');
					var scroll_top = angular.element('body').scrollTop();
					var height = angular.element(window).height();
					if(scroll_height - (height + scroll_top) <=300){
						scope.$apply(attrs.lazyLoad);
					}
				});
					},10);
				scope.$on('$destroy',function(){
					angular.element(window).off('scroll');
				})
			}
		};
	})
	;
	
}();
;
(function() {
'use strict';

	angular
		.module('app')
		.factory('facebookFactory', facebookFactory);

	facebookFactory.$inject = ['$window','$q'];
	function facebookFactory($window,$q) {
		var factory = {
			init:init,
			getToken:getToken
		};
		init();
		return factory;
		
		function getToken(callback){
			var defer = $q.defer();
			var _return = {
				accessToken:null,
				uid:null,
				status:-1
			};
			if(window['FB']){
				loginStatus()
				.then(function(data){//sudah login
					_return.status = data.status;
					_return.accessToken = data.access_token;
					_return.uid = data.uid;
					defer.resolve(_return);
					callback(_return);
				},function(){
					login()
					.then(function(){
						loginStatus()
						.then(function(data){
							_return.status = data.status;
							_return.accessToken = data.access_token;
							_return.uid = data.uid;
							defer.resolve(_return);
							callback(_return);
						},function(){
							callback(_return);
						})
					},function(){
						callback(_return);
					});
				});
			}else{
				callback(_return);
			}
		}
		
		function init() {
			$window.fbAsyncInit = function() {
				if(window['FB']==undefined)return;
				FB.init({ 
					appId: 1757098051179810,
					status: true, 
					cookie: true, 
					xfbml: true,
					version: 'v2.4'
				});
			};
			$window.fbAsyncInit();
		}
		//FB API
		function login(){
			var deferred = $q.defer();
			FB.login(
				function(response) {
					if (response.authResponse) {//fetch information
						FB.api('/me', function(response) {//get user info
							deferred.resolve();
						});
					} else {//cancel login
						deferred.reject();
					}
				},{
					scope: 'publish_actions, public_profile, user_friends, email'
				}
			);
			return deferred.promise;
		}
		function loginStatus(){
			var deferred = $q.defer();
			FB.getLoginStatus(function(response) {
				if (response.status === 'connected') {
					// the user is logged in and has authenticated your
					// app, and response.authResponse supplies
					// the user's ID, a valid access token, a signed
					// request, and the time the access token 
					// and signed request each expire
					var uid = response.authResponse.userID;
					var access_token = response.authResponse.accessToken;
					deferred.resolve({uid:uid,access_token:access_token,status:1});
				} else if (response.status === 'not_authorized') {
					// the user is logged in to Facebook, 
					// but has not authenticated your app
					deferred.reject({uid:null,access_token:null,status:-1});
				} else {
					// the user isn't logged in to Facebook.
					deferred.reject({uid:null,access_token:null,status:-2})
				}
			});
			return deferred.promise;
		}
	}
})();;
(function() {
'use strict';

	angular
		.module('app')
		.factory('AchievementService', AchievementService);

	AchievementService.$inject = ['$http', '$cookieStore', '$rootScope', 'CiayoService'];
	function AchievementService($http, $cookieStore, $rootScope, CiayoService) {
		var service = {
			getData:getData,
			getCompleted:getCompleted,
			getProgress:getProgress,
			getDetail:getDetail,
			shareFB:shareFB,
			popupDetail:popupDetail
		};
		
		return service;
		
		function getData(orderType, orderBy,callback, errCallback) {
			var c={
				data:{
					orderType:orderType,
					orderBy:orderBy
				}
			};
			CiayoService.Api('achievement', c, function(response) {
				if(response.status==200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		
		function getCompleted(orderType, orderBy,callback, errCallback) {
			var c={
				data:{
					orderType:orderType,
					orderBy:orderBy
				}
			};
			CiayoService.Api('achievement/completed', c, function(response) {
				if(response.status==200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		
		function getProgress(orderType, orderBy,callback, errCallback) {
			var c={
				data:{
					orderType:orderType,
					orderBy:orderBy
				}
			};
			CiayoService.Api('achievement/progress', c, function(response) {
				if(response.status==200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function getDetail(callback, errCallback) {
			var c={
				data:{
				}
			};
			CiayoService.Api('achievement/detail', c, function(response) {
				if(response.status==200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function popupDetail(id, callback, errCallback){
			var c = {
				data: {
					"id_achievement": id
				}
			};

			CiayoService.Api('achievement/detail', c, function(response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function shareFB(access_token,uid,id_achievement,id,callback,errCallback){
			var c = {
				data: {
					'access_token': access_token,
					'uid':uid,
					'id_achievement':id_achievement,
					'id':id
				}
			};
			CiayoService.Api('facebook/share/achievement', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
	}
})();;
(function() {
'use strict';

	angular
		.module('app')
		.factory('AuthInterceptor', AuthInterceptor);

	AuthInterceptor.$inject = ['$q', '$location'];
	function AuthInterceptor($q, $location) {
		return {
			request: function(config) {
				//console.log(config);
				var token = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI0MjMiLCJpc3MiOiJodHRwOlwvXC9hcGkuY2lheW8uZGNjXC9sb2dpbiIsImlhdCI6MTQ2MTU1OTYxOSwiZXhwIjoxNDYyMTY0NDE5LCJuYmYiOjE0NjE1NTk2MTksImp0aSI6ImE3NDliYzQyMGJiZjA2M2I5ZTZlMjE3OWNkZmYxYjQ2In0.cRfXTTipBl76kJPAu0UQ1uO5TKQo8WSVpXTLoWOez08';
				config.headers = config.headers || {};
				config.headers.Authorization = 'Bearer '+token;
				//config.headers['Content-Type'] = 'application/x-www-form-urlencoded';
				return config;
			},
			responseError: function(response) {
				if(response.status === 401) {
					// redirect to some page
					// remove any stale tokens
					return $q.reject(response);
				} else {
					return $q.reject(response);
				}
			}
		};
	}
})();;
(function() {
'use strict';

	angular
		.module('app')
		.factory('AuthService', AuthService);

	AuthService.$inject = ['$http', '$cookieStore', '$rootScope', 'CiayoService'];
	function AuthService($http, $cookieStore, $rootScope, CiayoService) {
		var service = {
			Register:Register,
			Login:Login,
			Logout:Logout,
			IsAuth:IsAuth,
			finishProfile:finishProfile
		};
		
		return service;

		////////////////
		
		// Fungsi untuk register
		function Register(c, callback) {
			CiayoService.Api('register', c, function(response) {
				var response = response.data.c;
				// cek error yah
				if(!response.data.error){
					setAuth(response.token, '', '');
					callback(response.data);
				} else {
					callback(response.data);
				}
			});
		}
		
		// Fungsi untuk login
		function Login(c, callback) {
			// Send Req
			CiayoService.Api('login', c, function(response) {
				var response = response.data.c;
				// cek error dulu disini
				if(!response.data.error){
					//console.log(response);
					setAuth(response.token, response.data.content.gender, response.data.content.profile_completed);
					callback(response.data);
				} else {
					callback(response.data);
				}
			});
		}
		
		// Fungsi untuk logout dan hapus cookie user
		function Logout() {
			var c = {
				data: ''
			};
			CiayoService.Api('logout', c, function(response) {
				var response = response.data.c;
				console.log(response);
			});
		}
		
		function finishProfile(){
			$cookieStore.put('profile', true);
		}
		// Fungsi untuk mengecek apakah user tsb sudah login apa belum
		function IsAuth() {
			if($cookieStore.get('token')){
				return true;
			} else {
				
			}
			return false;
		}
		
		// set auth
		function setAuth(token, gender, profile) {
			$cookieStore.put('token', token);
			$cookieStore.put('gender', gender);
			$cookieStore.put('profile', profile);
		}
	}
	
})();;
(function() {
'use strict';

	angular
		.module('app')
		.factory('AvatarService', AvatarService);

	AvatarService.$inject = ['$http', '$cookieStore', '$rootScope', 'CiayoService'];
	function AvatarService($http, $cookieStore, $rootScope, CiayoService) {
		var service = {
			getDownloadAvatar:getDownloadAvatar
		};
		function getDownloadAvatar(callback){
			var c ={
				
			}
			CiayoService.Api('users/download/avatar', c, function(response) {
				if(response.status==200){
					callback(response.data);
				} else {
					errCallback(response);
				}
			},false,'image');
		}
		return service;
	}
})();
+function(){ ""
	angular
		.module("app")
		.service("CiayoBanner", function(CiayoService){
			var service={
				getData:getData,
				getDataPublic:getDataPublic
			}
			return service;
			
			function getData(type,callback,errCallback){
				var c = {
					data: {
						type: type
					}
				}

				CiayoService.Api("users/banner", c, function(response){
					if(response.status == 200){
						callback(response);
					} else{
						errCallback(response);
					}
				})
			}

			function getDataPublic(username, type, callback,errCallback){
				var c = {
					data: {
						username: username,
						type: type
					}
				}

				CiayoService.Api("public/users/banner", c, function(response){
					if(response.status == 200){
						callback(response);
					} else{
						errCallback(response);
					}
				})
			}

		});
}();;
(function () {
	'use strict';

	angular
		.module('app')
		.factory('CiayoService', CiayoService);

	CiayoService.$inject = ['$http', '$cookieStore', 'socketFactory', '$state', '$rootScope'];

	function CiayoService($http, $cookieStore, socketFactory, $state, $rootScope) {
		var service = {
			Api: Api,
			Socket: Socket
		};

		return service;

		// Fungsi untuk req ke API
		function Api(_url, c, callback, force_url, type) {
			// URL API
			var url = API_SERVER + _url;
			//			var url = 'https://api-astronot.ciayo.com/' + _url;
			if (force_url) {
				url = _url;
			}
			// C JSON Object
			if ($cookieStore.get('language')) {
				var lang = $cookieStore.get('language');
			} else {
				var lang = 2; // default language bahasa
			}
			var c = c;
			angular.extend(c, {
				timestamp: Date.now(),
				app: 'Web',
				screen_type: 'Web',
				image_type: '',
				latitude: '-6.225652',
				longitude: '106.74576',
				language: parseInt(lang)
			});

			if (!Date.now) {
				Date.now = function () {
					return new Date().getTime();
				}
			}

			// Set Data
			var json = angular.toJson(c);
			json = encodeURIComponent(json);
			var data = 'c=' + json;

			// get token
			var token = $cookieStore.get('token') || '';
			var header = {};
			if (token) {
				header = {
					"Content-Type": "application/x-www-form-urlencoded",
					"Authorization": 'Bearer ' + token
				};
			} else {
				header = {
					"Content-Type": "application/x-www-form-urlencoded"
				};
			}
			var log_data = {
				url: url,
				request: data,
				response: {}
			}

			// Req with $http
			$http({
					method: 'POST',
					url: url,
					data: data,
					headers: header
				})
				.then(function (response) {
					if (type == 'image') {
						callback(response);
						return;
					}
					//console.log(response);
					var data = response.data.c.data;
					if (data.message == 'token_invalid' || data.message == 'token_not_provided') {
						$state.transitionTo('welcome');
						$cookieStore.remove('token');
					}
					var ok = 0;
					log_data.response = response.status;
					if (response.status == 200) {
						var data = response.data.c.data;
						if (data.token != null) {
							$cookieStore.put('token', data.token);
						}

						if (data.error != undefined) {
							ok = 1;
						} else {
							if (data.message == 'token_invalid') {
								$cookieStore.remove('token');
								$cookieStore.remove('user_id');
								$cookieStore.remove('gender');
								$state.transitionTo('welcome');
								ok = -1;
							}
						}
					} else {
						var data = response.data.c.data;

					}
					if (ok == 1) {
						callback(response);
					} else
					if (ok == 0) {
						callback(response);
						log(log_data);
					}
				}, function (response) {
					if (_url == 'users/info') {
						var data = response.data;
						if (data['c'] != undefined)
							if (c.data.username == '' && data.c.data.message == 'user_not_found') {
								$cookieStore.remove('token', token);
								$cookieStore.remove('gender', gender);
								$cookieStore.remove('profile', profile);
								return;
							}
					}
					console.log(response);
					log_data.response = response.status;


					var url_block = ['notification', 'notification/read/all', 'users/relation'];
					if (url_block.indexOf(_url) == -1) {

						$rootScope.$broadcast(
							'modal.open', {
								'template': '',
								'data': {
									'message': url,
									'type': response.status
								}
							}
						);
					} else {
						console.log('ok');
					}
					if (response.data) {
						var data = response.data.c.data;
						if (data.message == 'token_invalid' || data.message == 'token_not_provided') {
							$cookieStore.remove('token');
//							$state.reload();
						}
						log(log_data);
					}

				});

			function log(log_data) {
				$.post('https://fr-logs.ciayo.com/errorlog.php', log_data);

			}
		}

		function Socket() {
			if (SOCKET_API_SERVER) {
				var ioSocket = io.connect(SOCKET_API_SERVER);
			} else {
				var ioSocket = io.connect('https://apidev.ciayo.com/');
			}
			var socket = socketFactory({
				ioSocket: ioSocket
			});
			return socket;
		}
	}
})();;
(function() {
'use strict';

	angular
		.module('app')
		.factory('ConnectionService', ConnectionService);

	ConnectionService.$inject = ['$http', '$cookieStore', '$rootScope', 'CiayoService'];
	function ConnectionService($http, $cookieStore, $rootScope, CiayoService) {
		var service = {
			requestFollow:requestFollow,
			requestCreate:requestCreate,
			requestLoad:requestLoad,
			requestConfirm:requestConfirm,
			requestDelete:requestDelete,
			userBlock:userBlock,
			userUnblock:userUnblock,
			blocklist:blocklist,
			listSearchResult:listSearchResult,
			listNotification:listNotification,
			requestDeleteNotification:requestDeleteNotification,
			requestMarkAllNotification:requestMarkAllNotification,
			requestViewNotification:requestViewNotification,
			listFriendRequest:listFriendRequest,
			requestConfirmFriendRequest:requestConfirmFriendRequest,
			requestRejectFriendRequest:requestRejectFriendRequest,
			requestBlockFriendRequest:requestBlockFriendRequest,
			getMutualFriend:getMutualFriend,
			requestAddFriend:requestAddFriend,
			listFriends:listFriends,
			requestDeleteFriend:requestDeleteFriend,
			listMutualFriends:listMutualFriends,
			requestCancelFriendRequest:requestCancelFriendRequest,
			shareFacebook:shareFacebook
		};
		
		return service;
		
		function shareFacebook(access_token, uid, callback,errCallback){
			var c={
				data:{
					access_token:access_token,
					uid:uid
				}
			};
			CiayoService.Api('facebook/share/invite', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function requestFollow(user_id,follow,callback,errCallback){
			var c={
				data:{
					user_id:user_id,
					follow:follow
				}
			};
			CiayoService.Api('users/follow', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		
		function requestCreate(friend_id,category_id,callback,errCallback){
			var c={
				data:{
					friend_id:friend_id,
					category_id:category_id
				}
			};
			CiayoService.Api('users/relation/create', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function requestLoad(limit,offset,callback,errCallback){
			var c={
				data:{
					limit:limit,
					offset:offset
				}
			};
			CiayoService.Api('users/relation', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function requestConfirm(user_relation_id,callback,errCallback){
			var c={
				data:{
					"user_relation_id": user_relation_id,
				}
			};
			CiayoService.Api('users/relation/confirm', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function requestDelete(friend_id,callback,errCallback){
			var c={
				data:{
					"friend_id": friend_id,
				}
			};
			CiayoService.Api('users/relation/reject', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		
		function userBlock(user_id,callback,errCallback){
			var c={
				data:{
					"user_id": user_id,
				}
			};
			CiayoService.Api('users/block', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function userUnblock(user_id,callback,errCallback){
			var c={
				data:{
					"user_id": user_id,
				}
			};
			CiayoService.Api('users/unblock', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		
		function blocklist(callback,errCallback){
			var c={
				data:{ }
			};
			CiayoService.Api('users/block/list', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function listSearchResult(keyword, limit, offset, callback,errCallback){
			var c = {
				data: {
					"keyword": keyword,
					"limit": limit,
					"offset": offset
				}
			}
			CiayoService.Api('search/user/name', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function listNotification(type, limit, offset, callback,errCallback){
			var c = {
				data: {
					"type": type,
					"limit": limit,
					"offset": offset,
					"order_by": 'created_at'
				}
			}
			CiayoService.Api('notification', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function requestDeleteNotification(notification_id, type, callback,errCallback){
			var c={
				data:{
					"notification_id": notification_id,
					"type" : type
				}
			};
			CiayoService.Api('notification/delete', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function requestMarkAllNotification(callback,errCallback){
			var c={
				data:{	}
			};
			CiayoService.Api('notification/read/all', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function requestViewNotification(notification_id, type, read_at, callback,errCallback){
			var c={
				data:{
					"notification_id": notification_id,
					"type" : type,
					"read_at" : read_at
				}
			};
			CiayoService.Api('notification/read', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function listFriendRequest(limit, offset, callback,errCallback){
			var c = {
				data: {
					"limit": limit,
					"offset": offset
				}
			}
			CiayoService.Api('users/relation', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function requestConfirmFriendRequest(user_relation_id, callback,errCallback){
			var c={
				data:{
					"user_relation_id": user_relation_id
				}
			};
			CiayoService.Api('users/relation/confirm', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function requestRejectFriendRequest(friend_id, callback,errCallback){
			var c={
				data:{
					"friend_id": friend_id
				}
			};
			CiayoService.Api('users/relation/reject', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function requestCancelFriendRequest(friend_id, callback,errCallback){
			var c={
				data:{
					"friend_id": friend_id
				}
			};
			CiayoService.Api('users/relation/cancel', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}


		function requestBlockFriendRequest(user_id, callback,errCallback){
			var c={
				data:{
					"user_id": user_id
				}
			};
			CiayoService.Api('users/block', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		
		function getMutualFriend(user_id, callback,errCallback){
			var c={
				data:{
					"user_id": user_id
				}
			};
			CiayoService.Api('users/friend/mutual', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function requestAddFriend(friend_id, callback,errCallback){
			var c={
				data:{
					"friend_id": friend_id
				}
			};
			CiayoService.Api('users/relation/create', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function listFriends(user_id, keyword, offset, limit, callback,errCallback){
			var c = {
				data: {
					"user_id": user_id,
					"keyword": keyword,
					"offset": offset,
					"limit": limit
				}
			}
			
			CiayoService.Api('search/friend/name', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function requestDeleteFriend(friend_id, callback,errCallback){
			var c={
				data:{
					"friend_id": friend_id
				}
			};
			CiayoService.Api('users/relation/delete', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function listMutualFriends(keyword, limit, offset, user_id, callback,errCallback){
			var c = {
				data: {
					"limit": limit,
					"offset": offset,
					"user_id": user_id,
					"keyword": keyword 

				}
			}
			CiayoService.Api('users/friend/mutual', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}


					var user_added_friend = $rootScope.$on(
                        "user.added_friend",
                        function() {
                            alert('added_friend');
                        }
                    );
	}
})();;
(function() {
'use strict';

	angular
		.module('app')
		.factory('ItemService', ItemService);

	ItemService.$inject = ['$http', '$cookieStore', '$rootScope', 'CiayoService'];
	function ItemService($http, $cookieStore, $rootScope, CiayoService) {
		var service = {
			list:list,
		};
		
		return service;
		
		function list(keyword,item_category_id,limit,offset,callback,errCallback){
			item_category_id=null;limit=20;offset=0;
			var c = {
				data: {
					"keyword": keyword,
					"item_category_id": item_category_id,
					"limit": limit,
					"offset": offset
				}
			};
			CiayoService.Api('item', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		
	}
})();;
(function () {
	'use strict';
	/*globals angular:false */
	angular
		.module('app')
		.service('listService',listService );
	function listService(){
		this.isActive=false;
		this.maxSize=0;
		this.top = 0;
		this.list=[];
		this.selectedIndex=0;
		this.prev = function(el,height,search_view){
			if(this.selectedIndex>0){
				this.selectedIndex--;
				if( this.top >= this.selectedIndex )
				{
					this.top = this.selectedIndex;
					angular.element(el).scrollTop(this.top*height);
				}
			}console.log(this.top);
		}
		this.next = function (el,height,search_view) {
			if(this.selectedIndex+1 < this.list.length){
				this.selectedIndex++;
				if(this.selectedIndex >= this.top+search_view){
					this.top = this.selectedIndex+1 - (search_view);if(this.top<0){this.top=0;}
					angular.element(el).scrollTop(this.top*height);
				}
			}console.log(this.top);
		}
		this.reset = function () {
			this.list = [];
			this.selectedIndex = 0;
			this.top = 0;
		}
		this.getSelectedItem = function () {
			return this.list[this.selectedIndex];
		}
		this.setSelectedIndex=function(selectedIndex,el,height){
			this.selectedIndex = selectedIndex;
			this.top = Math.floor(angular.element(el).scrollTop()/height);
		}
		this.isEmpty=function(){
			return this.list.length==0;
		}
	}
}());;
(function () {
	'use strict';

	angular
		.module('app')
		.factory('PostService', PostService);

	PostService.$inject = ['$http', '$cookieStore', '$rootScope','$q', 'CiayoService'];

	function PostService($http, $cookieStore, $rootScope,$q, CiayoService) {
		var service = {
			permission_list: permission_list,
			mood_list: mood_list,
			deletePost: deletePost,
			subscribePost:subscribePost,
			unsubscribePost: unsubscribePost,
			postAttributes: postAttributes,
			updatePermission: updatePermission,
			searchActivity: searchActivity,
			activityDetail: activityDetail,
			searchPlace: searchPlace,
			timelineUser: timelineUser,
			timelineUserPublic: timelineUserPublic,
			timeline: timeline,
			public_detail:public_detail,
			detail: detail,
			create: create,
			createEmotion: createEmotion,
			share: share,
			disableComment: disableComment,
			updateWith: updateWith,
			updateCaption: updateCaption,
			createComment: createComment,
			loadComment: loadComment,
			editComment: editComment,
			deleteComment: deleteComment,
			reportComment: reportComment,
			likeComment: likeComment,
			postReaction: postReaction,
			reactionDetail: reactionDetail,
			loadWith: loadWith,
			loadShare:loadShare,
			ask:ask,
			response:response,
			shareFB:shareFB,
			shareTo:shareTo,
			createShareFB:createShareFB,
			getDownloadImage:getDownloadImage,
			getKepoboxImage:getKepoboxImage,
			loadSuggest:loadSuggest,
			updatePlace:updatePlace
		};

		return service;
		var permission_list = null;
		var mood_list = null;
		function isPublic(){
			return $cookieStore.get('token')==undefined;
		}
		function deletePost(post_id, callback, errCallback) {
			var c = {
				data: {
					post_id: post_id
				}
			}
			CiayoService.Api('post/delete', c, function (response) {
				console.log(response);
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function unsubscribePost(post_id, callback, errCallback) {
			var c = {
				data: {
					post_id: post_id
				}
			}
			CiayoService.Api('post/unsubscribe', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function subscribePost(post_id, callback, errCallback) {
			var c = {
				data: {
					post_id: post_id
				}
			}
			CiayoService.Api('post/subscribe', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function postAttributes(callback, errCallback) {
			if (service.permission_list != undefined && service.mood_list != undefined) {
				callback();
				return;
			}
			var c = {
				data: {}
			}
			CiayoService.Api('post/attributes', c, function (response) {
				var ok = false;
				var data = null;
				if (response.status == 200) {
					data = response.data.c.data;
					if (data.error == false) {
						ok = true;
					}
				}
				if (ok) {
					service.permission_list = {};
					service.permission_list = data.content.post_category;
					service.mood_list = data.content.post_moods;
					angular.forEach(service.permission_list, function (value, key) {
						value.icon = value.name.replace(' ', '-');
					})
					callback();
				} else {
					errCallback(response);
				}
			});
		}

		function updatePermission(post_id, post_category, callback, errCallback) {
			var c = {
				data: {
					post_category: post_category,
					post_id: post_id
				}
			}
			CiayoService.Api('post/permission', c, function (response) {
				var ok = false;
				var data = null;
				if (response.status == 200) {
					data = response.data.c.data;
					if (data.error == false) {
						ok = true;
					}
				}
				if (ok) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function searchActivity(keyword, limit, offset, callback, errCallback) {
			var c = {
				data: {
					keyword: keyword,
					limit: limit,
					offset: offset
				}
			}
			CiayoService.Api('activity', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function activityDetail(activity_id, callback, errCallback) {
			var c = {
				data: {
					activity_id: activity_id
				}
			};
			CiayoService.Api('activity/detail', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function searchPlace(term, callback, errCallback) {
			var c = {
				data: {
					keyword: term
				}
			};
			CiayoService.Api('place', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function timelineUser(user_id, offset, limit,last_id, callback, errCallback,isrefresh) {
			var c = {
				data: {
					"username": user_id,
					"offset": offset,
					"limit": limit,
					"pointer_id":last_id
				}
			}
			if(isrefresh==true){
				c.data.isrefresh=isrefresh;
			}
			CiayoService.Api('timeline/user', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function timelineUserPublic(user_id, offset, limit,last_id, callback, errCallback) {
			var c = {
				data: {
					"username": user_id,
					"offset": offset,
					"limit": limit,
					"pointer_id":last_id
				}
			}
			CiayoService.Api('public/timeline/user', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function timeline(offset, limit,last_id, callback, errCallback,isrefresh) {
			var c = {
				data: {
					"offset": offset,
					"limit": limit,
					"pointer_id":last_id
				}
			}
			c.data.isrefresh=isrefresh;
			CiayoService.Api(TIMELINE_API_SERVER+'timeline', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			},true);
		}
		function detail(post_code, callback, errCallback) {
			var c = {
				data: {
					"post_code": post_code,
				}
			}
			CiayoService.Api('post/detail', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function public_detail(post_code, callback, errCallback) {
			var c = {
				data: {
					"post_code": post_code,
				}
			}
			CiayoService.Api('public/timeline/detail', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function create(post, callback,errCallback) {
			var c = {
				data: {
					"activity_id": post.activity_id,
					"mood_id": post.mood_id,
					"place_id": post.place_id,
					"post_category": post.post_category,
					"caption": post.caption,
					"bubble": post.bubble,
					"items": post.items,
					"with_users": post.with_users
				}
			}
			CiayoService.Api('post/create', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function createEmotion(post_id, emotion, callback) {
			var c = {
				data: {
					"post_id": post_id,
					"emotion": emotion
				}
			};
			CiayoService.Api('post/emotion', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}

		function share(post_id, callback) {
			var c = {
				data: {
					"post_id": post_id,
				}
			};
			CiayoService.Api('post/share', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}
		function shareTo(post_id,to,callback,errCallback){
				var target=0;
				if(to=='facebook'){
					target=0;
				}else
					if(to=='pinterest'){
					target=2;
				}else
				if(to=='twitter'){
					target=1;
				}else{
					return;
				}
				var c = {
						data: {
							'post_id': post_id,
							'message':to,
							'target':target
						}
					};
					CiayoService.Api('sosmed/share/save', c, function (response) {
						if (response.status == 200) {
							var data = response.data.c.data;
							if (data.error == false) {
								callback(data);
							}
						} else {
							errCallback(response);
						}
					});
			}

		function disableComment(post_id, disable, callback) {
			var c = {
				data: {
					'post_id': post_id,
					'disable': disable
				}
			};
			CiayoService.Api('post/comment/disable', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}

		function updateWith(post_id, with_user, callback, errCallback) {
			var c = {
				data: {
					'post_id': post_id,
					'with_users': with_user
				}
			};
			CiayoService.Api('post/with', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function updateCaption(post_id, post_caption, bubble, callback, errCallback) {
			var c = {
				data: {
					'post_id': post_id,
					'post_caption': post_caption,
					'bubble': bubble
				}
			};
			CiayoService.Api('post/caption', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function createComment(post, callback) {
			var c = {
				data: {
					"post_id": post.post_id,
					"content": post.content,
					"parent_id": post.parent_id,
				}
			};
			CiayoService.Api('post/comment', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}
		function loadComment(post_id,parent_id,offset,limit, callback,errCallback) {
			var c = {
				data: {
					'post_id': post_id,
					'limit': limit,
					'offset': offset,
					'parent_id': parent_id
				}
			};
			var url = 'post/comment/list';
			CiayoService.Api(url, c, function (response) {
				var ok=false;
				if (response.status == 200) {
					var data = response.data.c.data;
					if(data.error==false){
						ok=true;
					}
				}
				if(ok){
					callback(data);
				}else{
					errCallback(response);
				}
			});
		}
		function deleteComment(comment_id, callback) {
			var c = {
				data: {
					'comment_id': comment_id,
				}
			};
			CiayoService.Api('post/comment/delete', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}
		function reportComment(post_id, comment_id, content, callback, errCallback) {
			var c = {
				data: {
					'post_id': post_id,
					'comment_id': comment_id,
					'content': content
				}
			};
			CiayoService.Api(
				'post/report', c,
				function (response) {
					if (response.status == 200) {
						callback(response);
					} else {
						errCallback(response);
					}
				}
			);
		}
		function editComment(comment_id, content, callback) {
			var c = {
				data: {
					'comment_id': comment_id,
					'content': content
				}
			};
			CiayoService.Api('post/comment/edit', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}
		function likeComment(comment_id, value, callback) {
			var c = {
				data: {
					'comment_id': comment_id,
					'value': value
				}
			};
			CiayoService.Api('post/comment/like', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}

		function postReaction(post_id, emotion, callback, errCallback) {
			var c = {
				data: {
					'post_id': post_id,
					'emotion': emotion
				}
			};
			CiayoService.Api('post/emotion', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function reactionDetail(post_id, callback, errCallback) {
			var c = {
				data: {
					'post_id': post_id
				}
			};
			CiayoService.Api('post/emotion/detail', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function loadWith(post_id, callback, errCallback) {
			var c = {
				data: {
					'post_id': post_id
				}
			};
			CiayoService.Api('post/with/detail', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		
		function ask(post_id,type,callback,errCallback){
			var c = {
				data: {
					'post_id': post_id,
					'type':type
				}
			};
			getDownloadImage(post_id,function(){},function(){})
			CiayoService.Api('post/ask', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function response(post_id,type,value,callback,errCallback){
			var c = {
				data: {
					'post_id': post_id,
					'type':type,
					'value':value
				}
			};
			CiayoService.Api('post/response', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function shareFB(access_token,uid,post_id,callback,errCallback){
			var c = {
				data: {
					'access_token': access_token,
					'uid':uid,
					'post_id':post_id,
				}
			};
			CiayoService.Api('facebook/share/post', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function loadShare(post_id,callback,errCallback){
			var c = {
				data: {
					'post_id': post_id
				}
			};
			CiayoService.Api('sosmed/share/list', c, function (response) {
				var ok=false;
				if (response.status == 200) {
					var data = response.data.c.data;
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function createShareFB(post_id){
			var deferred = $q.defer();
			var c = {
				data : {
					'post_id':post_id
				}
			}
			CiayoService.Api('post/create/sharefb',c,function(response){
				if(response.status==200){
					deferred.resolve(response.data.c.data);
				}else{
					deferred.reject(response);
				}
			});
			return deferred.promise;
		}
		function getDownloadImage(post_id,callback,errCallback){
			var c = {
				data : {
					'post_id' : post_id
				}
			}
			CiayoService.Api('post/create/images',c,function(response){
				var ok = false;
				if(response.status==200){
					var data = response.data.c.data;
					if(data.error==false){
						ok = true;
					}
				}
				if(ok){
					callback(response);
				}else{
					errCallback(response);
				}
			});
		}
		function getKepoboxImage(daytime,callback){
			var c = {
				data:{
					'daytime':daytime
				}
			}
			CiayoService.Api('kepobox',c,function(response){
				if(response.status==200){
					var data = response.data.c.data;
					callback(data);
				}else{
					errCallback(response);
				}
			});
		}
		function loadSuggest(latitude,longitude,callback,errCallback){
			var ok = false;
			var c = {
				data: {
					latitude: latitude,
					longitude: longitude
				}
			};
			CiayoService.Api('place/nearby', c, function(response) {
				if(response.status==200){
					var data = response.data.c.data;
					if (data.error == false) {
						ok = true;
					}
				}
				if(ok){
					callback(response);
				}else{
					errCallback(response);
				}
			});
		}
		function updatePlace(post_id,place_id,callback,errCallback){
			var ok = false;
			var c = {
				data: {
					post_id: post_id,
					place_id: place_id
				}
			};
			CiayoService.Api('post/place', c, function(response) {
				if(response.status==200){
					var data = response.data.c.data;
					if (data.error == false) {
						ok = true;
					}
				}
				if(ok){
					callback(response);
				}else{
					errCallback(response);
				}
			});
		}
	}
})();;
(function() {
'use strict';

	angular
		.module('app')
		.factory('ProfileService', ProfileService);

	ProfileService.$inject = ['$http', '$cookieStore', '$rootScope', 'CiayoService'];
	function ProfileService($http, $cookieStore, $rootScope, CiayoService) {
		var service = {
			userData:null,
			userInfo:userInfo,
			userInfoPublic:userInfoPublic,
			getStatusInfo:getStatusInfo,
			requestFollow:requestFollow,
			searchUser:searchUser,
			searchFriend:searchFriend,
			listBadge:listBadge,
			listCities:listCities,
			listAchievement:listAchievement,
			choiceAchievement:choiceAchievement,
			choiceAchievementPublic:choiceAchievementPublic,
			choiceBadgePublic:choiceBadgePublic,
			confirmRequestFriend:confirmRequestFriend,
			saveChoiceAchievement:saveChoiceAchievement,
			rejectRequestFriend:rejectRequestFriend,
			deleteFriend:deleteFriend,
			listTitle:listTitle,
			choiceBadge:choiceBadge,
			saveChoiceBadge:saveChoiceBadge
		};
		
		
		
		function userInfo(username, callback, errCallback) {
			if(service.userData!=null && (username=='' || username==null)){
				callback(service.userData);
				return;
			}
			var c={
				data:{
						username:username
				}
			};
			CiayoService.Api('users/info', c, function(response) {
				var isOK=false;
				//console.log(response);
				if(response.status==200) {
					var data= response.data.c.data;
					if(data.error==false){
						isOK=true;
					}
				}
				if(isOK){
					var _return = { };
					_return.profile=[];
					angular.forEach(data.content.users_info,function(value,key){
						_return.profile[value.filter_id]=value;
					});
					_return.user_id = data.content.user_id || null;
					_return.user_avatar = data.content.users_avatar;
					if(username=='' || username==null){
						service.userData=_return;
					}
					callback(_return);
				}else{
					errCallback(response);
				}
			});
		}

		function userInfoPublic(username, callback, errCallback) {
			if(service.userData!=null && (username=='' || username==null)){
				callback(service.userData);
				return;
			}
			var c={
				data:{
						username:username
				}
			};
			CiayoService.Api('public/users/info', c, function(response) {
				var isOK=false;
				if(response.status==200) {
					var data= response.data.c.data;
					if(data.error==false){
						isOK=true;
					}
				}
				if(isOK){
					var _return = { };
					_return.profile=[];
					angular.forEach(data.content.users_info,function(value,key){
						_return.profile[value.filter_id]=value;
					});
					_return.user_id = data.content.user_id;
					_return.user_avatar = data.content.users_avatar;
					_return.email = data.content.email;
					_return.phone = (data.content.phone!=null) ? data.content.phone : '';
					if(username=='' || username==null){
						service.userData=_return;
					}
					callback(_return);
				}else{
					errCallback(response);
				}
			});
		}

		function getStatusInfo(username, callback, errCallback) {
			if(service.userData!=null && (username=='' || username==null)){
				callback(service.userData);
				return;
			}
			var c={
				data:{
						username:username
				}
			};
			CiayoService.Api('users/info', c, function(response) {
				var isOK=false;
				if(response.status==200) {
					var data= response.data.c.data;
					if(data.error==false){
						isOK=true;
					}
				}
				if(isOK){
					var _return = { };
					_return = data.content;
					
					
					callback(_return);
				}else{
					errCallback(response);
				}
			});
		}
		//http://192.168.35.56:8000/login
		//{"data":{"email":"miftarockavanka@gmail.com","password":"superadmi","latitude":"32","longitude":"32"}}
		// {"data":{"user_id":"1"}}
		function requestFollow(user_id,callback,errCallback){
			var c={
				data:{
					user_id:user_id
				}
			};
			CiayoService.Api('user/info', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function searchUser(keyword,limit,offset,callback,errCallback){
			var c={
				data:{
					keyword:keyword,
					limit:limit,
					offset:offset
				}
			};
			CiayoService.Api('search/user/name', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function searchFriend(keyword,limit,offset,callback,errCallback){
			var c={
				data:{
					keyword:keyword,
					limit:limit,
					offset:offset
				}
			};
			CiayoService.Api('search/friend/name', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function listTitle(orderType,orderBy,limit,offset,tittle,callback,errCallback){
			var c={
				data:{
					
					tittle:tittle
				}
			};
			CiayoService.Api('users/achievement/all', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function confirmRequestFriend(user_relation_id,callback,errCallback){
			var c={
				data:{
					user_relation_id:user_relation_id
				}
			};
			CiayoService.Api('users/relation/confirm', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function rejectRequestFriend(friend_id,callback,errCallback){
			var c={
				data:{
					friend_id:friend_id
				}
			};
			CiayoService.Api('users/relation/reject', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function deleteFriend(friend_id,callback,errCallback){
			var c={
				data:{
					friend_id:friend_id
				}
			};
			CiayoService.Api('users/relation/delete', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		
		function listBadge(orderType,orderBy,limit,offset,callback,errCallback){
			var c={
				data:{
					orderType:orderType,
					orderBy:orderBy,
					limit:limit,
					offset:offset
				}
			};
			CiayoService.Api('badge', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function getPlace(place_id,callback,errCallback) {
			var c={
				data:{
					place_id:place_id
				}
			};
			CiayoService.Api('place/detail', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function listCities(keyword, country_id, callback,errCallback) {
			var c={
				data:{
					keyword:keyword,
					country_id:country_id
				}
			};
			CiayoService.Api('place/cities', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function listAchievement(orderType,orderBy,limit,offset,search,callback,errCallback){
			var c={
				data:{
					orderType:orderType,
					orderBy:orderBy,
					limit:limit,
					offset:offset,
					search:search
				}
			};
			CiayoService.Api('achievement/completed', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function choiceAchievementPublic(username, type, callback,errCallback){
			var c={
				data:{
					username:username,
					type:type

				}
			};
			CiayoService.Api('public/users/achievement/choice', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		};

		function choiceBadgePublic(username, type, callback,errCallback){
			var c={
				data:{
					username:username,
					type:type

				}
			};
			CiayoService.Api('public/users/achievement/choice', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		};

		function choiceAchievement(user_id, callback,errCallback){
			var c={
				data:{
					user_id:user_id
				}
			};
			CiayoService.Api('users/achievement/choice', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		};

		function choiceBadge(user_id, callback,errCallback){
			var c={
				data:{
					type:"badge",
					user_id:user_id
				}
			};
			CiayoService.Api('users/achievement/choice', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		};

		function saveChoiceAchievement(user_threshold,callback,errCallback){
			var c={
				data:{
					user_threshold:user_threshold
				}
			};
			CiayoService.Api('users/achievement/save', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function saveChoiceBadge(user_threshold,callback,errCallback){
			var c={
				data:{
					type: "badge",
					user_threshold:user_threshold
				}
			};
			CiayoService.Api('users/achievement/save', c, function(response) {
				if(response.status==200){
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		return service;
	}
})();;
(function() {
'use strict';
    
    angular
        .module('app')
        .factory('SettingService', SettingService);

    SettingService.$inject = ['$http', '$cookieStore', '$rootScope', 'CiayoService','ProfileService', 'StoreService', '$q'];
    function SettingService($http, $cookieStore, $rootScope, CiayoService, ProfileService, StoreService, $q) {
        var service = {
            getInfo:getInfo,
            getFilterUser:getFilterUser,
            updateUserFilter:updateUserFilter,
            getFilter:getFilter,
            saveTitle:saveTitle,
            getSettings:getSettings,
            updateUsername:updateUsername,
            updateScreenName:updateScreenName,
            userDeactive:userDeactive,
            userActive:userActive,
            confirmDelete:confirmDelete,
            deleteAccount:deleteAccount,
            updateEmail:updateEmail,
            updatePhone:updatePhone,
            prefixPhoneNumber:prefixPhoneNumber,
            updateResendEmail:updateResendEmail,
            updateResendPhone:updateResendPhone,
            updateLoginNotification:updateLoginNotification,
            listSetting:listSetting,
            userPreference:userPreference,
            sendConfirmEmail:sendConfirmEmail,
            sendCodeVerify:sendCodeVerify,
            changePassword:changePassword,
            blockList:blockList,
            blockUser:blockUser,
            unblockUser:unblockUser,
            searchUser:searchUser,
            addSocialMedia:addSocialMedia,
            listSocialMedia:listSocialMedia,
            updateSocialMedia:updateSocialMedia,
            deleteSocialMedia:deleteSocialMedia,
            getLanguage:getLanguage,
            changeLanguage:changeLanguage,
            listStaticPages:listStaticPages,
            logout:logout
        };
        
        return service;
        
        function getInfo(username) {
            var deferred = $q.defer();
            var c={
                data:{
                    username:username
                }
            };
            CiayoService.Api('users/info', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function getFilterUser(filter_category_id, user_id) {
            var deferred = $q.defer();
            var c={
                data:{
                    filter_category_id:filter_category_id,
                    user_id:user_id
                }
            };
            CiayoService.Api('filter/user', c, function(response) {
                 if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }

        function updateUserFilter(updated_filter, type) {
            var deferred = $q.defer();
            var c={
                data:{
                    updated_filter:updated_filter,
                    type:type
                }
            };
            CiayoService.Api('users/filter/update', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }

        function saveTitle(value) {
            var deferred = $q.defer();
            var c={
                data:{
                    value:value
                }
            };
            CiayoService.Api('users/filter/update/achievement', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }

        function getFilter(keyword, filter_category_id, callback, errCallback) {
            var c={
                data:{
                    keyword:keyword,
                    filter_category_id:filter_category_id
                }
            };
            CiayoService.Api('filter', c, function(response) {
                if(response.status==200) {
                    callback(response);
                } else {
                    callback(response);
                }
            });
        }
        
        function getSettings() {
            var deferred = $q.defer();
            var c={
                data:{
                }
            };
            CiayoService.Api('settings', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function updateUsername(username, callback, errCallback) {
            var c={
                data:{
                    username:username
                }
            };
            CiayoService.Api('settings/username', c, function(response) {
                if(response.status==200) {
                    callback(response);
                } else {
                    callback(response);
                }
            });
        }
        
        function updateScreenName(screen_name) {
            var deferred = $q.defer();
            var c={
                data:{
                    screen_name:screen_name
                }
            };
            CiayoService.Api('users/screen/name', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function getLanguage() {
            var deferred = $q.defer();
            var c={data:{}};
            CiayoService.Api('language', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function sendConfirmEmail(email) {
            var deferred = $q.defer();
            var c={
                data:{
                    email:email
                }
            };
            CiayoService.Api('settings/sendingverify/email', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function sendCodeVerify(confirmation_code) {
            var deferred = $q.defer();
            var c={
                data:{
                    confirmation_code:confirmation_code
                }
            };
            CiayoService.Api('settings/verify', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function updateResendEmail(email) {
            var deferred = $q.defer();
            var c={
                data:{
                    email:email
                }
            };
            CiayoService.Api('settings/sendingverify/email', c, function(response) {
                 if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            })
            return deferred.promise;
        }
        
        function updateResendPhone(phone_number) {
            var deferred = $q.defer();
            var c={
                data:{
                    phone_number:phone_number
                }
            };
            CiayoService.Api('settings/sendingverify/phone', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function changePassword(old_password, new_password, confirm_new_password) {
            var deferred = $q.defer();
            var c={
                data:{
                    old_password:old_password,
                    new_password:new_password,
                    confirm_new_password:confirm_new_password
                }
            };
            CiayoService.Api('settings/password', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function userDeactive(deactive) {
            var deferred = $q.defer();
            var c={
                data:{
                    deactive:deactive,
                }
            };
            CiayoService.Api('settings/deactive', c, function(response) {
               if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
             return deferred.promise;
        }

        function userActive() {
            var deferred = $q.defer();
            var c={
                data:{
                    active:true,
                }
            };
            CiayoService.Api('settings/active', c, function(response) {
               if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }

        function confirmDelete() {
            var deferred = $q.defer();
            var c={
                data:{
                }
            };
            CiayoService.Api('settings/deleteconfirm', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function deleteAccount(delete_token) {
            var deferred = $q.defer();
            var c={
                data:{
                    delete_token:delete_token
                }
            };
            CiayoService.Api('settings/delete', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function updateEmail(email) {
            var deferred = $q.defer();
            var c={
                data:{
                    email:email
                }
            };
            CiayoService.Api('settings/email', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function updatePhone(phone_number) {
            var deferred = $q.defer();
            var c={
                data:{
                    phone_number:phone_number
                }
            };
            CiayoService.Api('settings/phone', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function prefixPhoneNumber(limit, offset) {
            var deferred = $q.defer();
            var c={
                data:{
                    limit:limit,
                    offset:offset
                }
            };
            CiayoService.Api('users/setting/prefix_phone_number', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function updateLoginNotification(value) {
            var deferred = $q.defer();
            var c={
                data:{
                    value:value
                }
            };
            CiayoService.Api('users/setting/login_notification', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function changeLanguage(language_id) {
            var deferred = $q.defer();
            var c={
                data:{
                    language_id:language_id
                }
            };
            CiayoService.Api('language', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function listSetting(callback, errCallback) {
            var c={data:{}}
            CiayoService.Api('settings', c, function(response) {
                if(response==200) {
                    callback(response);
                } else {
                    callback(response);
                }
            });
        }
        
        function userPreference(value, type) {
            var deferred = $q.defer();
            var c={
                data:{
                    value:value,
                    type:type
                }
            };
            CiayoService.Api('settings/preference', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function blockList(callback, errCallback) {
            var c={data:{}};
            CiayoService.Api('users/block/list', c, function(response) {
                if(response==200) {
                    callback(response);
                } else {
                    callback(response);
                }
            });
        }
        
        function blockUser(user_id, callback, errCallback) {
            var c={
                data:{
                    user_id:user_id
                }
            };
            CiayoService.Api('users/block', c, function(response) {
                if(response==200) {
                    callback(response);
                } else {
                    callback(response);
                }
            });
        }
        
        function unblockUser(user_id, callback, errCallback) {
            var c={
                data:{
                    user_id:user_id
                }
            };
            CiayoService.Api('users/unblock', c, function(response) {
                if(response==200) {
                    callback(response);
                } else {
                    callback(response);
                }
            });
        }
        
        function searchUser(keyword, limit, offset, callback, errCallback) {
            var c={
                data:{
                    keyword:keyword,
                    limit:limit,
                    offset:offset
                }
            };
            CiayoService.Api('search/user/name', c, function(response) {
                if(response==200) {
                    callback(response);
                } else {
                    callback(response);
                }
            });
        }
        
        function addSocialMedia(type, value) {
            var deferred = $q.defer();
            var c={
                data:{
                    type:type,
                    value:value
                }
            };
            CiayoService.Api('users/sosmed/save', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function listSocialMedia() {
            var deferred = $q.defer();
            var c={data:{}};
            CiayoService.Api('users/sosmed', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function updateSocialMedia(id, value) {
            var deferred = $q.defer();
            var c={
                data:{
                    id:id,
                    value:value
                }
            };
            CiayoService.Api('users/sosmed/update', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
        
        function deleteSocialMedia(id) {
            var deferred = $q.defer();
            var c={
                data:{
                    id:id
                }
            };
            CiayoService.Api('users/sosmed/delete', c, function(response) {
                if(response.status==200){
                    deferred.resolve(response.data.c.data);
                }else{
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }

        function listStaticPages(id,lang,callback, errCallback) {
            var lang = $cookieStore.get('language');
            var c={
                data:{
                    page_id:id,
                    language_id:lang
                }
            }
            CiayoService.Api('page/detail', c, function(response) {
                if(response.status == 200) {
                    callback(response);
                } else {
                    callback(response);
                }
            });
        }
        
        function logout() {
            var deferred = $q.defer();
            var c={data:{}}
            CiayoService.Api('logout', c, function(response) {
                if(response.status == 200) {
                    deferred.resolve(response.data.c.data);
                    console.log(ProfileService);
                    ProfileService.userData=null;
                    StoreService.reset();
                } else {
                    deferred.reject(response);
                }
            });
            return deferred.promise;
        }
    }
})();;
(function() {
'use strict';

	angular
		.module('app')
		.factory('StoreService', StoreService);

	StoreService.$inject = ['$http', '$cookieStore', '$rootScope', 'CiayoService'];
	function StoreService($http, $cookieStore, $rootScope, CiayoService) {
		var service = {
			emojiCollection:null,
			stickerCollection:null,
			reset:reset,
			getUserEmojiCollection:getUserEmojiCollection,
			getUserStickerCollection:getUserStickerCollection,
			getUserEmojiDetail:getUserEmojiDetail,
			getUserStickerDetail:getUserStickerDetail,
			getList: getList,
			getEmoji: getEmoji
		};
		
		return service;
		function reset(){
			service.emojiCollection=null;
			service.stickerCollection=null;
		}

		function getUserEmojiCollection(offset, limit,callback, errCallback) {
			if(service.emojiCollection!=null){
				callback();
				return;
			}
			var c={
				data:{
					offset:offset,
					limit:limit
				}
			};
			CiayoService.Api('user/emoji/collection', c, function(response) {
				var ok=false;
				if(response.status==200) {
					var data=response.data.c.data;
					if(data.error==false){
						ok=true;
					}
				}
				if(ok){
					service.emojiCollection=data.content.emoji_collection;
					callback();
				} else {
					errCallback(response);
				}
			});
		}
		function getUserStickerCollection(offset, limit,callback, errCallback) {
			if(service.stickerCollection!=null){
				callback();
				return;
			}
			var c={
				data:{
					offset:offset,
					limit:limit
				}
			};
			CiayoService.Api('user/sticker/collection', c, function(response) {
				var ok=false;
				if(response.status==200) {
					var data=response.data.c.data;
					if(data.error==false){
						ok=true;
					}
				}
				if(ok){
					service.stickerCollection=data.content.sticker_collection;
					callback();
				} else {
					errCallback(response);
				}
			});
		}
		function getUserEmojiDetail(collection,callback, errCallback) {
			var index = service.emojiCollection.indexOf(collection);
			var c={
				data:{
					collection_id:collection.id,
				}
			};
			CiayoService.Api('user/emoji/collection/detail', c, function(response) {
				var ok=false;
				if(response.status==200) {
					var data=response.data.c.data;
					if(data.error==false){
						ok=true;
					}
				}
				if(ok){
					service.emojiCollection[index].detail=data.content.emoji_collection;
					callback();
				}else{
					errCallback();
				}
			});
		}
		function getUserStickerDetail(collection,callback, errCallback) {
			var index = service.stickerCollection.indexOf(collection);
			var c={
				data:{
					collection_id:collection.id,
				}
			};
			CiayoService.Api('user/sticker/collection/detail', c, function(response) {
				var ok=false;
				if(response.status==200) {
					var data=response.data.c.data;
					if(data.error==false){
						ok=true;
					}
				}
				if(ok){
					service.stickerCollection[index].detail=data.content.sticker_collection;
					callback();
				}else{
					errCallback();
				}
			});
		}

		function getList(order, status, offset, limit, cat, keyword, callback){
			var c = {
				"category_id": cat,
				"keyword": keyword,
				"user": "",
				"order": order,
				"status": status,
				"offset": offset,
				"limit": limit
			};

			CiayoService.Api('ciayoproducts/sticker', c, function(response){
				callback(response);
			});
		}
		
		function getEmoji(offset, limit,callback){
			var c = {
				"offset": offset,
				"limit": limit
			};

			CiayoService.Api('ciayoproducts/emoji', c, function(response){
				callback(response);
			});
		}
		
	}
})();;
(function() {
'use strict';

	angular
		.module('app')
		.factory('TourService', TourService);

	TourService.$inject = ['$cookieStore', 'CiayoService'];

	function TourService($cookieStore, CiayoService) {

		return {
		 	tourCreateAvatar:tourCreateAvatar,
		 	tourSearchActivity:tourSearchActivity,
		 	tourSelectActivity:tourSelectActivity,
		 	tourCreatePost:tourCreatePost
		}

		
		function initTour(page, step_information){
			

			if($cookieStore.get('end_tour_'+page)==true)
				return false;

			if ($.fn.itour) {

				$('body').itour({
					CSSClass:'anyClassName',				//Assign for tour a unique class name to change the display styles of the tour.
					startStep:1,							//Step from which the tour begins
					tourMapPos:'right',						//Tour Map Position 
					tourTitle:'Tour Title Default',			//Tour title
					tourMapVisible:false,					//Specifies to show or hide the map of the tour at the start of the tour
					spacing:5,								//Indent highlighting around the element
					overlayClickable:false,					//This parameter enables or disables the click event for overlying layer
					stepNumbersVisible:true,				//Shows the total number of steps and the current step number
					lang: {									//Default language settings
						cancelText:	'Cancel Tour',			//The text in the cancel tour button
						hideText: 'Hide Tour Map',			//The text in the hidden tour map button 
						tourMapText:'•••',					//The text in the show tour button
						tourMapTitle: 'Tour Map',			//Title of Tour map button
						nextTextDefault:'Next',				//The text in the Next Button
						prevTextDefault:'Prev',				//The text in the Prev Button
						endText:'End Tour'					//sets the text for the close button in the last step of the tour
					},
					steps:step_information,
					create: function(){},					//Triggered when the itour is created
					end: function(){ 
						$cookieStore.put('end_tour_'+page,true);
						if(page=='search_activity'){
							var c = {
								data: {
									type: 'desktop'
								}
							}
							CiayoService.Api('set/tutorial', c, function (response) {
								if (response.status == 200) {
									//callback(response);
								} else {
									//errCallback(response);
								}
							});
						}
					},						//Triggered when the tour came to the end, or was interrupted.
				});
			}
		}

		// Create Avatar
		function tourCreateAvatar(){


			var EN = {
			    "title1"           	: "Zoom In/Out", 
			    "content1"        	: "Use this for zoom in or zoom out your avatar", 
			    "title2"           	: "What You Have on Your Head", 
			    "content2"        	: "You can customize what you would look like inside Ciayo world", 
			    "title3"           	: "How You Look Like on Mirror?",
			    "content3"        	: "Use this carefully and maybe you can save you precious face forever", 
			    "title4"           	: "Should I Explain?",
			    "content4"        	: "If you donâ€™t know what is it, hurry up and go to meet your doctor !"
			}

			var ID = {
			    "title1"           	: "Perbesar/Perkecil",
			    "content1"        	: "Gunakan kaca pembesar untuk memperbesar atau memperkecil avatarmu",
			    "title2"           	: "Seperti apa bentuk wajahmu",
			    "content2"        	: "Kamu bisa menyesuaikan penampilanmu di dunia Ciayo",
			    "title3"           	: "Bagaimana penampilanmu terlihat di cermin?",
			    "content3"        	: "Gunakan fitur ini hati-hati dan mungkin kamu akan menyimpan wajah berhargamu selamanya",
			    "title4"           	: "Apa perlu penjelasan dariku?",
			    "content4"        	: "Jika kamu tidak tau apa ini, ayo tanyakan kami !"
			}

			var lang = ($cookieStore.get('language')==1) ? EN : ID;

			var step = [{
					image:'',							//Path to image file
					title:lang['title1'],				//Name of step
					content:lang['content1'],		//Description of step
					contentPosition:'rcc',				//Position of message
					name:'avatar-zoom',					//Unique Name (<div data-name="uniqueName"></div>) of highlighted element or .className (<div class="className"></div>) or #idValue (<div id="idValue"></div>)
					disable:false,						//Block access to element
					overlayOpacity:0.5,					//For each step, you can specify the different opacity values of the overlay layer.
					event:'next',						//An event that you need to do to go to the next step
					nextText:'Next',					//The text in the Next Button
					prevText:'Prev',					//The text in the Prev Button
					trigger:false,						//An event which is generated on the selected element, in the transition from step to step
					before:function(){},				//Triggered before the start of step
					during:function(){},				//Triggered after the onset of step
					after:function(){}					//Triggered After completion of the step, but before proceeding to the next
				},
				{
					title:lang['title2'],
					content:lang['content2'],
					contentPosition:'lcc',
					name:'select-element',
					event:'next',
					nextText:'Next',
					trigger:false
				},
				{
					title:lang['title3'],
					content:lang['content3'],
					contentPosition:'tlc',
					name:'select-element-type',
					event:'next',
					nextText:'Next',
					trigger:false
				},
				{
					title:lang['title4'],
					content:lang['content4'],
					contentPosition:'lcc',
					name:'select-variant-color',
					event:'next',
					nextText:'DONE',
					trigger:false,
					prevText:'',
				}];

			initTour('create_avatar',step);

		}


		// Search Activity
		function tourSearchActivity(){

			var EN = {
			    "title1"           	: "Search Activity",
			    "content1"        	: "Search what you are doing right now. Use keyword with ease",
			}

			var ID = {
			    "title1"           	: "Cari Activity",
			    "content1"        	: "Cari Activity yang Kamu lakukan saat ini. Tambahkan Keyword agar lebih mudah ditelusuri.",
			}

			var lang = ($cookieStore.get('language')==1) ? EN : ID;
			var step = [{
					image:'',							
					title:lang['title1'],				
					content:lang['content1'],		
					contentPosition:'rcc',				
					name:'.c-tml-lpct',					
					disable:false,						
					overlayOpacity:0.5,					
					event:'click',						
					nextText:'Next',					
					prevText:'Prev',					
					trigger:false,						
					before:function(){},				
					during:function(){},				
					after:function(){}			
				}];
			initTour('search_activity',step);
		}

		// Select Activity
		function tourSelectActivity(){
			
			return false;

			var EN = {
			    "title1"           	: "Choose Activity",
			    "content1"        	: "Choose this one please, hey câ€™mon just klik here",
			}

			var ID = {
			    "title1"           	: "Pilih Activity",
			    "content1"        	: "Pilih satu activity, ayo pilih disini",
			}

			var lang = ($cookieStore.get('language')==1) ? EN : ID;
			
			var step = [{
					image:'',							
					title:lang['title1'],				
					content:lang['content1'],		
					contentPosition:'rcc',				
					name:'search-activity',					
					disable:false,						
					overlayOpacity:0.5,					
					event:'next',						
					nextText:'Next',					
					prevText:'Prev',					
					trigger:false,						
					before:function(){},				
					during:function(){ 
						//$cookieStore.put('end_tour_select_activity',true)
					},				
					after:function(){}			
				}];

			initTour('select_activity', step);

			
		}

		//  Create Post
		function tourCreatePost(){

			//$('body').itour('destroy');
			//if($cookieStore.get('end_tour_create_post')==true)
			//	return false;

			var EN = {
			    "title1"           	: "Caption",
			    "content1"        	: "This word will appears on your post",
			    "title2"			: "Mood",
			    "content2"			: "How do you feel? Express your feeling now !",
			    "title3"			: "Add Item",
			    "content3"			: "Tell your friends,  Kasih tau teman Kamu Item apa aja yang lagi digunakan saat melakukan Activity ini.",
			    "title4"			: "Tag Friends",
			    "content4"			: "Kamu sedang melakukan Activity bersama teman? Tag mereka ya.",
			    "title5"			: "Place",
			    "content5"			: "Check-in lokasi kamu saat melakukan Activity ini.",
			    "title6"			: "Post",
			    "content6"			: "Kalo udah selesai, klik Post!",
			}

			var ID = {
			    "title1"           	: "Caption",
			    "content1"        	: "Kalimat ini akan muncul di postinganmu",
			    "title2"			: "Mood",
			    "content2"			: "Kasih tau mood kamu saat melakukan activity ini.",
			    "title3"			: "Tambah Item",
			    "content3"			: "Kasih tau teman kamu item apa aja yang lagi digunakan saat melakukan activity ini.",
			    "title4"			: "Tag Teman-Temanmu",
			    "content4"			: "Kamu sedang melakukan activity bersama teman? Tag mereka ya.",
			    "title5"			: "Place",
			    "content5"			: "Masukan lokasi kamu saat melakukan activity ini.",
			    "title6"			: "Post",
			    "content6"			: "Kalo udah selesai, klik post yuk!",
			}

			var lang = ($cookieStore.get('language')==1) ? EN : ID;
			
			var step = [{						
					title:lang['title1'],				
					content:lang['content1'],		
					contentPosition:'rcc',				
					name:'input-caption',					
					disable:true,						
					overlayOpacity:0.3,					
					event:'next',						
					nextText:'Next',					
					prevText:'Prev',					
					trigger:false								
				},
				{
					title:lang['title2'],
					content:lang['content2'],
					contentPosition:'rcc',
					name:'select-mood',
					disable:true,	
					event:'next',
					nextText:'Next',
					trigger:false
				},
				{
					title:lang['title3'],
					content:lang['content3'],
					contentPosition:'tcc',
					disable:true,	
					name:'item-0',
					event:'next',
					nextText:'Next',
					trigger:false
				},
				{
					title:lang['title4'],
					content:lang['content4'],
					contentPosition:'tcc',
					name:'with-user',
					disable:true,	
					event:'next',
					nextText:'Next',
					trigger:false,
					prevText:'',
				},
				{
					title:lang['title5'],
					content:lang['content5'],
					contentPosition:'tcc',
					name:'add-place',
					disable:true,	
					event:'next',
					nextText:'Next',
					trigger:false
				},
				{
					title:lang['title6'],
					content:lang['content6'],
					contentPosition:'tcc',
					name:'.post-btn',
					event:'next',
					nextText:'DONE',
					trigger:false,
					prevText:'',
					disable:true
				}];

			initTour('create_post', step);

			
		}


	}
})();





;
(function () {
	'use strict';

	angular
		.module('app')
		.factory('TrendingService', TrendingService);

	TrendingService.$inject = ['$http', '$cookieStore', '$rootScope', 'CiayoService'];

	function TrendingService($http, $cookieStore, $rootScope, CiayoService) {
		var service = {
			permission_list: permission_list,
			mood_list: mood_list,
			deletePost: deletePost,
			unsubscribePost: unsubscribePost,
			postAttributes: postAttributes,
			updatePermission: updatePermission,
			searchActivity: searchActivity,
			activityDetail: activityDetail,
			searchPlace: searchPlace,
			timelineUser: timelineUser,
			timeline: timeline,
			detail: detail,
			create: create,
			createEmotion: createEmotion,
			share: share,
			disableComment: disableComment,
			updateWith: updateWith,
			updateCaption: updateCaption,
			createComment: createComment,
			loadComment: loadComment,
			editComment: editComment,
			deleteComment: deleteComment,
			reportComment: reportComment,
			likeComment: likeComment,
			postReaction: postReaction,
			reactionDetail: reactionDetail,
			loadWith: loadWith,
			ask:ask,
			response:response,
			shareFB:shareFB,
			postTrending: postTrending,
			peopleTrending: peopleTrending,
			activityTrending: activityTrending,
			placeTrending: placeTrending
		};

		return service;
		var permission_list = null;
		var mood_list = null;

		function deletePost(post_id, callback, errCallback) {
			var c = {
				data: {
					post_id: post_id
				}
			}
			CiayoService.Api('post/delete', c, function (response) {
				console.log(response);
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function unsubscribePost(post_id, callback, errCallback) {
			var c = {
				data: {
					post_id: post_id
				}
			}
			CiayoService.Api('post/unsubscribe', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function postAttributes(callback, errCallback) {
			if (service.permission_list != undefined && service.mood_list != undefined) {
				callback();
				return;
			}
			var c = {
				data: {}
			}
			CiayoService.Api('post/attributes', c, function (response) {
				var ok = false;
				var data = null;
				if (response.status == 200) {
					data = response.data.c.data;
					if (data.error == false) {
						ok = true;
					}
				}
				if (ok) {
					service.permission_list = {};
					service.permission_list = data.content.post_category;
					service.mood_list = data.content.post_moods;
					angular.forEach(service.permission_list, function (value, key) {
						value.icon = value.name.replace(' ', '-');
					})
					callback();
				} else {
					errCallback(response);
				}
			});
		}

		function updatePermission(post_id, post_category, callback, errCallback) {
			var c = {
				data: {
					post_category: post_category,
					post_id: post_id
				}
			}
			CiayoService.Api('post/permission', c, function (response) {
				var ok = false;
				var data = null;
				if (response.status == 200) {
					data = response.data.c.data;
					if (data.error == false) {
						ok = true;
					}
				}
				if (ok) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function searchActivity(keyword, limit, offset, callback, errCallback) {
			var c = {
				data: {
					keyword: keyword,
					limit: limit,
					offset: offset
				}
			}
			CiayoService.Api('activity', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function activityDetail(activity_id, callback, errCallback) {
			var c = {
				data: {
					activity_id: activity_id
				}
			};
			CiayoService.Api('activity/detail', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function searchPlace(term, callback, errCallback) {
			var c = {
				data: {
					keyword: term
				}
			};
			CiayoService.Api('place', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function timelineUser(user_id, offset, limit, callback, errCallback) {
			var c = {
				data: {
					"username": user_id,
					"offset": offset,
					"limit": limit
				}
			}
			CiayoService.Api('timeline/user', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function timeline(offset, limit, callback, errCallback) {
			var c = {
				data: {
					"offset": offset,
					"limit": limit
				}
			}
			CiayoService.Api('timeline', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function detail(post_code, callback, errCallback) {
			var c = {
				data: {
					"post_code": post_code,
				}
			}
			CiayoService.Api('post/detail', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function create(post, callback) {
			var c = {
				data: {
					"activity_id": post.activity_id,
					"mood_id": post.mood_id,
					"place_id": post.place_id,
					"post_category": post.post_category,
					"caption": post.caption,
					"bubble": post.bubble,
					"items": post.items,
					"with_users": post.with_users
				}
			}
			CiayoService.Api('post/create', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}

		function createEmotion(post_id, emotion, callback) {
			var c = {
				data: {
					"post_id": post_id,
					"emotion": emotion
				}
			};
			CiayoService.Api('post/emotion', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}

		function share(post_id, callback) {
			var c = {
				data: {
					"post_id": post_id,
				}
			};
			CiayoService.Api('post/share', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}

		function disableComment(post_id, disable, callback) {
			var c = {
				data: {
					'post_id': post_id,
					'disable': disable
				}
			};
			CiayoService.Api('post/comment/disable', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}

		function updateWith(post_id, with_user, callback, errCallback) {
			var c = {
				data: {
					'post_id': post_id,
					'with_users': with_user
				}
			};
			CiayoService.Api('post/with', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function updateCaption(post_id, post_caption, bubble, callback, errCallback) {
			var c = {
				data: {
					'post_id': post_id,
					'post_caption': post_caption,
					'bubble': bubble
				}
			};
			CiayoService.Api('post/caption', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function createComment(post, callback) {
			var c = {
				data: {
					"post_id": post.post_id,
					"content": post.content,
					"parent_id": post.parent_id,
				}
			};
			CiayoService.Api('post/comment', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}
		function loadComment(post_id,parent_id,offset,limit, callback,errCallback) {
			var c = {
				data: {
					'post_id': post_id,
					'limit': limit,
					'offset': offset,
					'parent_id': parent_id
				}
			};
			CiayoService.Api('post/comment/list', c, function (response) {
				var ok=false;
				if (response.status == 200) {
					var data = response.data.c.data;
					if(data.error==false){
						ok=true;
					}
				}
				if(ok){
					callback(data.content.list_comment);
				}else{
					errCallback(response);
				}
			});
		}
		function deleteComment(comment_id, callback) {
			var c = {
				data: {
					'comment_id': comment_id,
				}
			};
			CiayoService.Api('post/comment/delete', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}
		function reportComment(post_id, comment_id, content, callback, errCallback) {
			var c = {
				data: {
					'post_id': post_id,
					'comment_id': comment_id,
					'content': content
				}
			};
			CiayoService.Api(
				'post/report', c,
				function (response) {
					if (response.status == 200) {
						callback(response);
					} else {
						errCallback(response);
					}
				}
			);
		}
		function editComment(comment_id, content, callback) {
			var c = {
				data: {
					'comment_id': comment_id,
					'content': content
				}
			};
			CiayoService.Api('post/comment/edit', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}
		function likeComment(comment_id, value, callback) {
			var c = {
				data: {
					'comment_id': comment_id,
					'value': value
				}
			};
			CiayoService.Api('post/comment/like', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {

				}
			});
		}

		function postReaction(post_id, emotion, callback, errCallback) {
			var c = {
				data: {
					'post_id': post_id,
					'emotion': emotion
				}
			};
			CiayoService.Api('post/emotion', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function reactionDetail(post_id, callback, errCallback) {
			var c = {
				data: {
					'post_id': post_id
				}
			};
			CiayoService.Api('post/emotion/detail', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function loadWith(post_id, callback, errCallback) {
			var c = {
				data: {
					'post_id': post_id
				}
			};
			CiayoService.Api('post/with/detail', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		
		function ask(post_id,type,callback,errCallback){
			var c = {
				data: {
					'post_id': post_id,
					'type':type
				}
			};
			CiayoService.Api('post/ask', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function response(post_id,type,value,callback,errCallback){
			var c = {
				data: {
					'post_id': post_id,
					'type':type,
					'value':value
				}
			};
			CiayoService.Api('post/response', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
		function shareFB(access_token,uid,post_id,callback,errCallback){
			var c = {
				data: {
					'access_token': access_token,
					'uid':uid,
					'post_id':post_id,
				}
			};
			CiayoService.Api('facebook/share/post', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function postTrending(offset, callback, errCallback) { 
			// if(offset >= 9){
			// 	var new_limit = 1;
			// }else{
				var new_limit = 3;
			// }
			
			var c = {
				data: {
					"offset": offset,
					"limit": new_limit
				}
			}
			CiayoService.Api('post/trending', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function peopleTrending(callback, errCallback) {
			var c = {
				data: {
					"offset": 0,
					"limit": 10
				}
			};
			CiayoService.Api('users/trending', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function activityTrending(limit, offset, callback, errCallback) {
			var c = {
				data: {
					"offset": offset,
					"limit": limit
				}
			};
			CiayoService.Api('activity/trending', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}

		function placeTrending(callback, errCallback) {
			var c = {
				data: {
					"offset": 0,
					"limit": 20
				}
			};
			CiayoService.Api('place/trending', c, function (response) {
				if (response.status == 200) {
					callback(response);
				} else {
					errCallback(response);
				}
			});
		}
	}
})();